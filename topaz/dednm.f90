!     Last change:  JF    6 Jul 100    3:36 pm
MODULE STSYS1
IMPLICIT NONE
INTEGER,PARAMETER::X36=SELECTED_INT_KIND(2)
INTEGER,PARAMETER::X35=SELECTED_INT_KIND(4)
INTEGER,PARAMETER::X32=SELECTED_INT_KIND(8)
INTEGER,PARAMETER::X34=SELECTED_REAL_KIND(5,5)
INTEGER,PARAMETER::X33=SELECTED_REAL_KIND(10,40)
INTEGER,PARAMETER::X00075=31,X00076=32,X00077=33,X00073=34,&
X00078=35,X00446=36,X00079=37,X00447=40,X00448=38,&
X00080=44
INTEGER(KIND=X36),PARAMETER::X00070=-127
INTEGER::IOS=X00070
INTEGER(KIND=X35),PARAMETER::X00071=-32767
INTEGER(KIND=X32),PARAMETER::X00081=-2147483647
REAL(KIND=X34),PARAMETER::X00072=-1.0E25
REAL(KIND=X33),PARAMETER::X00082=-1.0D300
CONTAINS
SUBROUTINE CHKKND
IMPLICIT NONE
INTEGER(KIND=X36)::X26=X00070
INTEGER(KIND=X35)::X25=X00071
INTEGER(KIND=X32)::X24=X00081
REAL(KIND=X34)::X28=X00072
REAL(KIND=X33)::X27=X00082
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE CHKKND; MODULE STSYS1 (M_SYSA.F90).'')'
X051='(1X,''MISS-MATCH IN EXPECTED KIND SPECIFICATIONS AND ACTUAL SPECIFICATIONS'',/,&
&,1X,''OF THE COMPUTING ENVIRONMENT.'',/,&
&,1X,''MODIFY MODULE STSYS1 AND SUBROUTINE CHKKND IN M_SYSA.F90.'')'
IF(127.NE.HUGE(X26))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''EXPECTED RANGE OF IK1 IS: 127'',/,&
&,1X,''RANGE OF COMPUTING ENVIRONMENT:'',1X,I6)'
WRITE(X00077,X02)HUGE(X26)
WRITE(*,X02)HUGE(X26)
STOP 'ABNORMAL PROGRAM TERMINATION.'
END IF
IF(32767.NE.HUGE(X25))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''EXPECTED RANGE OF IK2 IS: 32767'',/,&
&,1X,''RANGE OF COMPUTING ENVIRONMENT:'',1X,I10)'
WRITE(X00077,X02)HUGE(X25)
WRITE(*,X02)HUGE(X25)
STOP 'ABNORMAL PROGRAM TERMINATION.'
END IF
IF(2147483647.NE.HUGE(X24))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''EXPECTED RANGE OF IK3 IS: 2147483647'',/,&
&,1X,''RANGE OF COMPUTING ENVIRONMENT:'',1X,I15)'
WRITE(X00077,X02)HUGE(X24)
WRITE(*,X02)HUGE(X24)
STOP 'ABNORMAL PROGRAM TERMINATION.'
END IF
IF((0.12E-31.LT.TINY(X28)).OR.(0.34E39.GT.HUGE(X28)))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''EXPECTED RANGE OF RK1 IS AT LEAST: 0.12E-31 TO 0.34E39.'',/,&
&,1X,''RANGE OF COMPUTING ENVIRONMENT:'',1X,D10.3,1X,''AND'',1X,D10.3)'
WRITE(X00077,X02)TINY(X28),HUGE(X28)
WRITE(*,X02)TINY(X28),HUGE(X28)
STOP 'ABNORMAL PROGRAM TERMINATION.'
END IF
IF((0.23D-307.LT.TINY(X27)).OR.(0.17D308.GT.HUGE(X27)))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''EXPECTED RANGE OF RK2 IS AT LEAST: 0.23D-307 TO 0.17D309.'',/,&
&,1X,''RANGE OF COMPUTING ENVIRONMENT:'',1X,D10.3,1X,''AND'',1X,D10.3)'
WRITE(X00077,X02)TINY(X27),HUGE(X27)
WRITE(*,X02)TINY(X27),HUGE(X27)
STOP 'ABNORMAL PROGRAM TERMINATION.'
END IF
END SUBROUTINE CHKKND
END MODULE STSYS1
MODULE DTBIN1
USE STSYS1,ONLY:X36,X35,X00070,X00071,X34,X33,X00072
IMPLICIT NONE
INTEGER(KIND=X36)::X0221=X00070
INTEGER(KIND=X35)::X0259=X00071,X00369=X00071
REAL(KIND=X34)::X00371=X00072,X00372=X00072
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::DX030,DX031,DX032
END MODULE DTBIN1
MODULE DTCATB
USE STSYS1,ONLY:X36,X35,X34
IMPLICIT NONE
INTEGER(KIND=X36),DIMENSION(:),ALLOCATABLE::X0107
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X236
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X0108,X111,X00137,X00138,X00139
END MODULE DTCATB
MODULE DTCAT1
USE STSYS1,ONLY:X36,X35,X32,X34
IMPLICIT NONE
INTEGER(KIND=X36),DIMENSION(:),ALLOCATABLE::X034
INTEGER(KIND=X35),DIMENSION(:,:),ALLOCATABLE::X18,X19,X20,X21
INTEGER(KIND=X35),DIMENSION(:,:),ALLOCATABLE::X035,X037,X036,X038
INTEGER(KIND=X32),DIMENSION(:,:),ALLOCATABLE::X033
INTEGER(KIND=X32),DIMENSION(:),ALLOCATABLE::X00033,ICHA,X052,X22,X23
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00411,X298,V24,V25
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X0265,X0266,X0267
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X0268,X0269,X0271
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00412,X00422,X00432
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00413,X00423,X00433
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00414,X00424,X00434
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00415,X00425,X00435
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00416,X00426,X00436
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00417,X00427,X00437
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00418,X00428,X00438
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00419,X00429,X00439
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00420,X00430,X00440
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00421,X00431,X00445
END MODULE DTCAT1
MODULE DTCHAB
USE STSYS1,ONLY:X36,X35,X32,X34,X33
IMPLICIT NONE
INTEGER(KIND=X36),DIMENSION(:),ALLOCATABLE::X029
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X0064,X00034
INTEGER(KIND=X35),DIMENSION(:,:),ALLOCATABLE::X0223
INTEGER(KIND=X32),DIMENSION(:),ALLOCATABLE::X0020
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X0021,X00035,X00036
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X030,X031,X032
END MODULE DTCHAB
MODULE DTCHA1
USE STSYS1,ONLY:X36,X35,X32,X34
IMPLICIT NONE
INTEGER(KIND=X36),DIMENSION(:),ALLOCATABLE::X30
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X067,X066,X065,X026
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X027,X028
INTEGER(KIND=X35),DIMENSION(:,:),ALLOCATABLE::X016
INTEGER(KIND=X32),DIMENSION(:),ALLOCATABLE::X017,X018,X0022,X019
INTEGER(KIND=X32),DIMENSION(:),ALLOCATABLE::X020,X021
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X022,X00037,X00038
END MODULE DTCHA1
MODULE DTCNT1
USE STSYS1,ONLY:X36,X35,X32,X34,X33,&
X00070,X00071,X00081,X00072,X00082
IMPLICIT NONE
INTEGER(KIND=X35),PRIVATE::I=X00071,J=X00071
INTEGER(KIND=X36),PARAMETER::X056=100,IORD=10,X38=10,X057=5,X054=101
INTEGER(KIND=X35),PARAMETER::X00083=1500
INTEGER(KIND=X36)::X014=X00070,X015=X00070,X0023=X00070
INTEGER(KIND=X36)::X12=X00070,X13=X00070,X14=X00070
INTEGER(KIND=X36)::X00039=X00070,X0018=X00070
INTEGER(KIND=X35)::X15=X00071,X17=X00071,X16=X00071
INTEGER(KIND=X35)::X0019=X00071,X011=X00071,X010=X00071
INTEGER(KIND=X35)::X023=X00071,X025=X00071,X0025=X00071,X0024=X00071
INTEGER(KIND=X35)::X009=X00071,X008=X00071
INTEGER(KIND=X35)::X09=X00071,X10=X00071,X039=X00071,X041=X00071
INTEGER(KIND=X32)::X0026=X00081,X0027=X00081,X0028=X00081
INTEGER(KIND=X32)::X00045=X00081,X00041=X00081,X00042=X00081,X00043=X00081
INTEGER(KIND=X32)::X00044=X00081,X00040=X00081,X006=X00081,X0017=X00081
INTEGER(KIND=X32)::X00030=X00081,X00029=X00081,X00031=X00081
INTEGER(KIND=X32)::X00032=X00081
INTEGER(KIND=X36),DIMENSION(1:8)::X0016=(/(X00070,I=1,8)/)
INTEGER(KIND=X36),DIMENSION(1:9,1:2)::X07=RESHAPE((/((X00070,I=1,9),J=1,2)/),(/9,2/))
INTEGER(KIND=X36),DIMENSION(1:X38)::X040=(/(X00070,I=1,X38)/)
INTEGER(KIND=X36),DIMENSION(1:X056)::X042=(/(X00070,I=1,X056)/)
INTEGER(KIND=X35),DIMENSION(1:X057)::X00046=(/(X00071,I=1,X057)/)
REAL(KIND=X34)::X00047=X00072,X0014=X00072,X001=X00072
REAL(KIND=X34)::X005=X00072
REAL(KIND=X34)::X0029=X00072,X0030=X00072
REAL(KIND=X34),DIMENSION(1:9)::X206=(/(X00072,I=1,9)/)
REAL(KIND=X34),DIMENSION(1:X057)::X0031=(/(X00072,I=1,X057)/),X00050=(/(X00072,I=1,X057)/)
REAL(KIND=X33)::X00049=X00082,X00048=X00082
CHARACTER(LEN=79)::X00051=' ', X00052=' ', X00054=' '
CHARACTER(LEN=79)::X0006=' ', X0009=' ', X0010=' ', X0012=' ', HEADE=' ', X0015=' ', X0256=' '
INTEGER(KIND=X36)::X00027=X00070,X00028=X00070
INTEGER(KIND=X35)::X00053=X00071,X00055=X00071
INTEGER(KIND=X35),DIMENSION(1:IORD)::X00084=(/(X00071,I=1,IORD)/)
INTEGER(KIND=X32)::X00056=X00081,X00057=X00081,X00058=X00081,X00059=X00081
INTEGER(KIND=X32)::X00060=X00081,X00065=X00081
REAL(KIND=X34)::X00444=X00072,X00443=X00072,X00442=X00072,X00441=X00072
CONTAINS
SUBROUTINE INITIL
USE STSYS1,ONLY:X36,X00070,X33
IMPLICIT NONE
INTEGER(KIND=X36)::X29=X00070,MR=X00070,MC=X00070
X29=0
DO MR=-1,1
DO MC=-1,1
X29=X29+1
X07(X29,1)=MR
X07(X29,2)=MC
X206(X29)=SQRT(REAL(((MR*MR)+(MC*MC)),KIND=X33))
END DO
END DO
X0016(1)=9
X0016(2)=8
X0016(3)=7
X0016(4)=4
X0016(5)=1
X0016(6)=2
X0016(7)=3
X0016(8)=6
END SUBROUTINE INITIL
END MODULE DTCNT1
MODULE DTFOR1
USE STSYS1,ONLY:X36,X32,X34,X00070,X00081,X00072
IMPLICIT NONE
INTEGER(KIND=X36)::X0032=X00070,X0033=X00070,X00024=X00070,X00025=X00070
INTEGER(KIND=X36)::X31=X00070,X00026=X00070
INTEGER(KIND=X36)::X00018=X00070,X00020=X00070,X00019=X00070
INTEGER(KIND=X36)::X00021=X00070,X00022=X00070,X00023=X00070
INTEGER(KIND=X36)::ILOT=X00070,ILCH=X00070,IEDC=X00070,IEDO=X00070
INTEGER(KIND=X32)::X0034=X00081,X0035=X00081,X0036=X00081
INTEGER(KIND=X32)::X0037=X00081,X0038=X00081,X0039=X00081
REAL(KIND=X34)::X003=X00072,X004=X00072
END MODULE DTFOR1
MODULE DTPRO1
USE STSYS1,ONLY:X36,X32,X00070,X00081,X33,X00082
USE DTCNT1,ONLY:X054
IMPLICIT NONE
INTEGER(KIND=X36),PRIVATE::I=X00070
INTEGER(KIND=X36)::X00062=X00070
INTEGER(KIND=X32),DIMENSION(1:X054)::X0004=(/(X00081,I=1,X054)/)
INTEGER(KIND=X32),DIMENSION(1:X054)::X00063=(/(X00081,I=1,X054)/)
REAL(KIND=X33)::X00064=X00082
END MODULE DTPRO1
MODULE DTRST1
USE STSYS1,ONLY:X36,X35,X32,X34,X33
IMPLICIT NONE
INTEGER(KIND=X36),DIMENSION(:,:),ALLOCATABLE::X08,X0041,X00061,X11
INTEGER(KIND=X36),DIMENSION(:,:),ALLOCATABLE::X043,X044,X271
INTEGER(KIND=X36),DIMENSION(:,:),ALLOCATABLE::X045,X068
INTEGER(KIND=X35),DIMENSION(:,:),ALLOCATABLE::X40,X0272,X0282,X046,&
X047
INTEGER(KIND=X32),DIMENSION(:,:),ALLOCATABLE::X03,ICA,X048,X049,X050
INTEGER(KIND=X32),DIMENSION(:,:),ALLOCATABLE::IDSOUT,X00463,X00462,&
IDPOUT,X270,X303,X0284
REAL(KIND=X34),DIMENSION(:,:),ALLOCATABLE::Z
REAL(KIND=X33),DIMENSION(:,:),ALLOCATABLE::X269
END MODULE DTRST1
MODULE DTSBV1
USE STSYS1,ONLY:X32,X33
IMPLICIT NONE
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00141,X00140,X00142,X00143
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00144,X00145,X00146,X00147
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00148,X00149,X00151,X00150
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00152,X00153,X00154,X00155
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00156,X00157,X00158,X00159
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X0109,X45,X112
END MODULE DTSBV1
MODULE DTSBV2
USE STSYS1,ONLY:X33,X00082
IMPLICIT NONE
REAL(KIND=X33)::X00177=X00082,X00268=X00082,X00269=X00082,X00178=X00082,&
X00179=X00082,X0112=X00082,X00180=X00082,X00198=X00082,&
X00270=X00082
REAL(KIND=X33)::X00181=X00082,X00271=X00082,X00272=X00082,X00184=X00082,&
X00185=X00082,X0113=X00082,X00187=X00082,X00188=X00082,&
CMECLS=X00082
REAL(KIND=X33)::X00183=X00082,RMX054=X00082,RMX109=X00082,X00191=X00082,&
RTX177=X00082,X0114=X00082,X00194=X00082,X00192=X00082,&
X00275=X00082
REAL(KIND=X33)::X00186=X00082,X00273=X00082,X00274=X00082,FTDX56=X00082,&
FTX177=X00082,X0116=X00082,X00199=X00082,X00201=X00082,&
X00276=X00082
REAL(KIND=X33)::X00189=X00082,X00277=X00082,DMX109=X00082,X00193=X00082,&
X00195=X00082,X0115=X00082,X00196=X00082,X00197=X00082,&
DMECLS=X00082
END MODULE DTSBV2
MODULE DTSBV3
USE STSYS1,ONLY:X33
IMPLICIT NONE
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00161,X00160,X00162,X00163
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00164,X00165,X00166,X00167
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00168,X00169,X00171,X00170
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00172,X00173,X00174,X00175
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00176,X114,X0111
END MODULE DTSBV3
MODULE DTSBV4
USE STSYS1,ONLY:X33,X00082
IMPLICIT NONE
REAL(KIND=X33)::X00200=X00082,X00202=X00082,TMX110=X00082,X00203=X00082,&
X00204=X00082,X0117=X00082,X00205=X00082,X00206=X00082,&
TMECLB=X00082
REAL(KIND=X33)::X00207=X00082,X00208=X00082,RMX110=X00082,X00209=X00082,&
X00211=X00082,X0118=X00082,REDSAB=X00082,RIDSAB=X00082,&
RMECLB=X00082
REAL(KIND=X33)::X00213=X00082,X00214=X00082,FMX110=X00082,X00215=X00082,&
X00216=X00082,X0119=X00082,X00217=X00082,X00218=X00082,&
FMECLB=X00082
REAL(KIND=X33)::X00219=X00082,X00221=X00082,CMX110=X00082,X00220=X00082,&
X00222=X00082,X0120=X00082,X00223=X00082,X00224=X00082,&
X00225=X00082
END MODULE DTSBV4
MODULE DTSEQ1
USE STSYS1,ONLY:X36,X35,X00070,X00071
IMPLICIT NONE
INTEGER(KIND=X36)::X00004=X00070
INTEGER(KIND=X36),DIMENSION(:),ALLOCATABLE::X00005,X00006,X00007
INTEGER(KIND=X35)::X00008=X00071,X00010=X00071
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X00013,X00014,X00015,X00016
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X00009,X00011,X00012
INTEGER(KIND=X35),DIMENSION(:,:),ALLOCATABLE::X00017
END MODULE DTSEQ1
MODULE DTSTA1
USE STSYS1,ONLY:X35,X34,X33
IMPLICIT NONE
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::IVAL,IOR
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::VL,X46,X47,X48,X49,AR,X50
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X113,X51,X00226,X00227,X00228
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00229,X00231,X00230,X00232
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00233,X00234,X00235,X00236
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X0122,X00237,X00238
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X115,X52,X116,X0121,X00239
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X0123,X0124,X0126,X0125,X0127
END MODULE DTSTA1
MODULE DTSTA2
USE STSYS1,ONLY:X36,X35,X00070,X00071,X34,X33,X00072,X00082
IMPLICIT NONE
INTEGER(KIND=X36)::X117=X00070,X00241=X00070,X0128=X00070
INTEGER(KIND=X35)::IVALE=X00071,X0149=X00071,X0131=X00071
REAL(KIND=X34)::X0132=X00072,X0133=X00072,X0135=X00072,X118=X00072
REAL(KIND=X34)::X119=X00072,X120=X00072,X121=X00072,X0134=X00072
REAL(KIND=X34)::X0136=X00072,X0137=X00072,X00278=X00072,X00240=X00072
REAL(KIND=X34)::X00242=X00072,X122=X00072,X123=X00072,X124=X00072
REAL(KIND=X34)::X125=X00072,X126=X00072,X127=X00072,X53=X00072,SLR=X00072
REAL(KIND=X34)::X55=X00072,X56=X00072,ARE=X00072,X58=X00072,X59=X00072
REAL(KIND=X34)::X60=X00072,X61=X00072,DDI=X00072,X63=X00072
REAL(KIND=X34)::X64=X00072,X128=X00072,X129=X00072,X65=X00072,X130=X00072
REAL(KIND=X34)::X131=X00072,X132=X00072,X00243=X00072,X00244=X00072,X00245=X00072
REAL(KIND=X34)::X00246=X00072,X00247=X00072,X00248=X00072,X00249=X00072
REAL(KIND=X34)::X00251=X00072,X00250=X00072,X00252=X00072,X00253=X00072
REAL(KIND=X34)::X00254=X00072,X00255=X00072,X00256=X00072,X00257=X00072
REAL(KIND=X34)::X00258=X00072,X00259=X00072,X00260=X00072,X00261=X00072
REAL(KIND=X34)::X00262=X00072,X00263=X00072,X0138=X00072,X0139=X00072
REAL(KIND=X34)::X0140=X00072,X00264=X00072,X00265=X00072,X00266=X00072
REAL(KIND=X33)::X133=X00082,X134=X00082,X135=X00082,X136=X00082
REAL(KIND=X33)::X137=X00082,X66=X00082,X68=X00082,X138=X00082,X139=X00082
REAL(KIND=X33)::X0141=X00082,X140=X00082,X141=X00082,X142=X00082,X0142=X00082
REAL(KIND=X33)::X0144=X00082,X0143=X00082,X00267=X00082
REAL(KIND=X33)::X143=X00082,X0146=X00082,X0145=X00082
END MODULE DTSTA2
MODULE DTSTA3
USE STSYS1,ONLY:X35,X34,X33
IMPLICIT NONE
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X161,X0160
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X153,X00303,X00304,X00305
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X00306,X0156,X00307,X0157,X179
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X71,X154,X155,X00308
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X156,X157,ARB,X158
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X0158,X159,X00309,X00310
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00311,X00312,X00313,X00314
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00315,X0159,X0161,X00316
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00317,X00318,X00319,X160
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X00321
END MODULE DTSTA3
MODULE DTSTA4
USE STSYS1,ONLY:X36,X35,X00070,X00071,X34,X33,X00072,X00082
IMPLICIT NONE
INTEGER(KIND=X36)::X0162=X00070
INTEGER(KIND=X35)::X00394=X00071,X00339=X00071,X00340=X00071
REAL(KIND=X34)::X00324=X00072,X00325=X00072,X00326=X00072,X0163=X00072
REAL(KIND=X34)::X0164=X00072,X0165=X00072,X0166=X00072,X00327=X00072
REAL(KIND=X34)::X00328=X00072,X00329=X00072,X162=X00072,X164=X00072
REAL(KIND=X34)::X00330=X00072,X00331=X00072,X00332=X00072,X0167=X00072
REAL(KIND=X34)::X0168=X00072,X0169=X00072,X0170=X00072,X0171=X00072
REAL(KIND=X34)::X0172=X00072,X163=X00072,X165=X00072,X166=X00072
REAL(KIND=X34)::X167=X00072,X168=X00072,X169=X00072,X171=X00072
REAL(KIND=X34)::X170=X00072,X172=X00072
REAL(KIND=X34)::X00333=X00072,X00334=X00072,X00335=X00072,X0173=X00072
REAL(KIND=X34)::X173=X00072,X0174=X00072,X0175=X00072,X152=X00072
REAL(KIND=X34)::X0188=X00072,X00336=X00072,X00279=X00072,X0177=X00072
REAL(KIND=X34)::X00280=X00072,X00281=X00072,X00282=X00072,X00283=X00072
REAL(KIND=X34)::X00284=X00072,X00285=X00072,X00286=X00072,X00396=X00072
REAL(KIND=X34)::X00287=X00072,X00288=X00072,X00289=X00072,X00290=X00072
REAL(KIND=X34)::X00291=X00072,X00292=X00072,X00293=X00072,X00294=X00072
REAL(KIND=X34)::X00295=X00072,X00296=X00072,X00297=X00072,X00298=X00072
REAL(KIND=X34)::X0178=X00072,X0179=X00072,X0180=X00072
REAL(KIND=X33)::X0181=X00082,X0182=X00082,X0183=X00082,X0184=X00082
REAL(KIND=X33)::X0186=X00082,X0185=X00082,X0187=X00082,X0155=X00082
REAL(KIND=X33)::X175=X00082,X00299=X00082,X00301=X00082,X00300=X00082
REAL(KIND=X33)::X176=X00082,X0154=X00082,X0153=X00082,X0152=X00082
END MODULE DTSTA4
MODULE DTSTA5
USE STSYS1,ONLY:X32,X33
IMPLICIT NONE
INTEGER(KIND=X32),DIMENSION(:),ALLOCATABLE::IAR,X151,X0147
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X70,X42,X103,X00337,X67
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X105,X104,X0150,X147
END MODULE DTSTA5
MODULE DTSTA6
USE STSYS1,ONLY:X34,X33
IMPLICIT NONE
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::X146
REAL(KIND=X33),DIMENSION(:),ALLOCATABLE::X0151,X00302,X144,X00338,X145
END MODULE DTSTA6
MODULE GENER1
CONTAINS
SUBROUTINE ERCHK &
(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,X00001)
USE STSYS1,ONLY:X36,X35,X32,X33,X00077,X00070,X00071,X00081
USE DTCNT1,ONLY:X023,X025
IMPLICIT NONE
INTEGER(KIND=X36)::IX0071=X00070
INTEGER(KIND=X36)::X0059=X00070,X0058=X00070
INTEGER(KIND=X36)::X00093=X00070,X00099=X00070,X00096=X00070,X00097=X00070
INTEGER(KIND=X35)::I=X00071,J=X00071
INTEGER(KIND=X35)::X0050=X00071,X0051=X00071
INTEGER(KIND=X35)::X00085=X00071,X00100=X00071,X00086=X00071,X00087=X00071
INTEGER(KIND=X32)::X0057=X00081,X0056=X00081
INTEGER(KIND=X32)::X0053=X00081,X0052=X00081,MX070=X00081,X00090=X00081
INTEGER(KIND=X32)::INX006=X00081,X00094=X00081,X055=X00081,ICAL=X00081
INTEGER(KIND=X32)::X00091=X00081,X00101=X00081,X00088=X00081,X00089=X00081
INTEGER(KIND=X36),INTENT(IN)::X0065,X00092
INTEGER(KIND=X32),INTENT(IN)::X0049,X0066,X0048,X0047
INTEGER(KIND=X36),DIMENSION(:,:),INTENT(IN)::X00003
INTEGER(KIND=X35),DIMENSION(:,:),INTENT(IN)::X00002
INTEGER(KIND=X32),DIMENSION(:,:),INTENT(IN)::X00001
CHARACTER(LEN=300)::X02=' ', X053=' ', X051=' ', X071=' ', X072=' ', X073=' '
CHARACTER(LEN=100)::X074=' ', X075=' ', X076=' ', X077=' ',X0067=' ', X0068=' ',&
X0069=' ', X0070=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE ERCHK; MODULE GENER1 (M_GENERA.F90)'')'
X051='(1X,''AN ERROR WAS ENCOUNTERED WHILE CHECKING A RASTER ARRAY.'',/,&
&1X,''SEE PROGRAM REPORT FILE FOR FURTHER INFORMATION.'')'
X071='(1X,''THE TOTAL NUMBER OF CELLS IN THE RASTER DOES NOT CORRESPOND'',/,&
&1X,''TO THE NUMBER OF CELLS TESTED.'')'
X072='(1X,''MAXIMUM OR MINIMUM VALUE EXCEEDS THE SPECIFIED BOUNDARIES, OR'',/,&
&1X,''UNACCEPTABLE OR UNDEFINED VALUE ENCOUNTERED.'')'
X073='(1X,''THE INDETERMINATE VALUE CANNOT BE WITHIN THE MINIMUM-MAXIMUM VALUE RANGE.'')'
X074='(5X,''MINIMUM VALUE ALLOWED\\DETECTED:'',19X,I10,1X,I10)'
X075='(5X,''MAXIMUM VALUE ALLOWED\\DETECTED:'',19X,I10,1X,I10)'
X076='(5X,''NUMBER OF MINIMUM AND MAXIMUM VALUES:'',13X,I10,1X,I10)'
X077='(5X,''NUMBER OF VALUES BETWEEN MINIMUM AND MAXIMUM:'',16X,I10)'
X0067='(5X,''INDETERMINATE VALUE AND COUNT: '',19X,I10,1X,I10)'
X0068='(5X,''UNACCEPTABLE VALUE AND COUNT:'',21X,I10,1X,I10)'
X0069='(5X,''NUMBER OF CELLS IN RASTER ENTERED/TESTED:'',9X,I10,1X,I10)'
X0070='(5X,''NUMBER OF UNRESOLVED VALUES:'',33X,I10)'
X0053=0
X0052=0
MX070=0
X00090=0
INX006=0
X00094=0
IX0071=0
X0065_CASE:IF(X0065.EQ.3)THEN
X00091=INT(X0049,KIND=X32)
X00101=INT(X0066,KIND=X32)
X00088=INT(X0048,KIND=X32)
X00089=INT(X0047,KIND=X32)
X0057=2147483647
X0056=-2147483647
DO J=1,X025
DO I=1,X023
IF(X00001(I,J).GT.X0056)THEN
IF((X00001(I,J).NE.X00101).AND.(X00001(I,J).NE.X00091))&
X0056=X00001(I,J)
END IF
IF(X00001(I,J).LT.X0057)THEN
IF((X00001(I,J).NE.X00101).AND.(X00001(I,J).NE.X00091))&
X0057=X00001(I,J)
END IF
END DO
END DO
IX0071=0
IF((X00101.LE.X0056).AND.(X00101.GE.X0057))IX0071=1
IF((IX0071.EQ.0).AND.((X00091.GT.X0056).OR.(X00091.LT.X0057)))THEN
DO J=1,X025
DO I=1,X023
IF((X00001(I,J).LT.X0056).AND.(X00001(I,J).GT.X0057))THEN
MX070=MX070+1
ELSE IF(X00001(I,J).EQ.X0056)THEN
X0052=X0052+1
IF(X0056.EQ.X0057)X0053=X0053+1
ELSE IF(X00001(I,J).EQ.X0057)THEN
X0053=X0053+1
ELSE IF(X00001(I,J).EQ.X00101)THEN
INX006=INX006+1
ELSE IF((X00001(I,J).EQ.X00091).AND.(X00092.EQ.1))THEN
X00094=X00094+1
ELSE
X00090=X00090+1
END IF
END DO
END DO
ELSE
DO J=1,X025
DO I=1,X023
IF(X00001(I,J).EQ.X00101)THEN
INX006=INX006+1
ELSE IF((X00001(I,J).EQ.X00091).AND.(X00092.EQ.1))THEN
X00094=X00094+1
ELSE IF((X00001(I,J).LT.X0056).AND.(X00001(I,J).GT.X0057))THEN
MX070=MX070+1
ELSE IF(X00001(I,J).EQ.X0056)THEN
X0052=X0052+1
IF(X0056.EQ.X0057)X0053=X0053+1
ELSE IF(X00001(I,J).EQ.X0057)THEN
X0053=X0053+1
ELSE
X00090=X00090+1
END IF
END DO
END DO
END IF
IF(X0057.EQ.X0056)THEN
X0053=NINT((REAL(X0053,KIND=X33)/2.0-0.1),KIND=X32)
X0052=NINT((REAL(X0052,KIND=X33)/2.0+0.1),KIND=X32)
END IF
X055=X0053+X0052+X00094+INX006+MX070
ICAL=INT(X023,KIND=X32)*INT(X025,KIND=X32)
WRITE(X00077,X074)X00089,X0057
WRITE(X00077,X075)X00088,X0056
WRITE(X00077,X076)X0053,X0052
WRITE(X00077,X077)MX070
WRITE(X00077,X0067)X00101,INX006
IF(X00092.EQ.1)THEN
WRITE(X00077,X0068)X00091,X00094
END IF
WRITE(X00077,X0069)ICAL,X055
WRITE(X00077,X0070)X00090
IF((X0057.LT.X00089).OR.(X0056.GT.X00088).OR.&
(X00094.NE.0).OR.(X00090.NE.0))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK PROGRAM REPORT FILE.'
END IF
ELSE IF(X0065.EQ.2)THEN X0065_CASE
X00085=INT(X0049,KIND=X35)
X00100=INT(X0066,KIND=X35)
X00086=INT(X0048,KIND=X35)
X00087=INT(X0047,KIND=X35)
X0050=32767
X0051=-32767
DO J=1,X025
DO I=1,X023
IF(X00002(I,J).GT.X0051)THEN
IF((X00002(I,J).NE.X00100).AND.(X00002(I,J).NE.X00085))&
X0051=X00002(I,J)
END IF
IF(X00002(I,J).LT.X0050)THEN
IF((X00002(I,J).NE.X00100).AND.(X00002(I,J).NE.X00085))&
X0050=X00002(I,J)
END IF
END DO
END DO
IX0071=0
IF((X00100.LE.X0051).AND.(X00100.GE.X0050))IX0071=1
IF((IX0071.EQ.0).AND.((X00085.GT.X0051).OR.(X00085.LT.X0050)))THEN
DO J=1,X025
DO I=1,X023
IF((X00002(I,J).LT.X0051).AND.(X00002(I,J).GT.X0050))THEN
MX070=MX070+1
ELSE IF(X00002(I,J).EQ.X0051)THEN
X0052=X0052+1
IF(X0051.EQ.X0050)X0053=X0053+1
ELSE IF(X00002(I,J).EQ.X0050)THEN
X0053=X0053+1
ELSE IF(X00002(I,J).EQ.X00100)THEN
INX006=INX006+1
ELSE IF((X00002(I,J).EQ.X00085).AND.(X00092.EQ.1))THEN
X00094=X00094+1
ELSE
X00090=X00090+1
END IF
END DO
END DO
ELSE
DO J=1,X025
DO I=1,X023
IF(X00002(I,J).EQ.X00100)THEN
INX006=INX006+1
ELSE IF((X00002(I,J).EQ.X00085).AND.(X00092.EQ.1))THEN
X00094=X00094+1
ELSE IF((X00002(I,J).LT.X0051).AND.(X00002(I,J).GT.X0050))THEN
MX070=MX070+1
ELSE IF(X00002(I,J).EQ.X0051)THEN
X0052=X0052+1
IF(X0051.EQ.X0050)X0053=X0053+1
ELSE IF(X00002(I,J).EQ.X0050)THEN
X0053=X0053+1
ELSE
X00090=X00090+1
END IF
END DO
END DO
END IF
IF(X0050.EQ.X0051)THEN
X0053=NINT((REAL(X0053,KIND=X33)/2.0-0.1),KIND=X32)
X0052=NINT((REAL(X0052,KIND=X33)/2.0+0.1),KIND=X32)
END IF
X055=X0053+X0052+X00094+INX006+MX070
ICAL=INT(X023,KIND=X32)*INT(X025,KIND=X32)
WRITE(X00077,X074)X00087,X0050
WRITE(X00077,X075)X00086,X0051
WRITE(X00077,X076)X0053,X0052
WRITE(X00077,X077)MX070
WRITE(X00077,X0067)X00100,INX006
IF(X00092.EQ.1)THEN
WRITE(X00077,X0068)X00085,X00094
END IF
WRITE(X00077,X0069)ICAL,X055
WRITE(X00077,X0070)X00090
IF((X0050.LT.X00087).OR.(X0051.GT.X00086).OR.&
(X00094.NE.0).OR.(X00090.NE.0))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK PROGRAM REPORT FILE.'
END IF
ELSE IF(X0065.EQ.1)THEN X0065_CASE
X00093=INT(X0049,KIND=X36)
X00099=INT(X0066,KIND=X36)
X00096=INT(X0048,KIND=X36)
X00097=INT(X0047,KIND=X36)
X0059=127
X0058=-127
DO J=1,X025
DO I=1,X023
IF(X00003(I,J).GT.X0058)THEN
IF((X00003(I,J).NE.X00099).AND.(X00003(I,J).NE.X00093))&
X0058=X00003(I,J)
END IF
IF(X00003(I,J).LT.X0059)THEN
IF((X00003(I,J).NE.X00099).AND.(X00003(I,J).NE.X00093))&
X0059=X00003(I,J)
END IF
END DO
END DO
IX0071=0
IF((X00099.LE.X0058).AND.(X00099.GE.X0059))IX0071=1
IF((IX0071.EQ.0).AND.((X00093.GT.X0058).OR.(X00093.LT.X0059)))THEN
DO J=1,X025
DO I=1,X023
IF((X00003(I,J).LT.X0058).AND.(X00003(I,J).GT.X0059))THEN
MX070=MX070+1
ELSE IF(X00003(I,J).EQ.X0058)THEN
X0052=X0052+1
IF(X0058.EQ.X0059)X0053=X0053+1
ELSE IF(X00003(I,J).EQ.X0059)THEN
X0053=X0053+1
ELSE IF(X00003(I,J).EQ.X00099)THEN
INX006=INX006+1
ELSE IF((X00003(I,J).EQ.X00093).AND.(X00092.EQ.1))THEN
X00094=X00094+1
ELSE
X00090=X00090+1
END IF
END DO
END DO
ELSE
DO J=1,X025
DO I=1,X023
IF(X00003(I,J).EQ.X00099)THEN
INX006=INX006+1
ELSE IF((X00003(I,J).EQ.X00093).AND.(X00092.EQ.1))THEN
X00094=X00094+1
ELSE IF((X00003(I,J).LT.X0058).AND.(X00003(I,J).GT.X0059))THEN
MX070=MX070+1
ELSE IF(X00003(I,J).EQ.X0058)THEN
X0052=X0052+1
IF(X0058.EQ.X0059)X0053=X0053+1
ELSE IF(X00003(I,J).EQ.X0059)THEN
X0053=X0053+1
ELSE
X00090=X00090+1
END IF
END DO
END DO
END IF
IF(X0059.EQ.X0058)THEN
X0053=NINT((REAL(X0053,KIND=X33)/2.0-0.1),KIND=X32)
X0052=NINT((REAL(X0052,KIND=X33)/2.0+0.1),KIND=X32)
END IF
X055=X0053+X0052+X00094+INX006+MX070
ICAL=INT(X023,KIND=X32)*INT(X025,KIND=X32)
WRITE(X00077,X074)X00097,X0059
WRITE(X00077,X075)X00096,X0058
WRITE(X00077,X076)X0053,X0052
WRITE(X00077,X077)MX070
WRITE(X00077,X0067)X00099,INX006
IF(X00092.EQ.1)THEN
WRITE(X00077,X0068)X00093,X00094
END IF
WRITE(X00077,X0069)ICAL,X055
WRITE(X00077,X0070)X00090
IF((X0059.LT.X00097).OR.(X0058.GT.X00096).OR.&
(X00094.NE.0).OR.(X00090.NE.0))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK PROGRAM REPORT FILE.'
END IF
ELSE X0065_CASE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''LOGIC ERROR.  AN INCORRECT VALUE FOR ICOD1 WAS ENCOUNTERED.'',/,&
&1X,''THE VALUE FOR ICOD1 IS: '',I9)'
WRITE(X00077,X02)X0065
WRITE(*,X02)X0065
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK PROGRAM REPORT FILE.'
END IF X0065_CASE
IF(ICAL.NE.X055)THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X071)
WRITE(*,X071)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK PROGRAM REPORT FILE.'
END IF
IF(IX0071.EQ.1)THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X073)
WRITE(*,X073)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK PROGRAM REPORT FILE.'
END IF
END SUBROUTINE ERCHK
SUBROUTINE PARVER &
(X0054,X0055,X0060,X0061)
USE STSYS1,ONLY:X35,X00077
IMPLICIT NONE
INTEGER(KIND=X35),INTENT(IN)::X0060,X0061
CHARACTER(LEN=6),INTENT(IN)::X0054,X0055
CHARACTER(LEN=500)::X02=' '
IF(X0060.EQ.X0061)RETURN
X02='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE PARVER; MODULE GENER1 (M_GENERA.F90).'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''AN INCOMPATIBLE ARRAY SIZE WAS READ FROM FILE OUTCNT.UNF.'',/,&
&1X,''ARRAY NAME:'',1X,6A,/,&
&1X,''THE ARRAY SIZE IN FILE OUTCNT.UNF IS GIVEN AS:'',1X,I3,/,&
&1X,''THE ARRAY SIZE IN MODULE SET_CNT1 (M_DATA.F90) IS SET TO:'',1X,I3,/,&
&1X,''THE VALUE WAS READ BY SUBROUTINE:'',1X,6A)'
WRITE(X00077,X02)X0054,X0061,X0060,X0055
WRITE(*,X02)X0054,X0061,X0060,X0055
X02='(1X,''FOR THIS PARTICULAR APPLICATION OF SOFTWARE TOPAZ THE ARRAY SIZES'',/,&
&1X,''MUST BE THE SAME IN ALL PROGRAMS AND MUST ALSO BE THE SAME AS'',/,&
&1X,''THE SIZE OF THE PREVIOUS APPLICATION OF SOFTWARE TOPAZ.'')'
WRITE(X00077,X02)
WRITE(X00077,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  SEE REPORT FILE.'
END SUBROUTINE PARVER
END MODULE GENER1
MODULE GENIO1
USE STSYS1,ONLY:X36,X00070
IMPLICIT NONE
INTEGER(KIND=X36)::X0045=X00070,X0044=X00070
CONTAINS
SUBROUTINE CHKFIL(X01,X00066)
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS,X00077
IMPLICIT NONE
INTEGER(KIND=X36),INTENT(IN)::X00066
CHARACTER(LEN=12),INTENT(IN)::X01
CHARACTER(LEN=500)::X02=' ', X053=' '
LOGICAL::INPT=.FALSE.
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE CHKFIL; MODULE GENIO1 (M_IOA.F90).'')'
INPT=.FALSE.
INQUIRE(FILE=X01,EXIST=INPT)
CASEX:IF(X00066.EQ.1)THEN
IF(INPT)THEN
CALL CKFIL1(X01)
RETURN
END IF
ELSE IF(X00066.EQ.2)THEN
IF(.NOT.INPT)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''FILE'',1X,A12,1X,''DOES NOT EXIST IN THE CURRENT DIRECTORY.'',/,&
&1X,''THIS FILE MUST EXIST IN THE CURRENT DIRECTORY.''A12)'
WRITE(X00077,X02)X01
WRITE(*,X02)X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''LOGICAL ERROR IN SUBROUTINE CHKFIL.'',/,&
&1X,''UNRECOGNIZED VALUE FOR VARIABLE "ICASE1".''`A12)'
WRITE(X00077,X02)X01
WRITE(*,X02)X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF CASEX
CONTAINS
SUBROUTINE CKFIL1(X01)
IMPLICIT NONE
INTEGER(KIND=X36)::X0003=X00070,X0001=X00070,X00067=X00070
INTEGER::X00068=X00070
INTEGER(KIND=X35)::X00069=X00071
CHARACTER(LEN=12),INTENT(IN)::X01
CHARACTER(LEN=500)::X02=' ', X053=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE CKFIL1; SUBROUTINE CHKFIL; MODULE GENIO1 (M_IOA.F90).'')'
X0001=0
DO
X02='(1X,''FILE'',1X,A12,1X,''ALREADY EXISTS IN THE CURRENT DIRECTORY.'',/,&
&1X,''OVERWRITE?  ENTER  1 TO OVERWRITE,'',/,&
&1X,''               OR  0 TO STOP PROGRAM EXECUTION.'')'
WRITE(*,X02)X01
READ(*,*,IOSTAT=IOS)X0003
X00067=1
CALL TESTIO(X00068,X01,X00069,X00067)
IF(X0003.EQ.1)THEN
RETURN
ELSE IF(X0003.EQ.0)THEN
X02='(1X,''THE USER ELECTED NOT TO OVERWRITE FILE'',1X,A12,1X,''.'',/,&
&1X,''PROGRAM EXECUTION WAS TERMINATED.'')'
WRITE(X00077,X02)X01
WRITE(*,X02)X01
STOP 'PROGRAM EXECUTION TERMINATED BY USER.'
ELSE
X02='(1X,''READ STATEMENT ERROR OF UNSPECIFIED NATURE.'',/,&
&1X,''USER PROVIDED INPUT DATA COULD NOT BE READ.'',/,&
&1X,''THE USER MUST ENTER A VALUE OF EITHER 0 OR 1.'')'
WRITE(X00077,X02)
WRITE(*,X02)
IF(X0001.EQ.0)THEN
X0001=1
CYCLE
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''INTERACTIVE INPUT DOES NOT CONFORM TO SPECIFICATIONS.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
END IF
END DO
END SUBROUTINE CKFIL1
END SUBROUTINE CHKFIL
SUBROUTINE READCM(X0040,X04,X01,X0042)
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
IMPLICIT NONE
INTEGER,INTENT(IN)::X04
INTEGER(KIND=X35),INTENT(IN)::X0040
INTEGER(KIND=X35),INTENT(INOUT)::X0042
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::I=X00071
CHARACTER(LEN=12),INTENT(IN)::X01
CHARACTER(LEN=1)::CHAR=' '
CHARACTER(LEN=500)::X02=' '
DO I=1,X0040
X0042=X0042+1
X02='(A1)'
READ(X04,X02,IOSTAT=IOS)CHAR
X00067=2
CALL TESTIO(X04,X01,X0042,X00067)
END DO
END SUBROUTINE READCM
SUBROUTINE RSTIO(X0045,X0044,X00003,X00002,X00001,X04,X01)
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,IOS,X00077
USE DTCNT1,ONLY:X025,X023
IMPLICIT NONE
INTEGER,INTENT(IN)::X04
INTEGER(KIND=X36),INTENT(IN)::X0045,X0044
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X36),DIMENSION(:,:),INTENT(INOUT)::X00003
INTEGER(KIND=X35)::I=X00071,J=X00071,X0042=X00071,X0002=X00071
INTEGER(KIND=X35),DIMENSION(:,:),INTENT(INOUT)::X00002
INTEGER(KIND=X32),DIMENSION(:,:),INTENT(INOUT)::X00001
CHARACTER(LEN=12),INTENT(IN)::X01
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE RSTIO; MODULE GEN_IOA (M_IOA.F90)'')'
X051='(1X,''LOGIC ERROR.  THE VALUE FOR PARAMETER ICOD2 CAN ONLY BE 1 OR 2.'',/,&
&1X,''IT IS:'',1X,I6)'
OPEN(UNIT=X04,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00077,X01,X0002,X00067)
X0042=1
IF(X0044.EQ.1)THEN
IF(X0045.EQ.1)THEN
WRITE(X04)((X00003(I,J),I=1,X023),J=1,X025)
ENDFILE(UNIT=X04,IOSTAT=IOS)
X00067=8
CALL TESTIO(X04,X01,X0002,X00067)
ELSE IF(X0045.EQ.2)THEN
READ(X04,IOSTAT=IOS)((X00003(I,J),I=1,X023),J=1,X025)
X00067=2
CALL TESTIO(X04,X01,X0042,X00067)
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)X0045
WRITE(*,X051)X0045
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
ELSE IF(X0044.EQ.2)THEN
IF(X0045.EQ.1)THEN
WRITE(X04)((X00002(I,J),I=1,X023),J=1,X025)
ENDFILE(UNIT=X04,IOSTAT=IOS)
X00067=8
CALL TESTIO(X04,X01,X0002,X00067)
ELSE IF(X0045.EQ.2)THEN
READ(X04,IOSTAT=IOS)((X00002(I,J),I=1,X023),J=1,X025)
X00067=2
CALL TESTIO(X04,X01,X0042,X00067)
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)X0045
WRITE(*,X051)X0045
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
ELSE IF(X0044.EQ.3)THEN
IF(X0045.EQ.1)THEN
WRITE(X04)((X00001(I,J),I=1,X023),J=1,X025)
ENDFILE(UNIT=X04,IOSTAT=IOS)
X00067=8
CALL TESTIO(X04,X01,X0002,X00067)
ELSE IF(X0045.EQ.2)THEN
READ(X04,IOSTAT=IOS)((X00001(I,J),I=1,X023),J=1,X025)
X00067=2
CALL TESTIO(X04,X01,X0042,X00067)
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)X0045
WRITE(*,X051)X0045
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''LOGIC ERROR.  THE VALUE FOR PARAMETER ICOD3 CAN ONLY BE 1, 2 OR 3.'',/,&
&1X,''IT IS:'',1X,I6)'
WRITE(X00077,X02)X0044
WRITE(*,X02)X0044
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CLOSE(UNIT=X04,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X04,X01,X0002,X00067)
END SUBROUTINE RSTIO
SUBROUTINE TESTIO(X04,X01,X0042,X00067)
USE STSYS1,ONLY:X36,X35,IOS,X00077
IMPLICIT NONE
INTEGER,INTENT(IN)::X04
INTEGER(KIND=X36),INTENT(IN)::X00067
INTEGER(KIND=X35),INTENT(IN)::X0042
CHARACTER(LEN=12),INTENT(IN)::X01
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' ', X071=' ', X072=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE TESTIO; MODULE GENIO1 (M_IOA.F90).'')'
X051='(1X,''INPUT FILE UNIT:'',1X,I3,/,&
&1X,''INPUT FILE NAME:'',1X,A12,/,&
&1X,''RECORD NUMBER:'',3X,I4)'
X071='(1X,''INPUT FILE UNIT:'',1X,I3,5X,''(ZERO (0) MEANS INTERACTIVE INPUT)'',/,&
&1X,''INPUT FILE NAME:'',1X,A12)'
X072='(1X,''INPUT VARIABLE NAME:'',1X,A12)'


SELECT CASE(X00067)
CASE(1_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE IF(IOS.GT.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''READ ERROR OF UNSPECIFIED NATURE OCCURED DURING INTERACTIVE INPUT.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(X00077,X02)IOS
WRITE(*,X02)IOS
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
ELSE IF(IOS.LT.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''END-OF-FILE  OR  END-OF-RECORD  WAS ENCOUNTERED DURING READ.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(X00077,X02)IOS
WRITE(*,X02)IOS
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(2_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE IF(IOS.GT.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''READ STATEMENT ERROR OF UNSPECIFIED NATURE.'',/,&
&1X,''DATA COULD NOT BE READ.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(X00077,X02)IOS
WRITE(*,X02)IOS
WRITE(X00077,X051)X04,X01,X0042
WRITE(*,X051)X04,X01,X0042
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
ELSE IF(IOS.LT.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''READ STATEMENT ERROR: END-OF-FILE  OR  END-OF-RECORD.'',/,&
&1X,''DATA COULD NOT BE READ.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(X00077,X02)IOS
WRITE(*,X02)IOS
WRITE(X00077,X051)X04,X01,X0042
WRITE(*,X051)X04,X01,X0042
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(3_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING FILE OPENING OPERATION.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(X00077,X02)IOS
WRITE(*,X02)IOS
WRITE(X00077,X071)X04,X01
WRITE(*,X071)X04,X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(4_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING FILE OPENING OF THE REPORT FILE.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(*,X02)IOS
WRITE(*,X071)X04,X01
STOP 'ABNORMAL PROGRAM TERMINATION.'
END IF
CASE(5_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING FILE CLOSING OPERATION.'',/,&
&1X,''IOSTAT VALUE:'',1X,I5)'
WRITE(*,X02)IOS
WRITE(*,X071)X04,X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(6_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING ALLOCATION OPERATION.'',/,&
&1X,''STAT VALUE:'',1X,I5)'
WRITE(*,X02)IOS
WRITE(*,X072)X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(7_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING DEALLOCATION OPERATION.'',/,&
&1X,''STAT VALUE:'',1X,I5)'
WRITE(*,X02)IOS
WRITE(*,X072)X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(8_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING ENDFILE OPERATION.'',/,&
&1X,''STAT VALUE:'',1X,I5)'
WRITE(*,X02)IOS
WRITE(*,X071)X04,X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE(9_X36)
IF(IOS.EQ.0)THEN
RETURN
ELSE
WRITE(*,X053)
X02='(1X,''UNSPECIFIED ERROR DURING BACKSPACE OPERATION.'',/,&
&1X,''STAT VALUE:'',1X,I5)'
WRITE(*,X02)IOS
WRITE(*,X071)X04,X01
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CASE DEFAULT
WRITE(*,X053)
X02='(1X,''LOGIC ERROR.  NO ACCEPTABLE VALUE FOR ICASE2 WAS ENCOUNTERED.'',/,&
&1X,''ICASE2 VALUE WAS: '',I5)'
WRITE(X00077,X02)X00067
WRITE(*,X02)X00067
END SELECT
END SUBROUTINE TESTIO
END MODULE GENIO1
MODULE GENIO2
CONTAINS
SUBROUTINE IOCAT(X002)
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00073,IOS
USE GENIO1,ONLY:TESTIO
USE DTCNT1,ONLY:X0019,X011
USE DTCHA1,ONLY:X30,X016
USE DTCAT1
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X36),INTENT(IN)::X002
INTEGER(KIND=X35)::X0042=X00071,X0002=X00071
CHARACTER(LEN=12)::X01=' '
X01='OUTCAT.UNF'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
REWIND(UNIT=X00073)
IF(X002.EQ.1)THEN
WRITE(X00073)X011,X0019,X30,X016
WRITE(X00073)X034,X052,X22,X23,ICHA,X00033,X033,&
X18,X19,X20,X21,X035,X037,X036,X038
WRITE(X00073)X00411,X298,V24,V25,X0265,X0266,X0267,&
X0268,X0269,X0271
WRITE(X00073)X00412,X00422,X00432,X00413,X00423,X00433,&
X00414,X00424,X00434,X00415,X00425,X00435,&
X00416,X00426,X00436,X00417,X00427,X00437,&
X00418,X00428,X00438,X00419,X00429,X00439,&
X00420,X00430,X00440
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
ELSE IF(X002.EQ.2)THEN
X0042=1
READ(X00073,IOSTAT=IOS)X011,X0019,X30,X016
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073,IOSTAT=IOS)X034,X052,X22,X23,ICHA,X00033,X033,&
X18,X19,X20,X21,X035,X037,X036,X038
READ(X00073)X00411,X298,V24,V25,X0265,X0266,X0267,&
X0268,X0269,X0271
READ(X00073)X00412,X00422,X00432,X00413,X00423,X00433,&
X00414,X00424,X00434,X00415,X00425,X00435,&
X00416,X00426,X00436,X00417,X00427,X00437,&
X00418,X00428,X00438,X00419,X00429,X00439,&
X00420,X00430,X00440
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
END IF
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE IOCAT
SUBROUTINE IOCHA(X002)
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00073,IOS
USE GENIO1,ONLY:TESTIO
USE DTCNT1,ONLY:X0019,X011
USE DTCHA1
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X36),INTENT(IN)::X002
INTEGER(KIND=X35)::X0042=X00071,X0002=X00071
CHARACTER(LEN=12)::X01=' '
X01='OUTCHA.UNF'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
REWIND(UNIT=X00073)
IF(X002.EQ.1)THEN
WRITE(X00073)X0019,X011
WRITE(X00073)X30,X067,X066,X065,X026,X027,X028,X022,X020,&
X021,X017,X0022,X019,X018,X016,X00037,X00038
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
ELSE IF(X002.EQ.2)THEN
X0042=1
READ(X00073,IOSTAT=IOS)X0019,X011
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073,IOSTAT=IOS)X30,X067,X066,X065,X026,X027,X028,&
X022,X020,X021,X017,X0022,X019,X018,X016,X00037,X00038
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
END IF
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE IOCHA
SUBROUTINE IOCHAB(X002)
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00073,IOS
USE DTCNT1,ONLY:X011
USE DTBIN1,ONLY:X00369
USE DTCHAB,ONLY:X0020,X029,X0064,X0021,X00034,X030,X031,X032,X00035,X00036
USE DTSEQ1,ONLY:X00013,X00017,X00014,X00015,X00006,X00007,X00016,&
X00005,X00009,X00011,X00012
USE GENIO1,ONLY:TESTIO
IMPLICIT NONE
INTEGER(KIND=X36),INTENT(IN)::X002
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071,X0042=X00071
CHARACTER(LEN=12)::X01=' '
X01='RBNET.UNF'
OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
REWIND(UNIT=X00073)
IF(X002.EQ.1)THEN
WRITE(X00073)X00369,X011
WRITE(X00073)X00013,X00017,X00014,X00015,X00006,X00007,X00016,&
X00005,X00009,X00011,X00012
WRITE(X00073)X0021,X00034,X0064,X029,X030,X031,X0020,X032,X00035,X00036
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
ELSE IF(X002.EQ.2)THEN
X0042=1
READ(X00073,IOSTAT=IOS)X00369,X011
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073,IOSTAT=IOS)X00013,X00017,X00014,X00015,X00006,X00007,X00016,&
X00005,X00009,X00011,X00012
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073,IOSTAT=IOS)X0021,X00034,X0064,X029,X030,X031,X0020,X032,&
X00035,X00036
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
END IF
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE IOCHAB
SUBROUTINE IOCNT(X002)
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00080,IOS
USE DTCNT1
USE GENIO1,ONLY:TESTIO
USE GENER1,ONLY:PARVER
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X36)::X0007=X00070,X0008=X00070,X007=X00070,X0043=X00070,X0046=X00070
INTEGER(KIND=X36),INTENT(IN)::X002
INTEGER(KIND=X35)::X0002=X00071,X0042=X00071
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=12)::PVNM=' ', SBNM=' '
X01='OUTCNT.UNF'
OPEN(UNIT=X00080,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00080,X01,X0002,X00067)
REWIND(UNIT=X00080)
IF(X002.EQ.1)THEN
WRITE(X00080)&
X17,X16,X15,X011,&
IORD,X056,X38,X057,X054,X0016,X07,X206,X040,&
X0026,X0027,X0028,X0014,X001,X010,&
X023,X025,X0025,X0024,X014,X09,X10,X039,X041,&
X0029,X0030,X00045,X00041,X00042,X00043,&
X00049,X00048,X00044,X00040,X006,X005,X0017,X0023,&
X042,X015,X12,X13,X14,X0031,X00050,X00046,&
X00039,X0019,X00030,X00029,X00031,X00032,X0018
WRITE(X00080)&
X00027,X00028,X00053,X00084,X00055
WRITE(X00080)&
X00056,X00057,X00058,X00059,X00060,X00065,X00444,X00443,&
X00441,X00442
WRITE(X00080)X00051,X00052,X00054
ENDFILE(UNIT=X00080,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00080,X01,X0002,X00067)
CLOSE(UNIT=X00080,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00080,X01,X0002,X00067)
ELSE IF(X002.EQ.2)THEN
X0042=1
READ(X00080,IOSTAT=IOS)&
X17,X16,X15,X011,&
X0007,X0008,X007,X0043,X0046,X0016,X07,X206,X040,&
X0026,X0027,X0028,X0014,X001,X010,&
X023,X025,X0025,X0024,X014,X09,X10,X039,X041,&
X0029,X0030,X00045,X00041,X00042,X00043,&
X00049,X00048,X00044,X00040,X006,X005,X0017,X0023,&
X042,X015,X12,X13,X14,X0031,X00050,X00046,&
X00039,X0019,X00030,X00029,X00031,X00032,X0018
X00067=2
CALL TESTIO(X00080,X01,X0042,X00067)
X0042=X0042+1
READ(X00080,IOSTAT=IOS)&
X00027,X00028,X00053,X00084,X00055
X00067=2
CALL TESTIO(X00080,X01,X0042,X00067)
X0042=X0042+1
READ(X00080,IOSTAT=IOS)&
X00056,X00057,X00058,X00059,X00060,X00065,X00444,X00443,&
X00441,X00442
X00067=2
CALL TESTIO(X00080,X01,X0042,X00067)
X0042=X0042+1
READ(X00080,IOSTAT=IOS)X00051,X00052,X00054
X00067=2
CALL TESTIO(X00080,X01,X0042,X00067)
CLOSE(UNIT=X00080,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00080,X01,X0002,X00067)
SBNM='IOCNT'
PVNM='IOPS'
CALL PARVER(PVNM,SBNM,INT(X056,KIND=X35),INT(X0008,KIND=X35))
PVNM='IORD'
CALL PARVER(PVNM,SBNM,INT(IORD,KIND=X35),INT(X0007,KIND=X35))
PVNM='NMD'
CALL PARVER(PVNM,SBNM,INT(X38,KIND=X35),INT(X007,KIND=X35))
PVNM='INCD'
CALL PARVER(PVNM,SBNM,INT(X057,KIND=X35),INT(X0043,KIND=X35))
PVNM='ICLS'
CALL PARVER(PVNM,SBNM,INT(X054,KIND=X35),INT(X0046,KIND=X35))
END IF
END SUBROUTINE IOCNT
SUBROUTINE IOCTB(X002)
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00073,IOS
USE GENIO1,ONLY:TESTIO
USE DTBIN1,ONLY:X00369
USE DTCNT1,ONLY:X011
USE DTCATB
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X36),INTENT(IN)::X002
INTEGER(KIND=X35)::X0042=X00071,X0002=X00071
CHARACTER(LEN=12)::X01=' '
X01='RBSBC.UNF'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
REWIND(UNIT=X00073)
IF(X002.EQ.1)THEN
WRITE(X00073)X00369,X011
WRITE(X00073)X236,X0107,X0108,X111,X00137,X00138,X00139
ENDFILE(UNIT=X00073)
ELSE IF(X002.EQ.2)THEN
X0042=1
READ(X00073,IOSTAT=IOS)X00369,X011
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073,IOSTAT=IOS)X236,X0107,X0108,X111,X00137,X00138,X00139
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
END IF
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE IOCTB
SUBROUTINE IOKEY(X002)
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00073,IOS
USE DTCNT1,ONLY:X011,X0019
USE DTBIN1,ONLY:X00369
USE DTCHAB,ONLY:X0223,X00034
USE GENIO1,ONLY:TESTIO
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070,J=X00070
INTEGER(KIND=X36),INTENT(IN)::X002
INTEGER(KIND=X35)::X0042=X00071,X0002=X00071,I=X00071,X00074=X00071
CHARACTER(LEN=12)::X01=' '
X01='RBKEY.UNF'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=4
CALL TESTIO(X00073,X01,X0002,X00067)
IF(X002.EQ.1)THEN
X00074=X0019+1
WRITE(X00073)X00074
WRITE(X00073)((X0223(I,J),I=1,X00074),J=1,7)
WRITE(X00073)X00369
WRITE(X00073)(X00034(I),I=1,X00369)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
ELSE IF(X002.EQ.2)THEN
X0042=1
READ(X00073)X00074
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073)((X0223(I,J),I=1,X00074),J=1,7)
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073)X00369
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
X0042=X0042+1
READ(X00073)(X00034(I),I=1,X00369)
X00067=2
CALL TESTIO(X00073,X01,X0042,X00067)
END IF
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE IOKEY
END MODULE GENIO2
MODULE ALDAL
CONTAINS
SUBROUTINE ALCATB
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00072,IOS
USE GENIO1,ONLY:TESTIO
USE DTCATB
USE DTCNT1,ONLY:X011
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X0107(X011),STAT=IOS)
X00067=6
X01='IRDRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0107=X00070
ALLOCATE(X236(X011),STAT=IOS)
X00067=6
X01='IDXB'
CALL TESTIO(X00069,X01,X0002,X00067)
X236=X00070
ALLOCATE(X0108(X011),STAT=IOS)
X00067=6
X01='CHART'
CALL TESTIO(X00069,X01,X0002,X00067)
X0108=X00072
ALLOCATE(X111(X011),STAT=IOS)
X00067=6
X01='SRCB'
CALL TESTIO(X00069,X01,X0002,X00067)
X111=X00072
ALLOCATE(X00137(X011),STAT=IOS)
X00067=6
X01='VLFARB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00137=X00072
ALLOCATE(X00138(X011),STAT=IOS)
X00067=6
X01='VRGARB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00138=X00072
ALLOCATE(X00139(X011),STAT=IOS)
X00067=6
X01='TOTARB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00139=X00072
END SUBROUTINE ALCATB
SUBROUTINE ALCAT1
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00081,X00072,IOS
USE GENIO1,ONLY:TESTIO
USE DTCAT1
USE DTCNT1,ONLY:X011
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X034(X011),STAT=IOS)
X00067=6
X01='IRDR'
CALL TESTIO(X00069,X01,X0002,X00067)
X034=X00070
ALLOCATE(X00033(X011),STAT=IOS)
X00067=6
X01='ITOTAR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00033=X00081
ALLOCATE(ICHA(X011),STAT=IOS)
X00067=6
X01='ICHA'
CALL TESTIO(X00069,X01,X0002,X00067)
ICHA=X00081
ALLOCATE(X052(X011),STAT=IOS)
X00067=6
X01='ISRC'
CALL TESTIO(X00069,X01,X0002,X00067)
X052=X00081
ALLOCATE(X22(X011),STAT=IOS)
X00067=6
X01='ILA'
CALL TESTIO(X00069,X01,X0002,X00067)
X22=X00081
ALLOCATE(X23(X011),STAT=IOS)
X00067=6
X01='IRA'
CALL TESTIO(X00069,X01,X0002,X00067)
X23=X00081
ALLOCATE(X033(X011,5),STAT=IOS)
X00067=6
X01='ISUB'
CALL TESTIO(X00069,X01,X0002,X00067)
X033=X00081
ALLOCATE(X18(X011,6),STAT=IOS)
X00067=6
X01='MNR'
CALL TESTIO(X00069,X01,X0002,X00067)
X18=X00071
ALLOCATE(X19(X011,6),STAT=IOS)
X00067=6
X01='MNC'
CALL TESTIO(X00069,X01,X0002,X00067)
X19=X00071
ALLOCATE(X20(X011,6),STAT=IOS)
X00067=6
X01='MXR'
CALL TESTIO(X00069,X01,X0002,X00067)
X20=X00071
ALLOCATE(X21(X011,6),STAT=IOS)
X00067=6
X01='MXC'
CALL TESTIO(X00069,X01,X0002,X00067)
X21=X00071
ALLOCATE(X035(X011,4),STAT=IOS)
X00067=6
X01='IMNR'
CALL TESTIO(X00069,X01,X0002,X00067)
X035=X00071
ALLOCATE(X037(X011,4),STAT=IOS)
X00067=6
X01='IMNC'
CALL TESTIO(X00069,X01,X0002,X00067)
X037=X00071
ALLOCATE(X036(X011,4),STAT=IOS)
X00067=6
X01='IMXR'
CALL TESTIO(X00069,X01,X0002,X00067)
X036=X00071
ALLOCATE(X038(X011,4),STAT=IOS)
X00067=6
X01='IMXC'
CALL TESTIO(X00069,X01,X0002,X00067)
X038=X00071
ALLOCATE(X00411(X011),STAT=IOS)
X00067=6
X01='TOTARH'
CALL TESTIO(X00069,X01,X0002,X00067)
X00411=X00072
ALLOCATE(X298(X011),STAT=IOS)
X00067=6
X01='SRCH'
CALL TESTIO(X00069,X01,X0002,X00067)
X298=X00072
ALLOCATE(V24(X011),STAT=IOS)
X00067=6
X01='LAH'
CALL TESTIO(X00069,X01,X0002,X00067)
V24=X00072
ALLOCATE(V25(X011),STAT=IOS)
X00067=6
X01='RAH'
CALL TESTIO(X00069,X01,X0002,X00067)
V25=X00072
ALLOCATE(X0265(X011),STAT=IOS)
X00067=6
X01='SCDMS'
CALL TESTIO(X00069,X01,X0002,X00067)
X0265=X00072
ALLOCATE(X0266(X011),STAT=IOS)
X00067=6
X01='SCDMR'
CALL TESTIO(X00069,X01,X0002,X00067)
X0266=X00072
ALLOCATE(X0267(X011),STAT=IOS)
X00067=6
X01='SCDML'
CALL TESTIO(X00069,X01,X0002,X00067)
X0267=X00072
ALLOCATE(X0268(X011),STAT=IOS)
X00067=6
X01='FPLNS'
CALL TESTIO(X00069,X01,X0002,X00067)
X0268=X00072
ALLOCATE(X0269(X011),STAT=IOS)
X00067=6
X01='FPLNR'
CALL TESTIO(X00069,X01,X0002,X00067)
X0269=X00072
ALLOCATE(X0271(X011),STAT=IOS)
X00067=6
X01='FPLNL'
CALL TESTIO(X00069,X01,X0002,X00067)
X0271=X00072
ALLOCATE(X00412(X011),STAT=IOS)
X00067=6
X01='SLOPS1'
CALL TESTIO(X00069,X01,X0002,X00067)
X00412=X00072
ALLOCATE(X00422(X011),STAT=IOS)
X00067=6
X01='SLOPR1'
CALL TESTIO(X00069,X01,X0002,X00067)
X00422=X00072
ALLOCATE(X00432(X011),STAT=IOS)
X00067=6
X01='SLOPL1'
CALL TESTIO(X00069,X01,X0002,X00067)
X00432=X00072
ALLOCATE(X00413(X011),STAT=IOS)
X00067=6
X01='SLOPS2'
CALL TESTIO(X00069,X01,X0002,X00067)
X00413=X00072
ALLOCATE(X00423(X011),STAT=IOS)
X00067=6
X01='SLOPR2'
CALL TESTIO(X00069,X01,X0002,X00067)
X00423=X00072
ALLOCATE(X00433(X011),STAT=IOS)
X00067=6
X01='SLOPL2'
CALL TESTIO(X00069,X01,X0002,X00067)
X00433=X00072
ALLOCATE(X00414(X011),STAT=IOS)
X00067=6
X01='SLOPS3'
CALL TESTIO(X00069,X01,X0002,X00067)
X00414=X00072
ALLOCATE(X00424(X011),STAT=IOS)
X00067=6
X01='SLOPR3'
CALL TESTIO(X00069,X01,X0002,X00067)
X00424=X00072
ALLOCATE(X00434(X011),STAT=IOS)
X00067=6
X01='SLOPL3'
CALL TESTIO(X00069,X01,X0002,X00067)
X00434=X00072
ALLOCATE(X00415(X011),STAT=IOS)
X00067=6
X01='SLOPS4'
CALL TESTIO(X00069,X01,X0002,X00067)
X00415=X00072
ALLOCATE(X00425(X011),STAT=IOS)
X00067=6
X01='SLOPR4'
CALL TESTIO(X00069,X01,X0002,X00067)
X00425=X00072
ALLOCATE(X00435(X011),STAT=IOS)
X00067=6
X01='SLOPL4'
CALL TESTIO(X00069,X01,X0002,X00067)
X00435=X00072
ALLOCATE(X00416(X011),STAT=IOS)
X00067=6
X01='SLOPS5'
CALL TESTIO(X00069,X01,X0002,X00067)
X00416=X00072
ALLOCATE(X00426(X011),STAT=IOS)
X00067=6
X01='SLOPR5'
CALL TESTIO(X00069,X01,X0002,X00067)
X00426=X00072
ALLOCATE(X00436(X011),STAT=IOS)
X00067=6
X01='SLOPL5'
CALL TESTIO(X00069,X01,X0002,X00067)
X00436=X00072
ALLOCATE(X00417(X011),STAT=IOS)
X00067=6
X01='SLOPS6'
CALL TESTIO(X00069,X01,X0002,X00067)
X00417=X00072
ALLOCATE(X00427(X011),STAT=IOS)
X00067=6
X01='SLOPR6'
CALL TESTIO(X00069,X01,X0002,X00067)
X00427=X00072
ALLOCATE(X00437(X011),STAT=IOS)
X00067=6
X01='SLOPL6'
CALL TESTIO(X00069,X01,X0002,X00067)
X00437=X00072
ALLOCATE(X00418(X011),STAT=IOS)
X00067=6
X01='SLOPS7'
CALL TESTIO(X00069,X01,X0002,X00067)
X00418=X00072
ALLOCATE(X00428(X011),STAT=IOS)
X00067=6
X01='SLOPR7'
CALL TESTIO(X00069,X01,X0002,X00067)
X00428=X00072
ALLOCATE(X00438(X011),STAT=IOS)
X00067=6
X01='SLOPL7'
CALL TESTIO(X00069,X01,X0002,X00067)
X00438=X00072
ALLOCATE(X00419(X011),STAT=IOS)
X00067=6
X01='SLOPS8'
CALL TESTIO(X00069,X01,X0002,X00067)
X00419=X00072
ALLOCATE(X00429(X011),STAT=IOS)
X00067=6
X01='SLOPR8'
CALL TESTIO(X00069,X01,X0002,X00067)
X00429=X00072
ALLOCATE(X00439(X011),STAT=IOS)
X00067=6
X01='SLOPL8'
CALL TESTIO(X00069,X01,X0002,X00067)
X00439=X00072
ALLOCATE(X00420(X011),STAT=IOS)
X00067=6
X01='SLOPS9'
CALL TESTIO(X00069,X01,X0002,X00067)
X00420=X00072
ALLOCATE(X00430(X011),STAT=IOS)
X00067=6
X01='SLOPR9'
CALL TESTIO(X00069,X01,X0002,X00067)
X00430=X00072
ALLOCATE(X00440(X011),STAT=IOS)
X00067=6
X01='SLOPL9'
CALL TESTIO(X00069,X01,X0002,X00067)
X00440=X00072
ALLOCATE(X00421(X011),STAT=IOS)
X00067=6
X01='SLPS10'
CALL TESTIO(X00069,X01,X0002,X00067)
X00421=X00072
ALLOCATE(X00431(X011),STAT=IOS)
X00067=6
X01='SLPR10'
CALL TESTIO(X00069,X01,X0002,X00067)
X00431=X00072
ALLOCATE(X00445(X011),STAT=IOS)
X00067=6
X01='SLPL10'
CALL TESTIO(X00069,X01,X0002,X00067)
X00445=X00072
END SUBROUTINE ALCAT1
SUBROUTINE ALCHAB
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00081,X00072,IOS
USE GENIO1,ONLY:TESTIO
USE DTCHAB
USE DTCNT1,ONLY:X011
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X029(X011),STAT=IOS)
X00067=6
X01='NORB'
CALL TESTIO(X00069,X01,X0002,X00067)
X029=X00070
ALLOCATE(X0064(X011),STAT=IOS)
X00067=6
X01='NODNB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0064=X00071
ALLOCATE(X00034(X011),STAT=IOS)
X00067=6
X01='KEYSUB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00034=X00071
ALLOCATE(X0223(X011,7),STAT=IOS)
X00067=6
X01='KEYRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0223=X00071
ALLOCATE(X0020(X011),STAT=IOS)
X00067=6
X01='IEULB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0020=X00081
ALLOCATE(X0021(X011),STAT=IOS)
X00067=6
X01='DISTB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0021=X00072
ALLOCATE(X00035(X011),STAT=IOS)
X00067=6
X01='SLPLKB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00035=X00072
ALLOCATE(X00036(X011),STAT=IOS)
X00067=6
X01='SLPSMB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00036=X00072
ALLOCATE(X030(X011),STAT=IOS)
X00067=6
X01='AUPB'
CALL TESTIO(X00069,X01,X0002,X00067)
X030=X00072
ALLOCATE(X031(X011),STAT=IOS)
X00067=6
X01='ADRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X031=X00072
ALLOCATE(X032(X011),STAT=IOS)
X00067=6
X01='ADWB'
CALL TESTIO(X00069,X01,X0002,X00067)
X032=X00072
END SUBROUTINE ALCHAB
SUBROUTINE ALCHA1
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00081,X00072,IOS
USE GENIO1,ONLY:TESTIO
USE DTCHA1
USE DTCNT1,ONLY:X011
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X30(X011),STAT=IOS)
X00067=6
X01='NOR'
CALL TESTIO(X00069,X01,X0002,X00067)
X30=X00070
ALLOCATE(X067(X011),STAT=IOS)
X00067=6
X01='IRST'
CALL TESTIO(X00069,X01,X0002,X00067)
X067=X00071
ALLOCATE(X066(X011),STAT=IOS)
X00067=6
X01='ICST'
CALL TESTIO(X00069,X01,X0002,X00067)
X066=X00071
ALLOCATE(X065(X011),STAT=IOS)
X00067=6
X01='IRPV'
CALL TESTIO(X00069,X01,X0002,X00067)
X065=X00071
ALLOCATE(X026(X011),STAT=IOS)
X00067=6
X01='ICPV'
CALL TESTIO(X00069,X01,X0002,X00067)
X026=X00071
ALLOCATE(X027(X011),STAT=IOS)
X00067=6
X01='IRCT'
CALL TESTIO(X00069,X01,X0002,X00067)
X027=X00071
ALLOCATE(X028(X011),STAT=IOS)
X00067=6
X01='ICCT'
CALL TESTIO(X00069,X01,X0002,X00067)
X028=X00071
ALLOCATE(X016(X011,7),STAT=IOS)
X00067=6
X01='NODN'
CALL TESTIO(X00069,X01,X0002,X00067)
X016=X00071
ALLOCATE(X017(X011),STAT=IOS)
X00067=6
X01='IAUP'
CALL TESTIO(X00069,X01,X0002,X00067)
X017=X00081
ALLOCATE(X018(X011),STAT=IOS)
X00067=6
X01='IADD'
CALL TESTIO(X00069,X01,X0002,X00067)
X018=X00081
ALLOCATE(X0022(X011),STAT=IOS)
X00067=6
X01='IADWP'
CALL TESTIO(X00069,X01,X0002,X00067)
X0022=X00081
ALLOCATE(X019(X011),STAT=IOS)
X00067=6
X01='IADW'
CALL TESTIO(X00069,X01,X0002,X00067)
X019=X00081
ALLOCATE(X020(X011),STAT=IOS)
X00067=6
X01='IEUL'
CALL TESTIO(X00069,X01,X0002,X00067)
X020=X00081
ALLOCATE(X021(X011),STAT=IOS)
X00067=6
X01='IEDL'
CALL TESTIO(X00069,X01,X0002,X00067)
X021=X00081
ALLOCATE(X022(X011),STAT=IOS)
X00067=6
X01='DIST'
CALL TESTIO(X00069,X01,X0002,X00067)
X022=X00072
ALLOCATE(X00037(X011),STAT=IOS)
X00067=6
X01='SLPLNK'
CALL TESTIO(X00069,X01,X0002,X00067)
X00037=X00072
ALLOCATE(X00038(X011),STAT=IOS)
X00067=6
X01='SLPSMT'
CALL TESTIO(X00069,X01,X0002,X00067)
X00038=X00072
END SUBROUTINE ALCHA1
SUBROUTINE ALSBV1
USE STSYS1,ONLY:X36,X35,X33,X00070,X00071,X00082,IOS
USE GENIO1,ONLY:TESTIO
USE DTCNT1,ONLY:X011,IORD
USE DTSBV1
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X00141(IORD),STAT=IOS)
X00067=6
X01='TMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00141=X00082
ALLOCATE(X00140(IORD),STAT=IOS)
X00067=6
X01='TMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00140=X00082
ALLOCATE(X00142(IORD),STAT=IOS)
X00067=6
X01='TMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
X00142=X00082
ALLOCATE(X00143(IORD),STAT=IOS)
X00067=6
X01='TMSDRO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00143=X00082
ALLOCATE(X00144(IORD),STAT=IOS)
X00067=6
X01='CMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00144=X00082
ALLOCATE(X00145(IORD),STAT=IOS)
X00067=6
X01='CMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00145=X00082
ALLOCATE(X00146(IORD),STAT=IOS)
X00067=6
X01='CMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
X00146=X00082
ALLOCATE(X00147(IORD),STAT=IOS)
X00067=6
X01='CSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00147=X00082
ALLOCATE(X00148(IORD),STAT=IOS)
X00067=6
X01='RMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00148=X00082
ALLOCATE(X00149(IORD),STAT=IOS)
X00067=6
X01='RMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00149=X00071
ALLOCATE(X00151(IORD),STAT=IOS)
X00067=6
X01='RMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
X00151=X00082
ALLOCATE(X00150(IORD),STAT=IOS)
X00067=6
X01='RSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00150=X00082
ALLOCATE(X00152(IORD),STAT=IOS)
X00067=6
X01='FMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00152=X00082
ALLOCATE(X00153(IORD),STAT=IOS)
X00067=6
X01='FMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00153=X00071
ALLOCATE(X00154(IORD),STAT=IOS)
X00067=6
X01='FMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
X00154=X00082
ALLOCATE(X00155(IORD),STAT=IOS)
X00067=6
X01='FSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00155=X00082
ALLOCATE(X00156(IORD),STAT=IOS)
X00067=6
X01='DMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00156=X00082
ALLOCATE(X00157(IORD),STAT=IOS)
X00067=6
X01='DMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00157=X00082
ALLOCATE(X00158(IORD),STAT=IOS)
X00067=6
X01='DMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
X00158=X00082
ALLOCATE(X00159(IORD),STAT=IOS)
X00067=6
X01='DSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00159=X00082
ALLOCATE(X0109(X011),STAT=IOS)
X00067=6
X01='DAREA'
CALL TESTIO(X00069,X01,X0002,X00067)
X0109=X00082
ALLOCATE(X45(IORD),STAT=IOS)
X00067=6
X01='TOT'
CALL TESTIO(X00069,X01,X0002,X00067)
X45=X00082
ALLOCATE(X112(IORD),STAT=IOS)
X00067=6
X01='TCAO'
CALL TESTIO(X00069,X01,X0002,X00067)
X112=X00082
END SUBROUTINE ALSBV1
SUBROUTINE ALSBV3
USE STSYS1,ONLY:X36,X35,X32,X33,X00070,X00071,X00081,X00082,IOS
USE GENIO1,ONLY:TESTIO
USE DTCNT1,ONLY:X011,IORD
USE DTSBV3
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X00176(X011),STAT=IOS)
X00067=6
X01='DINARB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00176=X00082
ALLOCATE(X114(IORD),STAT=IOS)
X00067=6
X01='TOTB'
CALL TESTIO(X00069,X01,X0002,X00067)
X114=X00082
ALLOCATE(X0111(IORD),STAT=IOS)
X00067=6
X01='TCAOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0111=X00082
ALLOCATE(X00161(IORD),STAT=IOS)
X00067=6
X01='TMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00161=X00082
ALLOCATE(X00160(IORD),STAT=IOS)
X00067=6
X01='TMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00160=X00082
ALLOCATE(X00162(IORD),STAT=IOS)
X00067=6
X01='TMDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00162=X00082
ALLOCATE(X00163(IORD),STAT=IOS)
X00067=6
X01='TMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00163=X00082
ALLOCATE(X00164(IORD),STAT=IOS)
X00067=6
X01='CMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00164=X00082
ALLOCATE(X00165(IORD),STAT=IOS)
X00067=6
X01='CMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00165=X00082
ALLOCATE(X00166(IORD),STAT=IOS)
X00067=6
X01='CMDDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00166=X00082
ALLOCATE(X00167(IORD),STAT=IOS)
X00067=6
X01='CMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00167=X00082
ALLOCATE(X00168(IORD),STAT=IOS)
X00067=6
X01='RMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00168=X00082
ALLOCATE(X00169(IORD),STAT=IOS)
X00067=6
X01='RMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00169=X00071
ALLOCATE(X00171(IORD),STAT=IOS)
X00067=6
X01='RMDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00171=X00082
ALLOCATE(X00170(IORD),STAT=IOS)
X00067=6
X01='RMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00170=X00082
ALLOCATE(X00172(IORD),STAT=IOS)
X00067=6
X01='FMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00172=X00082
ALLOCATE(X00173(IORD),STAT=IOS)
X00067=6
X01='FMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00173=X00071
ALLOCATE(X00174(IORD),STAT=IOS)
X00067=6
X01='FMDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00174=X00082
ALLOCATE(X00175(IORD),STAT=IOS)
X00067=6
X01='FMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00175=X00082
END SUBROUTINE ALSBV3
SUBROUTINE ALSEQ1
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSEQ1
USE DTCNT1,ONLY:X011
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X00005(X011),STAT=IOS)
X00067=6
X01='NODCOD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00005=X00070
ALLOCATE(X00006(X011),STAT=IOS)
X00067=6
X01='NODROU'
CALL TESTIO(X00069,X01,X0002,X00067)
X00006=X00070
ALLOCATE(X00007(X011),STAT=IOS)
X00067=6
X01='NODORD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00007=X00070
ALLOCATE(X00013(X011),STAT=IOS)
X00067=6
X01='NODSEQ'
CALL TESTIO(X00069,X01,X0002,X00067)
X00013=X00071
ALLOCATE(X00014(X011),STAT=IOS)
X00067=6
X01='NODEXE'
CALL TESTIO(X00069,X01,X0002,X00067)
X00014=X00071
ALLOCATE(X00015(X011),STAT=IOS)
X00067=6
X01='NODTMP'
CALL TESTIO(X00069,X01,X0002,X00067)
X00015=X00071
ALLOCATE(X00016(X011),STAT=IOS)
X00067=6
X01='NEXNOD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00016=X00071
ALLOCATE(X00009(X011),STAT=IOS)
X00067=6
X01='NID1CT'
CALL TESTIO(X00069,X01,X0002,X00067)
X00009=X00071
ALLOCATE(X00011(X011),STAT=IOS)
X00067=6
X01='NID3CT'
CALL TESTIO(X00069,X01,X0002,X00067)
X00011=X00071
ALLOCATE(X00012(X011),STAT=IOS)
X00067=6
X01='NBRANC'
CALL TESTIO(X00069,X01,X0002,X00067)
X00012=X00071
ALLOCATE(X00017(3,X011),STAT=IOS)
X00067=6
X01='INFLOW'
CALL TESTIO(X00069,X01,X0002,X00067)
X00017=X00071
END SUBROUTINE ALSEQ1
SUBROUTINE ALSTA1
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00072,X00082,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA1
USE DTCNT1,ONLY:IORD
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(IVAL(IORD),STAT=IOS)
X00067=6
X01='IVAL'
CALL TESTIO(X00069,X01,X0002,X00067)
IVAL=X00071
ALLOCATE(IOR(IORD),STAT=IOS)
X00067=6
X01='IOR'
CALL TESTIO(X00069,X01,X0002,X00067)
IOR=X00071
ALLOCATE(VL(IORD),STAT=IOS)
X00067=6
X01='VL'
CALL TESTIO(X00069,X01,X0002,X00067)
VL=X00072
ALLOCATE(X46(IORD),STAT=IOS)
X00067=6
X01='VMN'
CALL TESTIO(X00069,X01,X0002,X00067)
X46=X00072
ALLOCATE(X47(IORD),STAT=IOS)
X00067=6
X01='VMX'
CALL TESTIO(X00069,X01,X0002,X00067)
X47=X00072
ALLOCATE(X48(IORD),STAT=IOS)
X00067=6
X01='VLM'
CALL TESTIO(X00069,X01,X0002,X00067)
X48=X00072
ALLOCATE(X49(IORD),STAT=IOS)
X00067=6
X01='VLO'
CALL TESTIO(X00069,X01,X0002,X00067)
X49=X00072
ALLOCATE(AR(IORD),STAT=IOS)
X00067=6
X01='AR'
CALL TESTIO(X00069,X01,X0002,X00067)
AR=X00072
ALLOCATE(X50(IORD),STAT=IOS)
X00067=6
X01='ARO'
CALL TESTIO(X00069,X01,X0002,X00067)
X50=X00072
ALLOCATE(X113(IORD),STAT=IOS)
X00067=6
X01='AROP'
CALL TESTIO(X00069,X01,X0002,X00067)
X113=X00072
ALLOCATE(X51(IORD),STAT=IOS)
X00067=6
X01='DDO'
CALL TESTIO(X00069,X01,X0002,X00067)
X51=X00072
ALLOCATE(X00226(IORD),STAT=IOS)
X00067=6
X01='VLOSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00226=X00072
ALLOCATE(X00227(IORD),STAT=IOS)
X00067=6
X01='VLMSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00227=X00072
ALLOCATE(X00228(IORD),STAT=IOS)
X00067=6
X01='ELDSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00228=X00072
ALLOCATE(X00229(IORD),STAT=IOS)
X00067=6
X01='ELOUDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00229=X00072
ALLOCATE(X00231(IORD),STAT=IOS)
X00067=6
X01='ELODDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00231=X00072
ALLOCATE(X00230(IORD),STAT=IOS)
X00067=6
X01='SLCLDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00230=X00072
ALLOCATE(X00232(IORD),STAT=IOS)
X00067=6
X01='SLOSDR'
CALL TESTIO(X00069,X01,X0002,X00067)
X00232=X00072
ALLOCATE(X00233(IORD),STAT=IOS)
X00067=6
X01='ACLSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00233=X00072
ALLOCATE(X00234(IORD),STAT=IOS)
X00067=6
X01='ARCLPD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00234=X00072
ALLOCATE(X00235(IORD),STAT=IOS)
X00067=6
X01='ARCLDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00235=X00072
ALLOCATE(X00236(IORD),STAT=IOS)
X00067=6
X01='WSLOSD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00236=X00072
ALLOCATE(X0122(IORD),STAT=IOS)
X00067=6
X01='VMDDO'
CALL TESTIO(X00069,X01,X0002,X00067)
X0122=X00072
ALLOCATE(X00237(IORD),STAT=IOS)
X00067=6
X01='SDMDDO'
CALL TESTIO(X00069,X01,X0002,X00067)
X00237=X00072
ALLOCATE(X00238(IORD),STAT=IOS)
X00067=6
X01='ELUSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
X00238=X00072
ALLOCATE(X115(IORD),STAT=IOS)
X00067=6
X01='SLOL'
CALL TESTIO(X00069,X01,X0002,X00067)
X115=X00082
ALLOCATE(X52(IORD),STAT=IOS)
X00067=6
X01='SLO'
CALL TESTIO(X00069,X01,X0002,X00067)
X52=X00082
ALLOCATE(X116(IORD),STAT=IOS)
X00067=6
X01='WSLO'
CALL TESTIO(X00069,X01,X0002,X00067)
X116=X00082
ALLOCATE(X0121(IORD),STAT=IOS)
X00067=6
X01='WLLSD'
CALL TESTIO(X00069,X01,X0002,X00067)
X0121=X00082
ALLOCATE(X00239(IORD),STAT=IOS)
X00067=6
X01='WSLLSD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00239=X00082
ALLOCATE(X0123(IORD),STAT=IOS)
X00067=6
X01='ELORD'
CALL TESTIO(X00069,X01,X0002,X00067)
X0123=X00082
ALLOCATE(X0124(IORD),STAT=IOS)
X00067=6
X01='ELORU'
CALL TESTIO(X00069,X01,X0002,X00067)
X0124=X00082
ALLOCATE(X0126(IORD),STAT=IOS)
X00067=6
X01='ELODL'
CALL TESTIO(X00069,X01,X0002,X00067)
X0126=X00082
ALLOCATE(X0125(IORD),STAT=IOS)
X00067=6
X01='ELOUL'
CALL TESTIO(X00069,X01,X0002,X00067)
X0125=X00082
ALLOCATE(X0127(IORD),STAT=IOS)
X00067=6
X01='WSLOL'
CALL TESTIO(X00069,X01,X0002,X00067)
X0127=X00082
END SUBROUTINE ALSTA1
SUBROUTINE ALSTA3
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00072,X00082,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA3
USE DTCNT1,ONLY:IORD,X011
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X0160(IORD),STAT=IOS)
X00067=6
X01='IVALB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0160=X00071
ALLOCATE(X161(IORD),STAT=IOS)
X00067=6
X01='IORB'
CALL TESTIO(X00069,X01,X0002,X00067)
X161=X00071
ALLOCATE(X153(IORD),STAT=IOS)
X00067=6
X01='SLOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X153=X00082
ALLOCATE(X00303(IORD),STAT=IOS)
X00067=6
X01='ELODLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00303=X00082
ALLOCATE(X00304(IORD),STAT=IOS)
X00067=6
X01='ELORUB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00304=X00082
ALLOCATE(X00305(IORD),STAT=IOS)
X00067=6
X01='ELORDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00305=X00082
ALLOCATE(X00306(IORD),STAT=IOS)
X00067=6
X01='ELOULB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00306=X00082
ALLOCATE(X0156(IORD),STAT=IOS)
X00067=6
X01='WSLOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0156=X00082
ALLOCATE(X00307(IORD),STAT=IOS)
X00067=6
X01='WSLOLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00307=X00082
ALLOCATE(X0157(IORD),STAT=IOS)
X00067=6
X01='SLOLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0157=X00082
ALLOCATE(X179(IORD),STAT=IOS)
X00067=6
X01='VLBT'
CALL TESTIO(X00069,X01,X0002,X00067)
X179=X00082
ALLOCATE(X71(IORD),STAT=IOS)
X00067=6
X01='VLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X71=X00072
ALLOCATE(X154(IORD),STAT=IOS)
X00067=6
X01='VMNB'
CALL TESTIO(X00069,X01,X0002,X00067)
X154=X00072
ALLOCATE(X155(IORD),STAT=IOS)
X00067=6
X01='VMXB'
CALL TESTIO(X00069,X01,X0002,X00067)
X155=X00072
ALLOCATE(X156(IORD),STAT=IOS)
X00067=6
X01='VLMB'
CALL TESTIO(X00069,X01,X0002,X00067)
X156=X00072
ALLOCATE(X157(IORD),STAT=IOS)
X00067=6
X01='VLOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X157=X00072
ALLOCATE(ARB(IORD),STAT=IOS)
X00067=6
X01='ARB'
CALL TESTIO(X00069,X01,X0002,X00067)
ARB=X00072
ALLOCATE(X158(IORD),STAT=IOS)
X00067=6
X01='AROB'
CALL TESTIO(X00069,X01,X0002,X00067)
X158=X00072
ALLOCATE(X0158(IORD),STAT=IOS)
X00067=6
X01='AROPB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0158=X00072
ALLOCATE(X159(IORD),STAT=IOS)
X00067=6
X01='DDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X159=X00072
ALLOCATE(X0159(IORD),STAT=IOS)
X00067=6
X01='VLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0159=X00072
ALLOCATE(X0161(IORD),STAT=IOS)
X00067=6
X01='VOSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0161=X00072
ALLOCATE(X00312(IORD),STAT=IOS)
X00067=6
X01='EDLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00312=X00072
ALLOCATE(X00314(IORD),STAT=IOS)
X00067=6
X01='ELOUSD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00314=X00072
ALLOCATE(X00315(IORD),STAT=IOS)
X00067=6
X01='ELODSD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00315=X00072
ALLOCATE(X00316(IORD),STAT=IOS)
X00067=6
X01='SLLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00316=X00072
ALLOCATE(X00317(IORD),STAT=IOS)
X00067=6
X01='SLOSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00317=X00072
ALLOCATE(X00318(IORD),STAT=IOS)
X00067=6
X01='WSSDLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00318=X00072
ALLOCATE(X00319(IORD),STAT=IOS)
X00067=6
X01='WSSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00319=X00072
ALLOCATE(X160(IORD),STAT=IOS)
X00067=6
X01='DDLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X160=X00072
ALLOCATE(X00308(IORD),STAT=IOS)
X00067=6
X01='DDLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00308=X00072
ALLOCATE(X00309(IORD),STAT=IOS)
X00067=6
X01='DDASDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00309=X00072
ALLOCATE(X00313(IORD),STAT=IOS)
X00067=6
X01='EULSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00313=X00072
ALLOCATE(X00310(IORD),STAT=IOS)
X00067=6
X01='VARSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00310=X00072
ALLOCATE(X00311(IORD),STAT=IOS)
X00067=6
X01='VAPSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00311=X00072
ALLOCATE(X00321(X011),STAT=IOS)
X00067=6
X01='CSLOPB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00321=X00072
END SUBROUTINE ALSTA3
SUBROUTINE ALSTA5
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00081,X00082,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA5
USE DTCNT1,ONLY:X011,IORD
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(IAR(IORD),STAT=IOS)
X00067=6
X01='IAR'
CALL TESTIO(X00069,X01,X0002,X00067)
IAR=X00081
ALLOCATE(X151(IORD),STAT=IOS)
X00067=6
X01='IARO'
CALL TESTIO(X00069,X01,X0002,X00067)
X151=X00081
ALLOCATE(X0147(IORD),STAT=IOS)
X00067=6
X01='IAROP'
CALL TESTIO(X00069,X01,X0002,X00067)
X0147=X00081
ALLOCATE(X70(IORD),STAT=IOS)
X00067=6
X01='WLL'
CALL TESTIO(X00069,X01,X0002,X00067)
X70=X00082
ALLOCATE(X42(IORD),STAT=IOS)
X00067=6
X01='SUM'
CALL TESTIO(X00069,X01,X0002,X00067)
X42=X00082
ALLOCATE(X103(IORD),STAT=IOS)
X00067=6
X01='SUMP'
CALL TESTIO(X00069,X01,X0002,X00067)
X103=X00082
ALLOCATE(X00337(IORD),STAT=IOS)
X00067=6
X01='VLOC51'
CALL TESTIO(X00069,X01,X0002,X00067)
X00337=X00082
ALLOCATE(X67(IORD),STAT=IOS)
X00067=6
X01='VLX'
CALL TESTIO(X00069,X01,X0002,X00067)
X67=X00082
ALLOCATE(X105(IORD),STAT=IOS)
X00067=6
X01='SUMU'
CALL TESTIO(X00069,X01,X0002,X00067)
X105=X00082
ALLOCATE(X104(IORD),STAT=IOS)
X00067=6
X01='SUMD'
CALL TESTIO(X00069,X01,X0002,X00067)
X104=X00082
ALLOCATE(X0150(X011),STAT=IOS)
X00067=6
X01='VDIST'
CALL TESTIO(X00069,X01,X0002,X00067)
X0150=X00082
ALLOCATE(X147(X011),STAT=IOS)
X00067=6
X01='VLO1'
CALL TESTIO(X00069,X01,X0002,X00067)
X147=X00082
END SUBROUTINE ALSTA5
SUBROUTINE ALSTA6
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00072,X00082,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA6
USE DTCNT1,ONLY:IORD
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
ALLOCATE(X146(IORD),STAT=IOS)
X00067=6
X01='VARB'
CALL TESTIO(X00069,X01,X0002,X00067)
X146=X00072
ALLOCATE(X145(IORD),STAT=IOS)
X00067=6
X01='WLLB'
CALL TESTIO(X00069,X01,X0002,X00067)
X145=X00082
ALLOCATE(X144(IORD),STAT=IOS)
X00067=6
X01='BSUM'
CALL TESTIO(X00069,X01,X0002,X00067)
X144=X00082
ALLOCATE(X00338(IORD),STAT=IOS)
X00067=6
X01='VLOC5B'
CALL TESTIO(X00069,X01,X0002,X00067)
X00338=X00082
ALLOCATE(X0151(IORD),STAT=IOS)
X00067=6
X01='VAROB'
CALL TESTIO(X00069,X01,X0002,X00067)
X0151=X00082
ALLOCATE(X00302(IORD),STAT=IOS)
X00067=6
X01='VAROPB'
CALL TESTIO(X00069,X01,X0002,X00067)
X00302=X00082
END SUBROUTINE ALSTA6
SUBROUTINE DLCATB
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTCATB
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X0107,STAT=IOS)
X00067=6
X01='IRDRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X236,STAT=IOS)
X00067=6
X01='IDXB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0108,STAT=IOS)
X00067=6
X01='CHART'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X111,STAT=IOS)
X00067=6
X01='SRCB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00137,STAT=IOS)
X00067=6
X01='VLFARB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00138,STAT=IOS)
X00067=6
X01='VRGARB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00139,STAT=IOS)
X00067=6
X01='TOTARB'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLCATB
SUBROUTINE DLCAT1
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTCAT1
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X034,STAT=IOS)
X00067=7
X01='IRDR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00033,STAT=IOS)
X00067=7
X01='ITOTAR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(ICHA,STAT=IOS)
X00067=7
X01='ICHA'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X052,STAT=IOS)
X00067=7
X01='ISRC'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X22,STAT=IOS)
X00067=7
X01='ILA'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X23,STAT=IOS)
X00067=7
X01='IRA'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X033,STAT=IOS)
X00067=7
X01='ISUB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X18,STAT=IOS)
X00067=7
X01='MNR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X19,STAT=IOS)
X00067=7
X01='MNC'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X20,STAT=IOS)
X00067=7
X01='MXR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X21,STAT=IOS)
X00067=7
X01='MXC'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X035,STAT=IOS)
X00067=7
X01='IMNR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X037,STAT=IOS)
X00067=7
X01='IMNC'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X036,STAT=IOS)
X00067=7
X01='IMXR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X038,STAT=IOS)
X00067=7
X01='IMXC'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00411,STAT=IOS)
X00067=7
X01='TOTARH'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X298,STAT=IOS)
X00067=7
X01='SRCH'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(V24,STAT=IOS)
X00067=7
X01='LAH'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(V25,STAT=IOS)
X00067=7
X01='RAH'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0268,STAT=IOS)
X00067=7
X01='FPLNS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0269,STAT=IOS)
X00067=7
X01='FPLNR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0271,STAT=IOS)
X00067=7
X01='FPLNL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0265,STAT=IOS)
X00067=7
X01='SCDMS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0266,STAT=IOS)
X00067=7
X01='SCDMR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0267,STAT=IOS)
X00067=7
X01='SCDML'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00412,STAT=IOS)
X00067=7
X01='SLOPS1'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00422,STAT=IOS)
X00067=7
X01='SLOPR1'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00432,STAT=IOS)
X00067=7
X01='SLOPL1'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00413,STAT=IOS)
X00067=7
X01='SLOPS2'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00423,STAT=IOS)
X00067=7
X01='SLOPR2'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00433,STAT=IOS)
X00067=7
X01='SLOPL2'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00414,STAT=IOS)
X00067=7
X01='SLOPS3'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00424,STAT=IOS)
X00067=7
X01='SLOPR3'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00434,STAT=IOS)
X00067=7
X01='SLOPL3'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00415,STAT=IOS)
X00067=7
X01='SLOPS4'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00425,STAT=IOS)
X00067=7
X01='SLOPR4'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00435,STAT=IOS)
X00067=7
X01='SLOPL4'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00416,STAT=IOS)
X00067=7
X01='SLOPS5'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00426,STAT=IOS)
X00067=7
X01='SLOPR5'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00436,STAT=IOS)
X00067=7
X01='SLOPL5'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00417,STAT=IOS)
X00067=7
X01='SLOPS6'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00427,STAT=IOS)
X00067=7
X01='SLOPR6'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00437,STAT=IOS)
X00067=7
X01='SLOPL6'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00418,STAT=IOS)
X00067=7
X01='SLOPS7'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00428,STAT=IOS)
X00067=7
X01='SLOPR7'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00438,STAT=IOS)
X00067=7
X01='SLOPL7'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00419,STAT=IOS)
X00067=7
X01='SLOPS8'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00429,STAT=IOS)
X00067=7
X01='SLOPR8'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00439,STAT=IOS)
X00067=7
X01='SLOPL8'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00420,STAT=IOS)
X00067=7
X01='SLOPS9'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00430,STAT=IOS)
X00067=7
X01='SLOPR9'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00440,STAT=IOS)
X00067=7
X01='SLOPL9'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00421,STAT=IOS)
X00067=7
X01='SLPS10'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00431,STAT=IOS)
X00067=7
X01='SLPR10'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00445,STAT=IOS)
X00067=7
X01='SLPL10'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLCAT1
SUBROUTINE DLCHAB
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTCHAB
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X029,STAT=IOS)
X00067=7
X01='NORB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0064,STAT=IOS)
X00067=7
X01='NODNB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00034,STAT=IOS)
X00067=7
X01='KEYSUB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0223,STAT=IOS)
X00067=7
X01='KEYRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0020,STAT=IOS)
X00067=7
X01='IEULB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0021,STAT=IOS)
X00067=7
X01='DISTB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00035,STAT=IOS)
X00067=7
X01='SLPLKB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00036,STAT=IOS)
X00067=7
X01='SLPSMB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X030,STAT=IOS)
X00067=7
X01='AUPB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X031,STAT=IOS)
X00067=7
X01='ADRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X032,STAT=IOS)
X00067=7
X01='ADWB'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLCHAB
SUBROUTINE DLCHA1
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTCHA1
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X30,STAT=IOS)
X00067=7
X01='NOR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X067,STAT=IOS)
X00067=7
X01='IRST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X066,STAT=IOS)
X00067=7
X01='ICST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X065,STAT=IOS)
X00067=7
X01='IRPV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X026,STAT=IOS)
X00067=7
X01='ICPV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X027,STAT=IOS)
X00067=7
X01='IRCT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X028,STAT=IOS)
X00067=7
X01='ICCT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X016,STAT=IOS)
X00067=7
X01='NODN'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X017,STAT=IOS)
X00067=7
X01='IAUP'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X018,STAT=IOS)
X00067=7
X01='IADD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0022,STAT=IOS)
X00067=7
X01='IADWP'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X019,STAT=IOS)
X00067=7
X01='IADW'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X020,STAT=IOS)
X00067=7
X01='IEUL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X021,STAT=IOS)
X00067=7
X01='IEDL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X022,STAT=IOS)
X00067=7
X01='DIST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00037,STAT=IOS)
X00067=7
X01='SLPLNK'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00038,STAT=IOS)
X00067=7
X01='SLPSMT'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLCHA1
SUBROUTINE DLSBV1
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSBV1
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X00141,STAT=IOS)
X00067=7
X01='TMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00140,STAT=IOS)
X00067=7
X01='TMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00142,STAT=IOS)
X00067=7
X01='TMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00143,STAT=IOS)
X00067=7
X01='TMSDRO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00144,STAT=IOS)
X00067=7
X01='CMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00145,STAT=IOS)
X00067=7
X01='CMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00146,STAT=IOS)
X00067=7
X01='CMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00147,STAT=IOS)
X00067=7
X01='CSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00148,STAT=IOS)
X00067=7
X01='RMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00149,STAT=IOS)
X00067=7
X01='RMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00151,STAT=IOS)
X00067=7
X01='RMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00150,STAT=IOS)
X00067=7
X01='RSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00152,STAT=IOS)
X00067=7
X01='FMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00153,STAT=IOS)
X00067=7
X01='FMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00154,STAT=IOS)
X00067=7
X01='FMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00155,STAT=IOS)
X00067=7
X01='FSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00156,STAT=IOS)
X00067=7
X01='DMDDSR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00157,STAT=IOS)
X00067=7
X01='DMSBRO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00158,STAT=IOS)
X00067=7
X01='DMDDLS'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00159,STAT=IOS)
X00067=7
X01='DSMSBR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0109,STAT=IOS)
X00067=7
X01='DAREA'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X45,STAT=IOS)
X00067=7
X01='TOT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X112,STAT=IOS)
X00067=7
X01='TCAO'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSBV1
SUBROUTINE DLSBV3
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSBV3
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X00176,STAT=IOS)
X00067=7
X01='DINARB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X114,STAT=IOS)
X00067=7
X01='TOTB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0111,STAT=IOS)
X00067=7
X01='TCAOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00161,STAT=IOS)
X00067=7
X01='TMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00160,STAT=IOS)
X00067=7
X01='TMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00162,STAT=IOS)
X00067=7
X01='TMDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00163,STAT=IOS)
X00067=7
X01='TMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00164,STAT=IOS)
X00067=7
X01='CMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00165,STAT=IOS)
X00067=7
X01='CMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00166,STAT=IOS)
X00067=7
X01='CMDDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00167,STAT=IOS)
X00067=7
X01='CMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00168,STAT=IOS)
X00067=7
X01='RMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00169,STAT=IOS)
X00067=7
X01='RMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00171,STAT=IOS)
X00067=7
X01='RMDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00170,STAT=IOS)
X00067=7
X01='RMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00172,STAT=IOS)
X00067=7
X01='FMDSRB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00173,STAT=IOS)
X00067=7
X01='FMSBOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00174,STAT=IOS)
X00067=7
X01='FMDLSB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00175,STAT=IOS)
X00067=7
X01='FMSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSBV3
SUBROUTINE DLSEQ1
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSEQ1
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X00005,STAT=IOS)
X00067=7
X01='NODCOD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00006,STAT=IOS)
X00067=7
X01='NODROU'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00007,STAT=IOS)
X00067=7
X01='NODORD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00013,STAT=IOS)
X00067=7
X01='NODSEQ'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00014,STAT=IOS)
X00067=7
X01='NODEXE'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00015,STAT=IOS)
X00067=7
X01='NODTMP'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00016,STAT=IOS)
X00067=7
X01='NEXNOD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00009,STAT=IOS)
X00067=7
X01='NID1CT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00011,STAT=IOS)
X00067=7
X01='NID3CT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00012,STAT=IOS)
X00067=7
X01='NBRANC'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00017,STAT=IOS)
X00067=7
X01='INFLOW'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSEQ1
SUBROUTINE DLSTA1
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA1
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(IVAL,STAT=IOS)
X00067=7
X01='IVAL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(IOR,STAT=IOS)
X00067=7
X01='IOR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(VL,STAT=IOS)
X00067=7
X01='VL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X46,STAT=IOS)
X00067=7
X01='VMN'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X47,STAT=IOS)
X00067=7
X01='VMX'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X48,STAT=IOS)
X00067=7
X01='VLM'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X49,STAT=IOS)
X00067=7
X01='VLO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(AR,STAT=IOS)
X00067=7
X01='AR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X50,STAT=IOS)
X00067=7
X01='ARO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X113,STAT=IOS)
X00067=7
X01='AROP'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X51,STAT=IOS)
X00067=7
X01='DDO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00226,STAT=IOS)
X00067=7
X01='VLOSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00227,STAT=IOS)
X00067=7
X01='VLMSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00228,STAT=IOS)
X00067=7
X01='ELDSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00229,STAT=IOS)
X00067=7
X01='ELOUDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00231,STAT=IOS)
X00067=7
X01='ELODDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00230,STAT=IOS)
X00067=7
X01='SLCLDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00232,STAT=IOS)
X00067=7
X01='SLOSDR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00233,STAT=IOS)
X00067=7
X01='ACLSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00234,STAT=IOS)
X00067=7
X01='ARCLPD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00235,STAT=IOS)
X00067=7
X01='ARCLDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00236,STAT=IOS)
X00067=7
X01='WSLOSD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0122,STAT=IOS)
X00067=7
X01='VMDDO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00237,STAT=IOS)
X00067=7
X01='SDMDDO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00238,STAT=IOS)
X00067=7
X01='ELUSDV'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X115,STAT=IOS)
X00067=7
X01='SLOL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X52,STAT=IOS)
X00067=7
X01='SLO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X116,STAT=IOS)
X00067=7
X01='WSLO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0121,STAT=IOS)
X00067=7
X01='WLLSD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00239,STAT=IOS)
X00067=7
X01='WSLLSD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0123,STAT=IOS)
X00067=7
X01='ELORD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0124,STAT=IOS)
X00067=7
X01='ELORU'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0126,STAT=IOS)
X00067=7
X01='ELODL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0125,STAT=IOS)
X00067=7
X01='ELOUL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0127,STAT=IOS)
X00067=7
X01='WSLOL'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSTA1
SUBROUTINE DLSTA3
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA3
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X0160,STAT=IOS)
X00067=7
X01='IVALB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X161,STAT=IOS)
X00067=7
X01='IORB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X153,STAT=IOS)
X00067=7
X01='SLOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00303,STAT=IOS)
X00067=7
X01='ELODLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00304,STAT=IOS)
X00067=7
X01='ELORUB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00305,STAT=IOS)
X00067=7
X01='ELORDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00306,STAT=IOS)
X00067=7
X01='ELOULB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0156,STAT=IOS)
X00067=7
X01='WSLOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00307,STAT=IOS)
X00067=7
X01='WSLOLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0157,STAT=IOS)
X00067=7
X01='SLOLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X179,STAT=IOS)
X00067=7
X01='VLBT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X71,STAT=IOS)
X00067=7
X01='VLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X154,STAT=IOS)
X00067=7
X01='VMNB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X155,STAT=IOS)
X00067=7
X01='VMXB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X156,STAT=IOS)
X00067=7
X01='VLMB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X157,STAT=IOS)
X00067=7
X01='VLOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(ARB,STAT=IOS)
X00067=7
X01='ARB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X158,STAT=IOS)
X00067=7
X01='AROB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0158,STAT=IOS)
X00067=7
X01='AROPB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X159,STAT=IOS)
X00067=7
X01='DDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0159,STAT=IOS)
X00067=7
X01='VLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0161,STAT=IOS)
X00067=7
X01='VOSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00312,STAT=IOS)
X00067=7
X01='EDLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00314,STAT=IOS)
X00067=7
X01='ELOUSD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00315,STAT=IOS)
X00067=7
X01='ELODSD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00316,STAT=IOS)
X00067=7
X01='SLLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00317,STAT=IOS)
X00067=7
X01='SLOSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00318,STAT=IOS)
X00067=7
X01='WSSDLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00319,STAT=IOS)
X00067=7
X01='WSSDOB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X160,STAT=IOS)
X00067=7
X01='DDLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00308,STAT=IOS)
X00067=7
X01='DDLSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00309,STAT=IOS)
X00067=7
X01='DDASDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00313,STAT=IOS)
X00067=7
X01='EULSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00310,STAT=IOS)
X00067=7
X01='VARSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00311,STAT=IOS)
X00067=7
X01='VAPSDB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00321,STAT=IOS)
X00067=7
X01='CSLOPB'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSTA3
SUBROUTINE DLSTA5
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA5
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(IAR,STAT=IOS)
X00067=7
X01='IAR'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X151,STAT=IOS)
X00067=7
X01='IARO'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0147,STAT=IOS)
X00067=7
X01='IAROP'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X70,STAT=IOS)
X00067=7
X01='WLL'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X42,STAT=IOS)
X00067=7
X01='SUM'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X103,STAT=IOS)
X00067=7
X01='SUMP'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00337,STAT=IOS)
X00067=7
X01='VLOC51'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X67,STAT=IOS)
X00067=7
X01='VLX'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X105,STAT=IOS)
X00067=7
X01='SUMU'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X104,STAT=IOS)
X00067=7
X01='SUMD'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0150,STAT=IOS)
X00067=7
X01='VDIST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X147,STAT=IOS)
X00067=7
X01='VLO1'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSTA5
SUBROUTINE DLSTA6
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE GENIO1,ONLY:TESTIO
USE DTSTA6
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
DEALLOCATE(X146,STAT=IOS)
X00067=7
X01='VARB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X145,STAT=IOS)
X00067=7
X01='WLLB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X144,STAT=IOS)
X00067=7
X01='BSUM'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00338,STAT=IOS)
X00067=7
X01='VLOC5B'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X0151,STAT=IOS)
X00067=7
X01='VAROB'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00302,STAT=IOS)
X00067=7
X01='VAROPB'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE DLSTA6
END MODULE ALDAL
MODULE DEDNM3
CONTAINS
SUBROUTINE BOUND
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,IOS,X00077
USE DTCNT1,ONLY:X023,X025,X09,X10,X07,X0023,X00030
USE DTRST1,ONLY:X08,ICA,X0041,X11
IMPLICIT NONE
INTEGER(KIND=X36)::IERR1=X00070,IERR2=X00070,X0060=X00070,X0061=X00070
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070,X0003=X00070
INTEGER(KIND=X35)::X00119=X00071,IC=X00071,IR=X00071
INTEGER(KIND=X35)::X41=X00071,V04=X00071
INTEGER(KIND=X32)::X0281=X00081
CHARACTER(LEN=500)::X02=' ', X053=' ',X051=' '
X053='(/,1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!   ERROR   !!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE BOUND; MODULE DEDNM3 (M_DEDNM3.F90)'')'
X051='(/,1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!  WARNING  !!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/)'
X00119=X023-1
X0060=-1
X0061=0
IR1:DO IC=1,X025
IC1:DO IR=1,X023
IF(X11(IR,IC).EQ.2)THEN
X11(IR,IC)=X0060
V04=IR
X41=IC
IREP1:DO
X00117=X07(X08(V04,X41),1)
X00118=X07(X08(V04,X41),2)
V04=V04+X00117
X41=X41+X00118
IF(X11(V04,X41).EQ.X0060)THEN
CONTINUE
ELSE IF(X11(V04,X41).EQ.X0061)THEN
V04=IR
X41=IC
X11(V04,X41)=X0061
IREP2:DO
X00117=X07(X08(V04,X41),1)
X00118=X07(X08(V04,X41),2)
V04=V04+X00117
X41=X41+X00118
IF(X11(V04,X41).NE.X0061)THEN
X11(V04,X41)=X0061
CYCLE IREP2
END IF
EXIT IREP2
END DO IREP2
ELSE IF(X11(V04,X41).EQ.1)THEN
IF((V04.EQ.X09).AND.(X41.EQ.X10))THEN
X11(V04,X41)=X0060
ELSE
V04=IR
X41=IC
X11(V04,X41)=X0061
IREP3:DO
X00117=X07(X08(V04,X41),1)
X00118=X07(X08(V04,X41),2)
V04=V04+X00117
X41=X41+X00118
IF(X11(V04,X41).NE.1)THEN
X11(V04,X41)=X0061
CYCLE IREP3
END IF
EXIT IREP3
END DO IREP3
X11(V04,X41)=X0061
END IF
ELSE IF((V04.EQ.X09).AND.(X41.EQ.X10))THEN
X11(V04,X41)=X0060
IREP4:DO
X00117=X07(X08(V04,X41),1)
X00118=X07(X08(V04,X41),2)
V04=V04+X00117
X41=X41+X00118
IF(X11(V04,X41).EQ.X0061)THEN
CONTINUE
ELSE IF(X11(V04,X41).NE.1)THEN
X11(V04,X41)=X0061
CYCLE IREP4
END IF
EXIT IREP4
END DO IREP4
X11(V04,X41)=X0061
ELSE
X11(V04,X41)=X0060
CYCLE IREP1
END IF
EXIT IREP1
END DO IREP1
ELSE IF(X11(IR,IC).EQ.3)THEN
X11(IR,IC)=X0061
END IF
END DO IC1
END DO IR1
X0281=0
DO IC=1,X025
DO IR=1,X023
IF(X11(IR,IC).EQ.-1)THEN
X11(IR,IC)=1
X0281=X0281+1
END IF
END DO
END DO
X00030=ICA(X09,X10)
IF(X0281.NE.(X00030+1))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE NUMBER OF CELLS IN THE WATERSHED AREA IS DIFFERENT WHEN COMPUTED'',/,&
&1X,''IN SUBROUTINES BOUND AND UPAREA.'',/,&
&1X,''VALUE IN SUBROUTINE UPAREA: '',1X,I9,/,&
&1X,''VALUE IN SUBROUTINE BOUND:  '',1X,I9)'
WRITE(X00077,X02)X0281,X00030
WRITE(*,X02)X0281,X00030
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IERR1=0
IERR2=0
DO IC=1,X025
IF(X11(1,IC).EQ.1)THEN
IERR1=1
EXIT
END IF
IF(X11(X023,IC).EQ.1)THEN
IERR1=1
EXIT
END IF
END DO
IF(IERR1.EQ.0)THEN
DO IR=2,X00119
IF(X11(IR,1).EQ.1)THEN
IERR1=1
EXIT
END IF
IF(X11(IR,X025).EQ.1)THEN
IERR1=1
EXIT
END IF
END DO
END IF
IF(X0023.EQ.1)THEN
IR2:DO IR=1,X023
IC2:DO IC=1,X025
IF((X0041(IR,IC).EQ.1).AND.(X11(IR,IC).EQ.1))THEN
IERR2=1
EXIT IR2
END IF
END DO IC2
END DO IR2
END IF
IF((IERR1.EQ.0).AND.(IERR2.EQ.0))THEN
CONTINUE
ELSE
WRITE(X00077,X051)
WRITE(*,X051)
IF((IERR1.EQ.1).AND.(IERR2.EQ.1))THEN
X02='(1X,''THE WATERSHED BOUNDARY TOUCHES THE EDGE OF THE DEM AND AN AREA OF'',/,&
&1X,''INDETERMINATE ELEVATIONS.'',/,&
&1X,''IT IS POSSIBLE THAT THE ACTUAL WATERSHED EXTENDS BEYOND THE EDGE OF THE DEM'',/&
&1X,''AND/OR INTO AN AREA OF INDETERMINATE ELEVATIONS.'')'
WRITE(X00077,X02)
WRITE(*,X02)
ELSE IF(IERR1.EQ.1)THEN
X02='(1X,''THE WATERSHED BOUNDARY TOUCHES THE EDGE OF THE DEM.'',/&
&1X,''IT IS POSSIBLE THAT THE ACTUAL WATERSHED EXTENDS BEYOND THE EDGE OF THE DEM.'',/)'
WRITE(X00077,X02)
WRITE(*,X02)
ELSE IF(IERR2.EQ.1)THEN
X02='(1X,''THE WATERSHED BOUNDARY TOUCHES AN AREA OF INDETERMINATE ELEVATIONS.'',/,&
&1X,''IT IS POSSIBLE THAT THE ACTUAL WATERSHED EXTENDS INTO THE AREA OF'',/,&
&1X,''INDETERMINATE ELEVATIONS.'',/)'
WRITE(X00077,X02)
WRITE(*,X02)
END IF
IREP5:DO
X02='(1X,''THE WATERSHED MUST BE FULLY DEFINED WITHIN THE DEM AND SHOULD GENERALLY'',/,&
&1X,''NOT TOUCH THE EDGE OF THE DEM OR AN AREA OF INDETERMINATE ELEVATION.'',/,&
&1X,''ENTER   0   TO TERMINATE PROGRAM EXECUTION;'',/,&
&1X,''ENTER   1   TO PROCEED WITH POTENTIALLY INCOMPLETE WATERSHED.'')'
WRITE(X00077,X02)
WRITE(*,X02)
READ(*,*,IOSTAT=IOS)X0003
IF(IOS.NE.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''READ STATEMENT ERROR;'',/,&
&1X,''USER PROVIDED INPUT DATA COULD NOT BE READ.'')'
WRITE(X00077,X02)
WRITE(*,X02)
END IF
X02='(1X,''THE USER ENTERED VALUE IS: '',1X,I2)'
WRITE(X00077,X02)X0003
IF((X0003.NE.0).AND.(X0003.NE.1))THEN
X02='(1X,''A  0  OR A  1  MUST BE ENTERED TO CONTINUE OR TERMINATE PROGRAM EXECUTION.'')'
WRITE(*,X02)
CYCLE IREP5
END IF
EXIT IREP5
END DO IREP5
IF(X0003.EQ.0)THEN
X02='(1X,''PROGRAM EXECUTION TERMINATED BY USER.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'EXECUTION TERMINATED BY USER.  CHECK PROGRAM REPORT FILE.'
ELSE IF(X0003.EQ.1)THEN
WRITE(X00077,X051)
WRITE(*,X051)
X02='(/,1X,''USER ELECTED TO CONTINUE PROGRAM EXECUTION EVEN THOUGH WATERSHED'',/,&
&1X,''MAY NOT BE FULLY CONTAINED WITHIN THE BOUNDARIES OF THE DEM,'',/,&
&1X,''OR IS ADJACENT TO AN AREA OF INDETERMINATE ELEVATIONS'',/)'
WRITE(X00077,X02)
WRITE(*,X02)
END IF
END IF
END SUBROUTINE BOUND
SUBROUTINE FILDEP
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X34,X33,X00072,&
X00077
USE DTCNT1,ONLY:X023,X025,X0017,X00043,X042
USE DTRST1,ONLY:X03,X045,X068
IMPLICIT NONE
INTEGER(KIND=X36)::MR=X00070,MC=X00070,V15=X00070,V13=X00070,V14=X00070,V12=X00070
INTEGER(KIND=X36)::X224=X00070,X208=X00070,NOUT=X00070
INTEGER(KIND=X36)::X00357=X00070
INTEGER(KIND=X35)::X00119=X00071,X00120=X00071,IR=X00071,IC=X00071
INTEGER(KIND=X35)::X93=X00071,IRE=X00071,X91=X00071,X92=X00071
INTEGER(KIND=X35)::X222=X00071,X223=X00071,X279=X00071,X284=X00071
INTEGER(KIND=X35)::V03=X00071,V02=X00071,X220=X00071,X276=X00071,X219=X00071,X221=X00071
INTEGER(KIND=X35)::X0214=X00071,X0280=X00071
INTEGER(KIND=X35)::X211=X00071,X212=X00071,X0204=X00071,X0205=X00071
INTEGER(KIND=X35)::X0192=X00071,X0193=X00071,X00345=X00071,X00347=X00071
INTEGER(KIND=X35)::X0201=X00071,X00351=X00071,IRMAX=X00071,X00349=X00071
INTEGER(KIND=X35)::X0202=X00071,X00352=X00071,X0203=X00071,X00350=X00071
INTEGER(KIND=X32)::X00123=X00081,X0207=X00081,IX0189=X00081,X218=X00081
INTEGER(KIND=X32)::X00344=X00081,X00343=X00081,IDZ=X00081,X0190=X00081,X277=X00081
INTEGER(KIND=X32)::X00359=X00081
REAL(KIND=X34)::X203=X00072,X204=X00072
REAL(KIND=X34)::X00341=X00072,X00342=X00072,X80=X00072,X0191=X00072
CHARACTER(LEN=500)::X02=' ', X053=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE FILDEP; MODULE DEDNM3 (M_DEDNM3.F90).'')'
X203=1.0E-5
X00119=X023-1
X00120=X025-1
X045=0
X068=0
ROW1:DO X211=2,X00119
COLUMN1:DO X212=2,X00120
X00357=0
IF(X045(X211,X212).GT.0)CYCLE COLUMN1
IF(X03(X211,X212).EQ.X0017)CYCLE COLUMN1
X224=0
DO MR=-1,1
DO MC=-1,1
X0204=X211+MR
X0205=X212+MC
IF((X03(X211,X212)-X03(X0204,X0205)).GT.0)CYCLE COLUMN1
IF((X03(X211,X212)-X03(X0204,X0205)).LT.0)X224=1
END DO
END DO
IF(X224.EQ.0)CYCLE COLUMN1
X045(X211,X212)=X045(X211,X212)+99
X0201=X211-5
IF(X0201.LT.1)X0201=1
X00351=X0201+1
IRMAX=X211+5
IF(IRMAX.GT.X023)IRMAX=X023
X00349=IRMAX-1
X0202=X212-5
IF(X0202.LT.1)X0202=1
X00352=X0202+1
X0203=X212+5
IF(X0203.GT.X025)X0203=X025
X00350=X0203-1
PX26:DO
X0213:DO
X208=0
IR1:DO IR=X00351,X00349
IC1:DO IC=X00352,X00350
IF(X045(IR,IC).LT.99)CYCLE IC1
IF(X068(IR,IC).EQ.1)CYCLE IC1
V15L:DO MR=-1,1
X285:DO MC=-1,1
X0204=IR+MR
X0205=IC+MC
IF(X045(X0204,X0205).GE.99)CYCLE X285
IF(X03(X0204,X0205).GE.X03(IR,IC))THEN
X045(X0204,X0205)=X045(X0204,X0205)+99
X208=1
END IF
END DO X285
END DO V15L
X068(IR,IC)=1
END DO IC1
END DO IR1
IF(X208.EQ.0)THEN
EXIT X0213
ELSE IF(X208.EQ.1)THEN
CONTINUE
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''VARIABLE NCHK HAS AN UNEXPECTED VALUE.  LOGIC ERROR.'',/,&
&1X,''THE VALUE WAS: '',I9)'
WRITE(X00077,X02)X208
WRITE(*,X02)X208
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'
END IF
END DO X0213
X0207=X00043+10
X00123=X00043+10
NOUT=0
IR2:DO IR=X0201,IRMAX
IC2:DO IC=X0202,X0203
IF(X045(IR,IC).LT.99)CYCLE IC2
IF(X03(IR,IC).LT.X0207)X0207=X03(IR,IC)
IF(X03(IR,IC).GE.X00123)CYCLE IC2
IF((IR.EQ.1).OR.(IR.EQ.X023).OR.(IC.EQ.1).OR.(IC.EQ.X025))THEN
X00123=X03(IR,IC)
NOUT=1
CYCLE IC2
END IF
X291:DO MR=-1,1
X290:DO MC=-1,1
X0204=IR+MR
X0205=IC+MC
IF(X045(X0204,X0205).GE.99)CYCLE X290
IX0189=X03(IR,IC)-X03(X0204,X0205)
IF(IX0189.GT.0)THEN
X00123=X03(IR,IC)
NOUT=1
CYCLE IC2
END IF
END DO X290
END DO X291
END DO IC2
END DO IR2
NOUT0:IF(NOUT.EQ.0)THEN
X218=X00043+10
IC=X0202
DO IR=X0201,IRMAX
IF(X03(IR,IC).LT.X218)X218=X03(IR,IC)
END DO
IC=X0203
DO IR=X0201,IRMAX
IF(X03(IR,IC).LT.X218)X218=X03(IR,IC)
END DO
IR=X0201
DO IC=X0202,X0203
IF(X03(IR,IC).LT.X218)X218=X03(IR,IC)
END DO
IR=IRMAX
DO IC=X0202,X0203
IF(X03(IR,IC).LT.X218)X218=X03(IR,IC)
END DO
IC=X0202
X208=0
IF(IC.NE.1)THEN
DO IR=X0201,IRMAX
IF(X03(IR,IC).EQ.X218)THEN
X0202=X0202-5
IF(X0202.LT.1)X0202=1
X00352=X0202+1
X208=1
EXIT
END IF
END DO
END IF
IC=X0203
IF(IC.NE.X025)THEN
DO IR=X0201,IRMAX
IF(X03(IR,IC).EQ.X218)THEN
X0203=X0203+5
IF(X0203.GT.X025)X0203=X025
X00350=X0203-1
X208=1
EXIT
END IF
END DO
END IF
IR=X0201
IF(IR.NE.1)THEN
DO IC=X0202,X0203
IF(X03(IR,IC).EQ.X218)THEN
X0201=X0201-5
IF(X0201.LT.1)X0201=1
X00351=X0201+1
X208=1
EXIT
END IF
END DO
END IF
IR=IRMAX
IF(IR.NE.X023)THEN
DO IC=X0202,X0203
IF(X03(IR,IC).EQ.X218)THEN
IRMAX=IRMAX+5
IF(IRMAX.GT.X023)IRMAX=X023
X00349=IRMAX-1
X208=1
EXIT
END IF
END DO
END IF
IF(X208.EQ.1)THEN
CYCLE PX26
ELSE IF(X208.EQ.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''NO OUTLET OUT OF THE DEPRESSION WAS FOUND AND THE SEARCH WINDOW'',/,&
&1X,''COULD NOT BE ENLARGED. PROGRAM EXECUTION CANNOT PROCEED.'',/,&
&1X,''REVIEW DEM ELEVATION DATA AND PROGRAM LOGIC.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''INCORRECT VALUE FOR VARIABLE NCHK WAS ENCOUNTERED.'',/,&
&1X,''VALUE WAS :'',I9,/,&
&1X,''LOGIC ERROR.  PROGRAM EXECUTION TERMINATED.'')'
WRITE(X00077,X02)X208
WRITE(*,X02)X208
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'
END IF
END IF NOUT0
NOUT1:IF(NOUT.EQ.1)THEN
X208=0
IC=X0202
IF(IC.NE.1)THEN
DO IR=X0201,IRMAX
IF((X045(IR,IC).GE.99).AND.(X03(IR,IC).LT.X00123))THEN
X0202=X0202-5
IF(X0202.LT.1)X0202=1
X00352=X0202+1
X208=1
EXIT
END IF
END DO
END IF
IC=X0203
IF(IC.NE.X025)THEN
DO IR=X0201,IRMAX
IF((X045(IR,IC).GE.99).AND.(X03(IR,IC).LT.X00123))THEN
X0203=X0203+5
IF(X0203.GT.X025)X0203=X025
X00350=X0203-1
X208=1
EXIT
END IF
END DO
END IF
IR=X0201
IF(IR.NE.1)THEN
DO IC=X0202,X0203
IF((X045(IR,IC).GE.99).AND.(X03(IR,IC).LT.X00123))THEN
X0201=X0201-5
IF(X0201.LT.1)X0201=1
X00351=X0201+1
X208=1
EXIT
END IF
END DO
END IF
IR=IRMAX
IF(IR.NE.X023)THEN
DO IC=X0202,X0203
IF((X045(IR,IC).GE.99).AND.(X03(IR,IC).LT.X00123))THEN
IRMAX=IRMAX+5
IF(IRMAX.GT.X023)IRMAX=X023
X00349=IRMAX-1
X208=1
EXIT
END IF
END DO
END IF
IF(X208.EQ.1)CYCLE PX26
END IF NOUT1
IF((NOUT.LT.0).OR.(NOUT.GT.1))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''A NEGATIVE NUMBER OF OUTLETS OUT OF THE DEPRESSION WAS FOUND.'',/,&
&1X,''PROGRAM EXECUTION CANNOT PROCEED.'',/,&
&1X,''REVIEW DEM ELEVATION DATA AND PROGRAM LOGIC.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'
END IF
IF(X042(2).EQ.0)EXIT PX26
IF(X0207.EQ.X00123)EXIT PX26
X00344=0
X00341=1.0E20
IR3:DO IR=X0201,IRMAX
IC3:DO IC=X0202,X0203
IF(X045(IR,IC).LT.99)CYCLE IC3
IF(X03(IR,IC).NE.X00123)CYCLE IC3
X00343=0
X00359=INT(X023,KIND=X32)*INT(X023,KIND=X32)+&
INT(X025,KIND=X32)*INT(X025,KIND=X32)
X00342=REAL(SQRT(REAL(X00359,KIND=X33)),KIND=X34)
X93=-1
IRE=1
X91=-1
X92=1
IF(IR.EQ.1)X93=0
IF(IR.EQ.X023)IRE=0
IF(IC.EQ.1)X91=0
IF(IC.EQ.X025)X92=0
MR3:DO MR=X93,IRE
MC3:DO MC=X91,X92
V03=IR+MR
V02=IC+MC
IF(X03(V03,V02).EQ.X0017)CYCLE MC3
IF(X045(V03,V02).GE.99)CYCLE MC3
IDZ=(X03(IR,IC)-X03(V03,V02))
IF(IDZ.LT.X00343)CYCLE MC3
X80=REAL(SQRT(REAL((MR*MR+MC*MC),KIND=X34)),KIND=X34)
IF(IDZ.GT.X00343)THEN
X00343=IDZ
X00342=X80
CYCLE MC3
END IF
X204=X80-X00342
IF(X204.LT.(-X203))THEN
X00343=IDZ
X00342=X80
END IF
END DO MC3
END DO MR3
IF(X00343.EQ.0)CYCLE IC3
X0190=0
X00359=INT(X023,KIND=X32)*INT(X023,KIND=X32)+&
INT(X025,KIND=X32)*INT(X025,KIND=X32)
X0191=REAL(SQRT(REAL(X00359,KIND=X33)),KIND=X34)
X93=-1
IRE=1
X91=-1
X92=1
IF(IR.EQ.1)X93=0
IF(IR.EQ.X023)IRE=0
IF(IC.EQ.1)X91=0
IF(IC.EQ.X025)X92=0
X288:DO V15=X93,IRE
X287:DO V13=X91,X92
X220=IR+V15
X276=IC+V13
IF(X03(X220,X276).EQ.X0017)CYCLE X287
IF(X045(X220,X276).LT.99)CYCLE X287
IDZ=X03(IR,IC)-X03(X220,X276)
IF(IDZ.GE.X0190)THEN
X80=REAL(SQRT(REAL((V15*V15+V13*V13),KIND=X34)),KIND=X34)
IF(IDZ.GT.X0190)THEN
X0190=IDZ
X0191=X80
X0214=X220
X0280=X276
ELSE
X204=X80-X0191
IF(X204.LT.(-X203))THEN
X0190=IDZ
X0191=X80
X0214=X220
X0280=X276
END IF
END IF
END IF
IF(X042(2).EQ.1)CYCLE X287
IF(IDZ.LT.0)CYCLE X287
X222=-1
X223=1
X279=-1
X284=1
IF(X220.EQ.1)X222=0
IF(X220.EQ.X023)X223=0
IF(X276.EQ.1)X279=0
IF(X276.EQ.X025)X284=0
X289:DO V14=X222,X223
X286:DO V12=X279,X284
X219=X220+V14
X221=X276+V12
IF(X03(X219,X221).EQ.X0017)CYCLE X286
IF(X045(X219,X221).LT.99)CYCLE X286
IDZ=X03(IR,IC)-X03(X219,X221)
IF(IDZ.LT.X0190)CYCLE X286
X80=REAL((SQRT(REAL((V15*V15+V13*V13),KIND=X33))+&
SQRT(REAL((V14*V14+V12*V12),KIND=X33))),KIND=X34)
IF(IDZ.GT.X0190)THEN
X0190=IDZ
X0191=X80
X0214=X220
X0280=X276
ELSE
X204=X80-X0191
IF(X204.LT.(-X203))THEN
X0190=IDZ
X0191=X80
X0214=X220
X0280=X276
END IF
END IF
END DO X286
END DO X289
END DO X287
END DO X288
IF(X00343.LT.X0190)THEN
X277=X00343
ELSE
X277=X0190
END IF
IF(X277.LT.X00344)CYCLE IC3
IF(X277.GT.X00344)THEN
X00344=X277
X00341=X0191+X00342
X0192=IR
X0193=IC
X00345=X0214
X00347=X0280
ELSE
X204=(X0191+X00342)-X00341
IF(X204.LT.(-X203))THEN
X00344=X277
X00341=X0191+X00342
X0192=IR
X0193=IC
X00345=X0214
X00347=X0280
ELSE IF((ABS(X204).LT.X203).AND.(X00343.GT.X00344))THEN
X00344=X277
X00341=X0191+X00342
X0192=IR
X0193=IC
X00345=X0214
X00347=X0280
END IF
END IF
END DO IC3
END DO IR3
IF(X00344.EQ.0)THEN
IF(X042(2).EQ.2)THEN
IF(X00357.EQ.0)THEN
X0201=X0201-1
IF(X0201.LT.1)X0201=1
X00351=X0201+1
IRMAX=IRMAX+1
IF(IRMAX.GT.X023)IRMAX=X023
X00349=IRMAX-1
X0202=X0202-1
IF(X0202.LT.1)X0202=1
X00352=X0202+1
X0203=X0203+1
IF(X0203.GT.X025)X0203=X025
X00350=X0203-1
X00357=1
CYCLE PX26
END IF
END IF
END IF
IF(X00344.EQ.0)EXIT PX26
X00123=X00123-X00344
X03(X0192,X0193)=X00123
IF(X042(2).EQ.2)X03(X00345,X00347)=X00123
EXIT PX26
END DO PX26
IR4:DO IR=X0201,IRMAX
IC4:DO IC=X0202,X0203
IF(X045(IR,IC).LT.99)CYCLE IC4
X068(IR,IC)=0
IF(X03(IR,IC).GT.X00123)THEN
X045(IR,IC)=X045(IR,IC)-99
CYCLE IC4
END IF
X03(IR,IC)=X00123
X045(IR,IC)=1
END DO IC4
END DO IR4
END DO COLUMN1
END DO ROW1
END SUBROUTINE FILDEP
SUBROUTINE FLOPAT
USE STSYS1,ONLY:X36,X35,X00070,X00071
USE DTCNT1,ONLY:X023,X025,X0023,X07
USE DTRST1,ONLY:X08,X271
IMPLICIT NONE
INTEGER(KIND=X36)::K=X00070,L=X00070
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070
INTEGER(KIND=X35)::IR=X00071,IC=X00071
INTEGER(KIND=X35)::X00119=X00071,X00120=X00071,V04=X00071,X41=X00071
X00119=X023-1
X00120=X025-1
X271=2
IF(X0023.EQ.1)THEN
IC=1
K=1
L=1
IR1:DO
DO IR=1,X023
IF(X08(IR,IC).NE.0)THEN
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF((V04.GE.1).AND.(V04.LE.X023).AND.&
(X41.GE.1).AND.(X41.LE.X025))THEN
IF(X08(V04,X41).NE.0)THEN
IF((X271(V04,X41).NE.1).AND.(X271(V04,X41).NE.3))X271(V04,X41)=4
ELSE
CALL FLOPA1(IR,IC,K,L)
END IF
ELSE
CALL FLOPA1(IR,IC,K,L)
END IF
ELSE
X271(IR,IC)=0
END IF
END DO
IF(IC.EQ.1)THEN
IC=X025
K=-1
L=3
CYCLE IR1
END IF
EXIT IR1
END DO IR1
IR=1
K=1
L=0
IC1:DO
DO IC=2,X00120
IF(X08(IR,IC).NE.0)THEN
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF((V04.GE.1).AND.(V04.LE.X023).AND.&
(X41.GE.1).AND.(X41.LE.X025))THEN
IF(X08(V04,X41).NE.0)THEN
IF((X271(V04,X41).NE.1).AND.(X271(V04,X41).NE.3))X271(V04,X41)=4
ELSE
CALL FLOPA2(IR,IC,K,L)
END IF
ELSE
CALL FLOPA2(IR,IC,K,L)
END IF
ELSE
X271(IR,IC)=0
END IF
END DO
IF(IR.EQ.1)THEN
IR=X023
K=-1
L=6
CYCLE IC1
END IF
EXIT IC1
END DO IC1
DO IC=2,X00120
DO IR=2,X00119
IF(X08(IR,IC).NE.0)THEN
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF(X08(V04,X41).NE.0)THEN
IF((X271(V04,X41).NE.1).AND.(X271(V04,X41).NE.3))X271(V04,X41)=4
ELSE
IF((X271(IR,IC).EQ.4).OR.&
(X08(IR-1,IC+1).EQ.7).OR.(X08(IR,IC+1).EQ.4).OR.&
(X08(IR+1,IC+1).EQ.1).OR.(X08(IR+1,IC).EQ.2))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
END IF
ELSE
X271(IR,IC)=0
END IF
END DO
END DO
ELSE
IC=1
K=1
L=1
IR2:DO
DO IR=1,X023
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF((V04.GE.1).AND.(V04.LE.X023).AND.(X41.GE.1).AND.(X41.LE.X025))THEN
IF((X271(V04,X41).NE.1).AND.(X271(V04,X41).NE.3))X271(V04,X41)=4
ELSE
CALL FLOPA1(IR,IC,K,L)
END IF
END DO
IF(IC.EQ.1)THEN
IC=X025
K=-1
L=3
CYCLE IR2
END IF
EXIT IR2
END DO IR2
IR=1
K=1
L=0
IC2:DO
DO IC=2,X00120
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF((V04.GE.1).AND.(V04.LE.X023).AND.(X41.GE.1).AND.(X41.LE.X025))THEN
IF((X271(V04,X41).NE.1).AND.(X271(V04,X41).NE.3))X271(V04,X41)=4
ELSE
CALL FLOPA2(IR,IC,K,L)
END IF
END DO
IF(IR.EQ.1)THEN
IR=X023
K=-1
L=6
CYCLE IC2
END IF
EXIT IC2
END DO IC2
DO IC=2,X00120
DO IR=2,X00119
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF((X271(V04,X41).NE.1).AND.(X271(V04,X41).NE.3))X271(V04,X41)=4
END DO
END DO
END IF
CONTAINS
SUBROUTINE FLOPA1(IR,IC,K,L)
IMPLICIT NONE
INTEGER(KIND=X36)::K,L
INTEGER(KIND=X35)::IR,IC
IF((IR.GT.1).AND.(IR.LT.X023))THEN
IF((X271(IR,IC).EQ.4).OR.&
(X08(IR-1,IC+K).EQ.L+6).OR.(X08(IR,IC+K).EQ.L+3).OR.&
(X08(IR+1,IC+K).EQ.L).OR.(X08(IR+1,IC).EQ.2))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
ELSE IF((IR.EQ.1).AND.(IC.EQ.1))THEN
IF((X271(IR,IC).EQ.4).OR.(X08(IR,IC+1).EQ.4).OR.&
(X08(IR+1,IC).EQ.2).OR.(X08(IR+1,IC+1).EQ.1))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
ELSE IF((IR.EQ.1).AND.(IC.EQ.X025))THEN
IF((X271(IR,IC).EQ.4).OR.(X08(IR,IC-1).EQ.6).OR.&
(X08(IR+1,IC).EQ.2).OR.(X08(IR+1,IC-1).EQ.3))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
ELSE IF((IR.EQ.X023).AND.(IC.EQ.1))THEN
IF((X271(IR,IC).EQ.4).OR.(X08(IR,IC+1).EQ.4).OR.&
(X08(IR-1,IC).EQ.8).OR.(X08(IR-1,IC+1).EQ.7))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
ELSE IF((IR.EQ.X023).AND.(IC.EQ.X025))THEN
IF((X271(IR,IC).EQ.4).OR.(X08(IR,IC-1).EQ.6).OR.&
(X08(IR-1,IC).EQ.8).OR.(X08(IR-1,IC-1).EQ.9))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
END IF
END SUBROUTINE FLOPA1
SUBROUTINE FLOPA2(IR,IC,K,L)
IMPLICIT NONE
INTEGER(KIND=X36)::K,L
INTEGER(KIND=X35)::IR,IC
IF((IC.GT.1).AND.(IC.LT.X025))THEN
IF((X271(IR,IC).EQ.4).OR.&
(X08(IR+K,IC-1).EQ.3+L).OR.(X08(IR+K,IC).EQ.2+L).OR.&
(X08(IR+K,IC+1).EQ.1+L).OR.(X08(IR,IC+1).EQ.4))THEN
X271(IR,IC)=1
ELSE
X271(IR,IC)=3
END IF
END IF
END SUBROUTINE FLOPA2
END SUBROUTINE FLOPAT
SUBROUTINE FLOVEC
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X34,X33,&
X00072,X00082,X00077
USE DTCNT1,ONLY:X0017,X0023,X023,X025,X0014
USE DTRST1,ONLY:X03,X08,X0041
IMPLICIT NONE
INTEGER(KIND=X36)::I=X00070,X0001=X00070,X00127=X00070
INTEGER(KIND=X36)::K=X00070,L=X00070,M=X00070
INTEGER(KIND=X36),DIMENSION(1:4),PARAMETER::X092=(/1,3,7,9/),X091=(/2,4,6,8/)
INTEGER(KIND=X35)::IR=X00071,IC=X00071,X00119=X00071,X00120=X00071
INTEGER(KIND=X35)::X188=X00071,X191=X00071,X190=X00071,X192=X00071
INTEGER(KIND=X32),DIMENSION(1:4)::X193=(/(X00081,I=1,4)/),X194=(/(X00081,I=1,4)/)
REAL(KIND=X34),PARAMETER::SQX27=1.41421356
REAL(KIND=X33)::DX0014=X00082
X08=0
X00119=X023-1
X00120=X025-1
DX0014=REAL(X0014,KIND=X33)
IF(X0023.EQ.1)THEN
IF(X03(1,1).EQ.X0017)THEN
X08(1,1)=0
ELSE
X194(1)=X00081
X194(2)=X00081
X193(1)=X00081
X193(2)=X00081
X193(3)=X00081
IF(X03(1,2).EQ.X0017)THEN
X194(3)=X00081
ELSE
X194(3)=X03(1,1)-X03(1,2)
END IF
IF(X03(2,1).EQ.X0017)THEN
X194(4)=X00081
ELSE
X194(4)=X03(1,1)-X03(2,1)
END IF
IF(X03(2,2).EQ.X0017)THEN
X193(4)=X00081
ELSE
X193(4)=X03(1,1)-X03(2,2)
END IF
IR=1
IC=1
X0001=1
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
ELSE IF(X0023.EQ.0)THEN
X194(1)=X00081
X194(2)=X00081
X193(1)=X00081
X193(2)=X00081
X193(3)=X00081
X194(3)=X03(1,1)-X03(1,2)
X194(4)=X03(1,1)-X03(2,1)
X193(4)=X03(1,1)-X03(2,2)
IR=1
IC=1
X0001=1
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
IF(X0023.EQ.1)THEN
X194(1)=X00081
X194(3)=X00081
X193(1)=X00081
X193(2)=X00081
X193(4)=X00081
IF(X03(1,X025).EQ.X0017)THEN
X08(1,X025)=0
ELSE
IF(X03(1,X00120).EQ.X0017)THEN
X194(2)=X00081
ELSE
X194(2)=X03(1,X025)-X03(1,X00120)
END IF
IF(X03(2,X025).EQ.X0017)THEN
X194(4)=X00081
ELSE
X194(4)=X03(1,X025)-X03(2,X025)
END IF
IF(X03(2,X00120).EQ.X0017)THEN
X193(3)=X00081
ELSE
X193(3)=X03(1,X025)-X03(2,X00120)
END IF
IR=1
IC=X025
X0001=3
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
ELSE IF(X0023.EQ.0)THEN
X194(1)=X00081
X194(3)=X00081
X193(1)=X00081
X193(2)=X00081
X193(4)=X00081
X194(2)=X03(1,X025)-X03(1,X00120)
X194(4)=X03(1,X025)-X03(2,X025)
X193(3)=X03(1,X025)-X03(2,X00120)
IR=1
IC=X025
X0001=3
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
IF(X0023.EQ.1)THEN
IF(X03(X023,1).EQ.X0017)THEN
X08(X023,1)=0
ELSE
X194(2)=X00081
X194(4)=X00081
X193(1)=X00081
X193(3)=X00081
X193(4)=X00081
IF(X03(X023,2).EQ.X0017)THEN
X194(3)=X00081
ELSE
X194(3)=X03(X023,1)-X03(X023,2)
END IF
IF(X03(X00119,1).EQ.X0017)THEN
X194(1)=X00081
ELSE
X194(1)=X03(X023,1)-X03(X00119,1)
END IF
IF(X03(X00119,2).EQ.X0017)THEN
X193(2)=X00081
ELSE
X193(2)=X03(X023,1)-X03(X00119,2)
END IF
IR=X023
IC=1
X0001=7
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
ELSE IF(X0023.EQ.0)THEN
X194(2)=X00081
X194(4)=X00081
X193(1)=X00081
X193(3)=X00081
X193(4)=X00081
X194(3)=X03(X023,1)-X03(X023,2)
X194(1)=X03(X023,1)-X03(X00119,1)
X193(2)=X03(X023,1)-X03(X00119,2)
IR=X023
IC=1
X0001=7
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
IF(X0023.EQ.1)THEN
IF(X03(X023,X025).EQ.X0017)THEN
X08(X023,X025)=0
ELSE
X194(3)=X00081
X194(4)=X00081
X193(2)=X00081
X193(3)=X00081
X193(4)=X00081
IF(X03(X00119,X025).EQ.X0017)THEN
X194(1)=X00081
ELSE
X194(1)=X03(X023,X025)-X03(X00119,X025)
END IF
IF(X03(X023,X00120).EQ.X0017)THEN
X194(2)=X00081
ELSE
X194(2)=X03(X023,X025)-X03(X023,X00120)
END IF
IF(X03(X00119,X00120).EQ.X0017)THEN
X193(1)=X00081
ELSE
X193(1)=X03(X023,X025)-X03(X00119,X00120)
END IF
IR=X023
IC=X025
X0001=9
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
ELSE IF(X0023.EQ.0)THEN
X194(3)=X00081
X194(4)=X00081
X193(2)=X00081
X193(3)=X00081
X193(4)=X00081
X194(1)=X03(X023,X025)-X03(X00119,X025)
X194(2)=X03(X023,X025)-X03(X023,X00120)
X193(1)=X03(X023,X025)-X03(X00119,X00120)
IR=X023
IC=X025
X0001=9
X00127=0
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
IF(X0023.EQ.1)THEN
IR=1
K=1
L=2
M=2
X0001=2
X194(1)=X00081
X193(1)=X00081
X193(2)=X00081
IR1:DO
DO IC=2,X00120
IF(X03(IR,IC).EQ.X0017)THEN
X08(IR,IC)=0
ELSE
IF(X03(IR,IC-1).EQ.X0017)THEN
X194(2)=X00081
ELSE
X194(2)=X03(IR,IC)-X03(IR,IC-1)
END IF
IF(X03(IR,IC+1).EQ.X0017)THEN
X194(3)=X00081
ELSE
X194(3)=X03(IR,IC)-X03(IR,IC+1)
END IF
IF(X03(IR+K,IC).EQ.X0017)THEN
X194(L+2)=X00081
ELSE
X194(L+2)=X03(IR,IC)-X03(IR+K,IC)
END IF
IF(X03(IR+K,IC-1).EQ.X0017)THEN
X193(M+1)=X00081
ELSE
X193(M+1)=X03(IR,IC)-X03(IR+K,IC-1)
END IF
IF(X03(IR+K,IC+1).EQ.X0017)THEN
X193(M+2)=X00081
ELSE
X193(M+2)=X03(IR,IC)-X03(IR+K,IC+1)
END IF
X00127=1
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
END DO
IF(IR.EQ.1)THEN
IR=X023
K=-1
L=-1
M=0
X0001=8
X194(4)=X00081
X193(3)=X00081
X193(4)=X00081
CYCLE IR1
END IF
EXIT IR1
END DO IR1
IC=1
K=1
L=1
X0001=4
X194(2)=X00081
X193(1)=X00081
X193(3)=X00081
IC1:DO
DO IR=2,X00119
IF(X03(IR,IC).EQ.X0017)THEN
X08(IR,IC)=0
ELSE
IF(X03(IR-1,IC).EQ.X0017)THEN
X194(1)=X00081
ELSE
X194(1)=X03(IR,IC)-X03(IR-1,IC)
END IF
IF(X03(IR+1,IC).EQ.X0017)THEN
X194(4)=X00081
ELSE
X194(4)=X03(IR,IC)-X03(IR+1,IC)
END IF
IF(X03(IR,IC+K).EQ.X0017)THEN
X194(L+2)=X00081
ELSE
X194(L+2)=X03(IR,IC)-X03(IR,IC+K)
END IF
IF(X03(IR-1,IC+K).EQ.X0017)THEN
X193(L+1)=X00081
ELSE
X193(L+1)=X03(IR,IC)-X03(IR-1,IC+K)
END IF
IF(X03(IR+1,IC+K).EQ.X0017)THEN
X193(L+3)=X00081
ELSE
X193(L+3)=X03(IR,IC)-X03(IR+1,IC+K)
END IF
X00127=1
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
END DO
IF(IC.EQ.1)THEN
IC=X025
K=-1
L=0
X0001=6
X194(3)=X00081
X193(2)=X00081
X193(4)=X00081
CYCLE IC1
END IF
EXIT IC1
END DO IC1
ELSE IF(X0023.EQ.0)THEN
IR=1
K=1
L=2
M=2
X0001=2
X194(1)=X00081
X193(1)=X00081
X193(2)=X00081
IR2:DO
DO IC=2,X00120
X194(2)=X03(IR,IC)-X03(IR,IC-1)
X194(3)=X03(IR,IC)-X03(IR,IC+1)
X194(L+2)=X03(IR,IC)-X03(IR+K,IC)
X193(M+1)=X03(IR,IC)-X03(IR+K,IC-1)
X193(M+2)=X03(IR,IC)-X03(IR+K,IC+1)
X00127=1
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END DO
IF(IR.EQ.1)THEN
IR=X023
K=-1
L=-1
M=0
X0001=8
X194(4)=X00081
X193(3)=X00081
X193(4)=X00081
CYCLE IR2
END IF
EXIT IR2
END DO IR2
IC=1
K=1
L=1
X0001=4
X194(2)=X00081
X193(1)=X00081
X193(3)=X00081
IC2:DO
DO IR=2,X00119
X194(1)=X03(IR,IC)-X03(IR-1,IC)
X194(4)=X03(IR,IC)-X03(IR+1,IC)
X194(L+2)=X03(IR,IC)-X03(IR,IC+K)
X193(L+1)=X03(IR,IC)-X03(IR-1,IC+K)
X193(L+3)=X03(IR,IC)-X03(IR+1,IC+K)
X00127=1
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END DO
IF(IC.EQ.1)THEN
IC=X025
K=-1
L=0
X0001=6
X194(3)=X00081
X193(2)=X00081
X193(4)=X00081
CYCLE IC2
END IF
EXIT IC2
END DO IC2
END IF
IF(X0023.EQ.1)THEN
IR3:DO IR=2,X023-1
IC3:DO IC=2,X025-1
IF(X03(IR,IC).EQ.X0017)THEN
X08(IR,IC)=0
CYCLE IC3
END IF
X0001=0
X188=IR-1
X191=IR+1
X190=IC-1
X192=IC+1
IF(X0041(IR,IC).EQ.1)THEN
IF(X03(X188,X190).EQ.X0017)THEN
X193(1)=X00081
X0001=1
ELSE
X193(1)=X03(IR,IC)-X03(X188,X190)
END IF
IF(X03(X188,X192).EQ.X0017)THEN
X193(2)=X00081
X0001=3
ELSE
X193(2)=X03(IR,IC)-X03(X188,X192)
END IF
IF(X03(X191,X190).EQ.X0017)THEN
X193(3)=X00081
X0001=7
ELSE
X193(3)=X03(IR,IC)-X03(X191,X190)
END IF
IF(X03(X191,X192).EQ.X0017)THEN
X193(4)=X00081
X0001=9
ELSE
X193(4)=X03(IR,IC)-X03(X191,X192)
END IF
IF(X03(X188,IC).EQ.X0017)THEN
X194(1)=X00081
X0001=2
ELSE
X194(1)=X03(IR,IC)-X03(X188,IC)
END IF
IF(X03(IR,X190).EQ.X0017)THEN
X194(2)=X00081
X0001=4
ELSE
X194(2)=X03(IR,IC)-X03(IR,X190)
END IF
IF(X03(IR,X192).EQ.X0017)THEN
X194(3)=X00081
X0001=6
ELSE
X194(3)=X03(IR,IC)-X03(IR,X192)
END IF
IF(X03(X191,IC).EQ.X0017)THEN
X194(4)=X00081
X0001=8
ELSE
X194(4)=X03(IR,IC)-X03(X191,IC)
END IF
X00127=2
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
ELSE
X193(1)=X03(IR,IC)-X03(X188,X190)
X193(2)=X03(IR,IC)-X03(X188,X192)
X193(3)=X03(IR,IC)-X03(X191,X190)
X193(4)=X03(IR,IC)-X03(X191,X192)
X194(1)=X03(IR,IC)-X03(X188,IC)
X194(2)=X03(IR,IC)-X03(IR,X190)
X194(3)=X03(IR,IC)-X03(IR,X192)
X194(4)=X03(IR,IC)-X03(X191,IC)
X00127=2
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END IF
END DO IC3
END DO IR3
ELSE IF(X0023.EQ.0)THEN
X0001=0
DO IR=2,X023-1
DO IC=2,X025-1
X188=IR-1
X191=IR+1
X190=IC-1
X192=IC+1
X193(1)=X03(IR,IC)-X03(X188,X190)
X193(2)=X03(IR,IC)-X03(X188,X192)
X193(3)=X03(IR,IC)-X03(X191,X190)
X193(4)=X03(IR,IC)-X03(X191,X192)
X194(1)=X03(IR,IC)-X03(X188,IC)
X194(2)=X03(IR,IC)-X03(IR,X190)
X194(3)=X03(IR,IC)-X03(IR,X192)
X194(4)=X03(IR,IC)-X03(X191,IC)
X00127=2
CALL FLOVE1(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
END DO
END DO
END IF
CONTAINS
SUBROUTINE FLOVE1 &
(X193,X194,X092,X091,IR,IC,X0001,X00127,SQX27,DX0014)
IMPLICIT NONE
INTEGER(KIND=X36)::X0001,X00127
INTEGER(KIND=X36),DIMENSION(:)::X092,X091
INTEGER(KIND=X35)::IR,IC
INTEGER(KIND=X32),DIMENSION(:)::X193,X194
REAL(KIND=X34)::SQX27
REAL(KIND=X33)::DX0014
CHARACTER(LEN=500)::X02=' '
INTEGER(KIND=X36)::I=X00070,X0128=X00070
INTEGER(KIND=X36),DIMENSION(1:4)::X0209=(/(X00070,I=1,4)/),X0208=(/(X00070,I=1,4)/)
INTEGER(KIND=X35)::X06=X00071,V11=X00071
INTEGER(KIND=X32)::X215=X00081,X214=X00081
X215=X00081
X214=X00081
X06=0
V11=0
DO I=1,4
IF(X193(I).GT.X214)THEN
V11=1
X214=X193(I)
X0209(V11)=X092(I)
ELSE IF(X193(I).EQ.X214)THEN
V11=V11+1
X0209(V11)=X092(I)
END IF
IF(X194(I).GT.X215)THEN
X06=1
X215=X194(I)
X0208(X06)=X091(I)
ELSE IF(X194(I).EQ.X215)THEN
X06=X06+1
X0208(X06)=X091(I)
END IF
END DO
IF((X215.GT.0).OR.(X214.GT.0))THEN
IF(X215.GE.X214)THEN
IF(X06.EQ.1)THEN
X08(IR,IC)=X0208(1)
ELSE
X0128=1
CALL FLOVE2(X0208,X0209,X00127,&
IR,IC,X0128,X06,V11,X215,&
X193,X194,X091,X092,&
DX0014)
END IF
ELSE
IF(REAL(X214,KIND=X33).LT.REAL(X215,KIND=X33)*SQX27)THEN
IF(X06.EQ.1)THEN
X08(IR,IC)=X0208(1)
ELSE
X0128=1
CALL FLOVE2(X0208,X0209,X00127,&
IR,IC,X0128,X06,V11,X215,&
X193,X194,X091,X092,&
DX0014)
END IF
ELSE
IF(V11.EQ.1)THEN
X08(IR,IC)=X0209(1)
ELSE
X0128=0
CALL FLOVE2(X0208,X0209,X00127,&
IR,IC,X0128,X06,V11,X215,&
X193,X194,X091,X092,&
DX0014)
END IF
END IF
END IF
ELSE IF(((X215.LE.0).AND.(X214.LE.0)).AND.(X0001.NE.0))THEN
X08(IR,IC)=X0001
ELSE
X02='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE FLOVE1; MODULE DEDNM3 (M_DEDNM3.F90).'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''A CELL WITHOUT POSSIBLE FLOW VECTOR WAS DETECTED AT ROW AND COLUMN: '',/,&
&1X,I4,3X,I4,/,&
&1X,''THIS IS NOT POSSIBLE.'',/,&
&1X,''SUBROUTINE FILDEP AND/OR RELIEF DID NOT PERFORM AS EXPECTED.'')'
WRITE(X00077,X02)IR,IC
WRITE(*,X02)IR,IC
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
END SUBROUTINE FLOVE1
SUBROUTINE FLOVE2 &
(X0208,X0209,X00127,IR,IC,X0128,X06,V11,X215,X193,X194,&
X091,X092,DX0014)
IMPLICIT NONE
INTEGER(KIND=X36),INTENT(IN)::X00127,X0128
INTEGER(KIND=X36),DIMENSION(:),INTENT(IN)::X092,X091
INTEGER(KIND=X36),DIMENSION(:),INTENT(IN)::X0209,X0208
INTEGER(KIND=X35),INTENT(IN)::IR,IC,X06,V11
INTEGER(KIND=X32),INTENT(IN)::X215
INTEGER(KIND=X32),DIMENSION(:),INTENT(IN)::X193,X194
REAL(KIND=X33),INTENT(IN)::DX0014
INTEGER(KIND=X36)::X41=X00070,I=X00070,L=X00070
INTEGER(KIND=X35)::X196=X00071,X099=X00071,X0211=X00071
INTEGER(KIND=X35),DIMENSION(1:2)::X028=(/(X00071,I=1,2)/),X281=(/(X00071,I=1,2)/)
INTEGER(KIND=X35),DIMENSION(1:9),PARAMETER::X00355=(/335,0,45,270,-1,90,225,180,135/)
INTEGER(KIND=X35),PARAMETER::X02832=2
REAL(KIND=X33)::ASP=X00072
REAL(KIND=X33)::Z1=X00082,Z2=X00082,Z3=X00082,Z4=X00082,&
Z6=X00082,Z7=X00082,Z8=X00082,Z9=X00082
REAL(KIND=X33)::T4=X00082,D=X00082,E=X00082
REAL(KIND=X33),PARAMETER::RD=57.29577951
IF(X00127.EQ.0)THEN
X08(IR,IC)=X0208(MOD(IR+IC,X02832)+1)
END IF
IF((X00127.EQ.1).AND.((IR.EQ.1).OR.(IR.EQ.X023)))THEN
IF(IR.EQ.1)THEN
L=2
ELSE IF(IR.EQ.X023)THEN
L=0
END IF
IF(X0041(IR,IC).EQ.1)THEN
IF(X0128.EQ.1)THEN
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
ELSE
X08(IR,IC)=X0209(MOD(IR+IC,V11)+1)
END IF
ELSE IF(X0041(IR,IC).EQ.2)THEN
IF(X0128.EQ.0)THEN
IF(X194(3).LT.X194(2))THEN
X08(IR,IC)=X092(L+1)
ELSE IF(X194(2).LT.X194(3))THEN
X08(IR,IC)=X092(L+2)
ELSE
X08(IR,IC)=X0209(MOD(IR+IC,V11)+1)
END IF
ELSE IF(X0128.EQ.1)THEN
IF(X06.EQ.3)THEN
IF(X193(L+2).LT.X193(L+1))THEN
X08(IR,IC)=X091(2)
ELSE IF(X193(L+1).LT.X193(L+2))THEN
X08(IR,IC)=X091(3)
ELSE
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
END IF
ELSE IF(X06.EQ.2)THEN
IF((X194(2).EQ.X215).AND.(X193(L+2).LT.X193(L+1)))THEN
X08(IR,IC)=X091(2)
ELSE IF((X194(3).EQ.X215).AND.(X193(L+1).LT.X193(L+2)))THEN
X08(IR,IC)=X091(3)
ELSE IF((X194(2).EQ.X215).AND.(L.EQ.2).AND.&
(X194(4).EQ.X215).AND.(X193(L+1).LT.X193(L+2)))THEN
X08(IR,IC)=X091(L+2)
ELSE IF((X194(2).EQ.X215).AND.(L.EQ.0).AND.&
(X194(1).EQ.X215).AND.(X193(L+1).LT.X193(L+2)))THEN
X08(IR,IC)=X091(L+1)
ELSE IF((X194(3).EQ.X215).AND.(L.EQ.2).AND.&
(X194(4).EQ.X215).AND.(X193(L+2).LT.X193(L+1)))THEN
X08(IR,IC)=X091(L+2)
ELSE IF((X194(3).EQ.X215).AND.(L.EQ.0).AND.&
(X194(1).EQ.X215).AND.(X193(L+2).LT.X193(L+1)))THEN
X08(IR,IC)=X091(L+1)
ELSE
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
END IF
END IF
END IF
END IF
ELSE IF((X00127.EQ.1).AND.((IC.EQ.1).OR.(IC.EQ.X025)))THEN
IF(IC.EQ.1)THEN
L=1
ELSE IF(IC.EQ.X025)THEN
L=0
END IF
IF(X0041(IR,IC).EQ.1)THEN
IF(X0128.EQ.1)THEN
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
ELSE
X08(IR,IC)=X0209(MOD(IR+IC,V11)+1)
END IF
ELSE IF(X0041(IR,IC).EQ.2)THEN
IF(X0128.EQ.0)THEN
IF(X194(1).LT.X194(4))THEN
X08(IR,IC)=X092(L+3)
ELSE IF(X194(4).LT.X194(1))THEN
X08(IR,IC)=X092(L+1)
ELSE
X08(IR,IC)=X0209(MOD(IR+IC,V11)+1)
END IF
ELSE IF(X0128.EQ.1)THEN
IF(X06.EQ.3)THEN
IF(X193(L+3).LT.X193(L+1))THEN
X08(IR,IC)=X091(1)
ELSE IF(X193(L+1).LT.X193(L+3))THEN
X08(IR,IC)=X091(4)
ELSE
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
END IF
ELSE IF(X06.EQ.2)THEN
IF((X194(1).EQ.X215).AND.(X193(L+3).LT.X193(L+1)))THEN
X08(IR,IC)=X091(1)
ELSE IF((X194(4).EQ.X215).AND.(X193(L+1).LT.X193(L+3)))THEN
X08(IR,IC)=X091(4)
ELSE IF((X194(1).EQ.X215).AND.&
(X194(L+2).EQ.X215).AND.(X193(L+1).LT.X193(L+3)))THEN
X08(IR,IC)=X091(L+2)
ELSE IF((X194(L+2).EQ.X215).AND.&
(X194(4).EQ.X215).AND.(X193(L+3).LT.X193(L+1)))THEN
X08(IR,IC)=X091(L+2)
ELSE
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
END IF
END IF
END IF
END IF
ELSE IF(X00127.EQ.2)THEN
ASP=0.0
IF(X0041(IR,IC).EQ.1)THEN
IF(X0128.EQ.1)THEN
X08(IR,IC)=X0208(MOD(IR+IC,X06)+1)
ELSE
X08(IR,IC)=X0209(MOD(IR+IC,V11)+1)
END IF
ELSE IF(X0041(IR,IC).EQ.2)THEN
T4=6.0*DX0014
Z1=REAL(X03(IR-1,IC-1),KIND=X33)/100000.
Z2=REAL(X03(IR-1,IC),KIND=X33)/100000.
Z3=REAL(X03(IR-1,IC+1),KIND=X33)/100000.
Z4=REAL(X03(IR,IC-1),KIND=X33)/100000.
Z6=REAL(X03(IR,IC+1),KIND=X33)/100000.
Z7=REAL(X03(IR+1,IC-1),KIND=X33)/100000.
Z8=REAL(X03(IR+1,IC),KIND=X33)/100000.
Z9=REAL(X03(IR+1,IC+1),KIND=X33)/100000.
D=((Z3+Z6+Z9)-(Z1+Z4+Z7))/T4
E=((Z1+Z2+Z3)-(Z7+Z8+Z9))/T4
IF((D.GT.-1.0E-10).AND.(D.LT.1.0E-10))THEN
IF((E.GT.-1.0E-10).AND.(E.LT.1.0E-10))THEN
ASP=0.0
ELSE IF(E.GT.0.0)THEN
ASP=180.0
ELSE
ASP=0.0
END IF
ELSE
ASP=SNGL(DATAN(E/D)*RD)
IF(D.LT.0.0)THEN
ASP=90.0-ASP
ELSE
ASP=270.0-ASP
END IF
END IF
X196=NINT(ASP,KIND=X35)
IF(X196.LT.0)THEN
X196=0
END IF
IF(X196.GE.360)THEN
X196=0
END IF
X099=400
IF(X0128.EQ.1)THEN
DO I=1,X06
X0211=ABS(X00355(X0208(I))-X196)
IF(X0211.GT.180)X0211=ABS(X0211-360)
IF(X0211.LT.X099)THEN
X099=X0211
X41=1
X028(1)=I
ELSE IF(X0211.EQ.X099)THEN
X41=X41+1
X028(2)=I
END IF
END DO
IF(X41.EQ.1)THEN
X08(IR,IC)=X0208(X028(1))
ELSE
X08(IR,IC)=X0208(X028(MOD(IR+IC,X02832)+1))
END IF
ELSE IF(X0128.EQ.0)THEN
DO I=1,V11
X0211=ABS(X00355(X0209(I))-X196)
IF(X0211.GT.180)X0211=ABS(X0211-360)
IF(X0211.LT.X099)THEN
X099=X0211
X41=1
X281(1)=I
ELSE IF(X0211.EQ.X099)THEN
X41=X41+1
X281(2)=I
END IF
END DO
IF(X41.EQ.1)THEN
X08(IR,IC)=X0209(X281(1))
ELSE
X08(IR,IC)=X0209(X281(MOD(IR+IC,X02832)+1))
END IF
END IF
END IF
END IF
END SUBROUTINE FLOVE2
END SUBROUTINE FLOVEC
SUBROUTINE INDTAR
USE STSYS1,ONLY:X36,X35,X00070,X00071
USE DTCNT1,ONLY:X0017,X023,X025,X0023
USE DTRST1,ONLY:X03,X0041
IMPLICIT NONE
INTEGER(KIND=X36)::MC=X00070,MR=X00070
INTEGER(KIND=X35)::X41=X00071,V04=X00071,IR=X00071,IC=X00071
INTEGER(KIND=X35)::X00119=X00071,X00120=X00071,K=X00071
X0041=2
IF(X0023.EQ.1)THEN
X00119=X023-1
X00120=X025-1
IF(X03(1,1).EQ.X0017)THEN
X0041(1,1)=0
IF(X03(1,2).NE.X0017)X0041(1,2)=1
IF(X03(2,1).NE.X0017)X0041(2,1)=1
IF(X03(2,2).NE.X0017)X0041(2,2)=1
END IF
IF(X03(1,X025).EQ.X0017)THEN
X0041(1,X025)=0
IF(X03(1,X00120).NE.X0017)X0041(1,X00120)=1
IF(X03(2,X00120).NE.X0017)X0041(2,X00120)=1
IF(X03(2,X025).NE.X0017)X0041(2,X025)=1
END IF
IF(X03(X023,1).EQ.X0017)THEN
X0041(X023,1)=0
IF(X03(X023,2).NE.X0017)X0041(X023,2)=1
IF(X03(X00119,1).NE.X0017)X0041(X00119,1)=1
IF(X03(X00119,2).NE.X0017)X0041(X00119,2)=1
END IF
IF(X03(X023,X025).EQ.X0017)THEN
X0041(X023,X025)=0
IF(X03(X023,X00120).NE.X0017)X0041(X023,X00120)=1
IF(X03(X00119,X00120).NE.X0017)X0041(X00119,X00120)=1
IF(X03(X00119,X025).NE.X0017)X0041(X00119,X025)=1
END IF
IR=1
K=1
K1:DO
DO IC=2,X00120
IF(X03(IR,IC).EQ.X0017)THEN
X0041(IR,IC)=0
IF(X03(IR+K,IC).NE.X0017)X0041(IR+K,IC)=1
IF(X03(IR+K,IC+1).NE.X0017)X0041(IR+K,IC+1)=1
IF(X03(IR+K,IC-1).NE.X0017)X0041(IR+K,IC-1)=1
IF(X03(IR,IC+1).NE.X0017)X0041(IR,IC+1)=1
IF(X03(IR,IC-1).NE.X0017)X0041(IR,IC-1)=1
END IF
END DO
IF(IR.EQ.1)THEN
IR=X023
K=-1
CYCLE K1
END IF
EXIT K1
END DO K1
IC=1
K=1
K2:DO
DO IR=2,X00119
IF(X03(IR,IC).EQ.X0017)THEN
X0041(IR,IC)=0
IF(X03(IR,IC+K).NE.X0017)X0041(IR,IC+K)=1
IF(X03(IR+1,IC+K).NE.X0017)X0041(IR+1,IC+K)=1
IF(X03(IR-1,IC+K).NE.X0017)X0041(IR-1,IC+K)=1
IF(X03(IR+1,IC).NE.X0017)X0041(IR+1,IC)=1
IF(X03(IR-1,IC).NE.X0017)X0041(IR-1,IC)=1
END IF
END DO
IF(IC.EQ.1)THEN
IC=X025
K=-1
CYCLE K2
END IF
EXIT K2
END DO K2
DO IC=2,X00120
DO IR=2,X00119
IF(X03(IR,IC).EQ.X0017)THEN
X0041(IR,IC)=0
DO MR=-1,1
V04=IR+MR
DO MC=-1,1
X41=IC+MC
IF(X03(V04,X41).NE.X0017)THEN
X0041(V04,X41)=1
END IF
END DO
END DO
END IF
END DO
END DO
END IF
END SUBROUTINE INDTAR
SUBROUTINE MAPBOD
USE STSYS1,ONLY:X35,X00071
USE DTCNT1,ONLY:X023,X025
USE DTRST1,ONLY:X08,X11,X40
IMPLICIT NONE
INTEGER(KIND=X35)::IR=X00071,IC=X00071
DO IC=1,X025
DO IR=1,X023
IF(X11(IR,IC).EQ.0)THEN
X08(IR,IC)=0
X40(IR,IC)=0
END IF
END DO
END DO
END SUBROUTINE MAPBOD
SUBROUTINE NETAN
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X34,X00072,X00077
USE DTCNT1,ONLY:X023,X025,X09,X10,X07,X0019,X0018,X011
USE DTRST1,ONLY:X08,ICA,X03,X40
USE DTCHA1
IMPLICIT NONE
INTEGER(KIND=X36)::X0279=X00070,N=X00070,X29=X00070,MR=X00070,MC=X00070
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070
INTEGER(KIND=X35)::J=X00071,I=X00071,X00392=X00071,X00074=X00071
INTEGER(KIND=X35)::X211=X00071,X212=X00071,IR=X00071,IC=X00071
INTEGER(KIND=X35)::X0204=X00071,X0205=X00071,X098=X00071,X101=X00071
INTEGER(KIND=X35)::V10=X00071,V09=X00071,K=X00071
INTEGER(KIND=X32)::X0106=X00081,X0102=X00081,X00130=X00081
REAL(KIND=X34)::X206=X00072,DIS=X00072,X43=X00072
CHARACTER(LEN=500)::X02=' ', X053=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE NETAN; MODULE DEDNM3 (M_DEDNM3.F90).'')'
X0279=0
X0019=0
N=0
STPLOP:DO
NLOOP:DO
N=N+1
X0212:DO X211=1,X023
X0210:DO X212=1,X025
IF(X40(X211,X212).NE.N)CYCLE X0210
IR=X211
IC=X212
IF(N.NE.1)THEN
X29=10
DO MR=-1,1
DO MC=-1,1
X29=X29-1
X0204=IR+MR
X0205=IC+MC
IF((X0204.LT.1).OR.(X0204.GT.X023))CYCLE
IF((X0205.LT.1).OR.(X0205.GT.X025))CYCLE
IF((X08(X0204,X0205).EQ.X29).AND.(X40(X0204,X0205).GT.0))CYCLE X0210
END DO
END DO
END IF
DIX178:DO
DIS=0.0
X098=IR
X101=IC
IF(IR.EQ.X09)THEN
IF(IC.EQ.X10)THEN
X40(IR,IC)=(-1*N)
EXIT STPLOP
END IF
END IF
ST1LOP:DO
X044:DO
NODLOP:DO
OUTLOP:DO
IF(IR.EQ.X09)THEN
IF(IC.EQ.X10)THEN
X0279=1
EXIT OUTLOP
END IF
END IF
V10=IR
V09=IC
EXIT OUTLOP
END DO OUTLOP
X43=REAL((X07(X08(IR,IC),1)*X07(X08(IR,IC),1)+X07(X08(IR,IC),2)*X07(X08(IR,IC),2)),KIND=X34)
X206=SQRT(X43)
X40(IR,IC)=(-1*N)
DIS=DIS+X206
IF(X0279.EQ.1)EXIT ST1LOP
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
X29=10
DO MR=-1,1
DO MC=-1,1
X29=X29-1
X0204=IR+MR
X0205=IC+MC
IF((X0204.LT.1).OR.(X0204.GT.X023))CYCLE
IF((X0205.LT.1).OR.(X0205.GT.X025))CYCLE
IF((X08(X0204,X0205).EQ.X29).AND.(X40(X0204,X0205).GT.0))EXIT X044
END DO
END DO
IF(X40(IR,IC).EQ.100)THEN
CYCLE NODLOP
ELSE
EXIT ST1LOP
END IF
EXIT NODLOP
END DO NODLOP
EXIT X044
END DO X044
X40(IR,IC)=N+1
EXIT ST1LOP
END DO ST1LOP
X0019=X0019+1
X30(X0019)=N
X067(X0019)=X098
X066(X0019)=X101
X065(X0019)=V10
X026(X0019)=V09
X027(X0019)=IR
X028(X0019)=IC
X022(X0019)=DIS
X017(X0019)=ICA(X098,X101)
X0022(X0019)=ICA(V10,V09)
X019(X0019)=ICA(IR,IC)
X020(X0019)=X03(X098,X101)
X021(X0019)=X03(IR,IC)
IF(X0279.EQ.1)EXIT STPLOP
IF(X40(IR,IC).LE.N)CYCLE DIX178
EXIT DIX178
END DO DIX178
END DO X0210
END DO X0212
END DO NLOOP
EXIT STPLOP
END DO STPLOP
DO J=1,X011
X018(J)=0
END DO
X0106=0
X00392=X0019-1
X00074=X0019+1
ILOP:DO I=1,X0019
IF(X30(I).EQ.1)THEN
IF(I.EQ.X0019)THEN
X018(I)=X019(I)+1-X017(I)-X0106
X0022(I)=X017(I)+X018(I)-1
ELSE
X0106=X0106+X0022(I)+1
X018(I)=X0022(I)+1-X017(I)
END IF
ELSE
X0106=0
DO K=1,X0019
IF((X027(K).EQ.X067(I)).AND.(X028(K).EQ.X066(I)))THEN
X0106=X0106+X0022(K)+1
END IF
END DO
IF(I.EQ.X0019)THEN
X00130=X0106
DO K=1,X00392
IF((X027(K).EQ.X027(X0019)).AND.(X028(K).EQ.X028(X0019)))THEN
X0106=X0106+X0022(K)+1
END IF
END DO
X018(I)=X019(I)+1-X0106
X0022(I)=X00130+X018(I)-1
ELSE
X018(I)=X0022(I)+1-X0106
END IF
END IF
END DO ILOP
X0102=0
DO K=1,X0019
IF(X30(K).EQ.1)THEN
X0102=X0102+X018(K)+X017(K)
ELSE
X0102=X0102+X018(K)
END IF
END DO
IF(X0102.NE.(X019(X0019)+1))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE SUMMATION OF THE DIRECT DRAINAGE AREAS IS: '',I9,/,&
&1X,''IT DOES NOT CORRESPOND TO THE DRAINAGE AREA OF THE WATERSHED'',/,&
&1X,''WHICH IS: '',I9,/,&
&1X,''PROGRAM LOGIC ERROR.'')'
WRITE(X00077,X02)X0102,(X019(X00074)+1)
WRITE(*,X02)X0102,(X019(X00074)+1)
STOP 'ABNORMAL MODULE TERMINATION.  SEE OUTPUT FILE.'
END IF
X0018=ABS(X40(X09,X10))
X017(X00074)=ICA(X09,X10)
X0022(X00074)=ICA(X09,X10)
X019(X00074)=ICA(X09,X10)
X018(X00074)=0
X022(X00074)=0.0
X020(X00074)=X03(X09,X10)
X021(X00074)=X03(X09,X10)
X30(X00074)=ABS(X40(X09,X10))
X027(X00074)=X09
X028(X00074)=X10
X065(X00074)=X09
X026(X00074)=X10
X067(X00074)=X09
X066(X00074)=X10
DO I=1,X00074
X00037(I)=-1.0
X00038(I)=-1.0
END DO
DO IC=1,X025
DO IR=1,X023
X40(IR,IC)=ABS(X40(IR,IC))
END DO
END DO
END SUBROUTINE NETAN
SUBROUTINE NETFUL
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00077
USE DTCNT1,ONLY:X023,X025,X07,X00046,X0023,X057
USE DTRST1,ONLY:X40,X08,ICA,X00061
IMPLICIT NONE
INTEGER(KIND=X36)::X00354=X00070,I=X00070,MR=X00070,MC=X00070,X0206=X00070
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070,X0001=X00070,X29=X00070
INTEGER(KIND=X35)::X00353=X00071,IR=X00071,IC=X00071,X202=X00071,X201=X00071
INTEGER(KIND=X35)::X0204=X00071,X0205=X00071
CHARACTER(LEN=500)::X02=' ', X053=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE NETFUL; MODULE DEDNM3 (M_DEDNM3.F90).'')'
X00354=0
X00353=32767
DO I=1,X057
IF(X00046(I).NE.-1)THEN
X00354=X00354+1
IF(X00046(I).LT.X00353)X00353=X00046(I)
ELSE
EXIT
END IF
END DO
IF(X00354.EQ.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''PROGRAM LOGIC ERROR.'',/,&
&1X,''A MINIMUM CSA VALUE COULD NOT BE IDENTIFIED IN SUBROUTINE NETFUL.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
X0206=0
DO IC=1,X025
DO IR=1,X023
IF(ICA(IR,IC).LT.X00353)THEN
X40(IR,IC)=0
ELSE
X40(IR,IC)=100
X0206=1
END IF
END DO
END DO
IF(X0206.EQ.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''NO CHANNELS WERE FOUND IN THE DEM COVERAGE.'',/,&
&1X,''PROGRAM EXECUTION CANNOT PROCEED WITHOUT A CHANNEL NETWORK IN THE'',/,&
&1X,''DEM COVERAGE.'',/,&
&1X,''CHECK DEM COVERAGE AND CRITICAL SOURCE AREA VALUE.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
CALL NETW1
IF(X00354.EQ.1)RETURN
IR1:DO IR=1,X023
IC1:DO IC=1,X025
IF((X40(IR,IC).NE.1).AND.(X40(IR,IC).NE.2))CYCLE IC1
IF(ICA(IR,IC).LT.X00046(X00061(IR,IC)))THEN
IF(X40(IR,IC).EQ.2)THEN
X40(IR,IC)=0
ELSE
X202=IR
X201=IC
X0215:DO
X40(X202,X201)=0
X00117=X07(X08(X202,X201),1)
X00118=X07(X08(X202,X201),2)
X202=X202+X00117
X201=X201+X00118
IF(X40(X202,X201).EQ.100)THEN
IF(ICA(X202,X201).LT.X00046(X00061(X202,X201)))THEN
CYCLE X0215
ELSE
X40(X202,X201)=1
END IF
ELSE IF((X40(X202,X201).EQ.101).OR.(X40(X202,X201).EQ.103))THEN
X0001=0
X29=10
V15:DO MR=-1,1
X0204=X202+MR
V13:DO MC=-1,1
X29=X29-1
IF((X0204.LT.1).OR.(X0204.GT.X023))CYCLE V13
X0205=X201+MC
IF((X0205.LT.1).OR.(X0205.GT.X025))CYCLE V13
IF(X40(X0204,X0205).NE.0)THEN
IF(X08(X0204,X0205).EQ.X29)THEN
X0001=X0001+1
IF(X0001.GE.2)EXIT V15
END IF
END IF
END DO V13
END DO V15
IF(X0001.EQ.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''PROGRAM LOGIC ERROR.'',/,&
&1X,''A JUNCTION WAS ENCOUNTERED WITHOUT CHANNEL INFLOW.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
ELSE IF(X0001.EQ.1)THEN
IF(X40(X202,X201).EQ.101)X40(X202,X201)=100
IF(X40(X202,X201).EQ.103)X40(X202,X201)=102
ELSE IF(X0001.GE.2)THEN
CONTINUE
END IF
ELSE IF(X40(X202,X201).EQ.102)THEN
IF(ICA(X202,X201).LT.X00046(X00061(X202,X201)))THEN
X40(X202,X201)=0
ELSE
X40(X202,X201)=2
END IF
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''PROGRAM LOGIC ERROR.'',/,&
&1X,''A NETWORK CELL WITHOUT IDENTIFIABLE VALUE WAS ENCOUNTERED.'',/,&
&1X,''ROW/COLUMN:'',1X,I4,1X,I4,/,&
&1X,''NTW RASTER CELL VALUE:'',1X,I3)'
WRITE(X00077,X02)X202,X201,X40(X202,X201)
WRITE(*,X02)X202,X201,X40(X202,X201)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
EXIT X0215
END DO X0215
END IF
END IF
END DO IC1
END DO IR1
END SUBROUTINE NETFUL
SUBROUTINE NETNUM
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00077
USE DTCNT1,ONLY:X09,X10,X07,X0019,X0016,X00031
USE DTRST1,ONLY:X08
USE DTCHA1,ONLY:X30,X067,X066,X065,X026,X027,X028,X016
IMPLICIT NONE
INTEGER(KIND=X36)::X29=X00070,X99=X00070,X197=X00070,X199=X00070
INTEGER(KIND=X35)::X00074=X00071,IRC=X00071,X06=X00071,N=X00071
INTEGER(KIND=X35)::V04=X00071,X41=X00071,X200=X00071
INTEGER(KIND=X35)::V06=X00071,V07=X00071,I=X00071,J=X00071,V08=X00071
INTEGER(KIND=X35)::LB=X00071,LE=X00071
INTEGER(KIND=X35),DIMENSION(-1:1,-1:1)::NX43=RESHAPE((/((X00071,I=1,3),J=1,3)/),(/3,3/))
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' ', X071=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE NETNUM; MODULE DEDNM3 (M_DEDNM3.F90).'')'
X051='(1X,''LOGICAL ERROR AND FORCED PROGRAM TERMINATION.'',/,&
&1X,''CHECK PROGRAM CODE TO LOCATE THE ERROR.'')'
X071='(1X,''THE STARTING POSITION OF THE SCAN COULD NOT BE LOCATED FOR NODE: '',I5)'
X00074=X0019+1
X016=0
IRC=X09
X06=X10
N=1
CPLLOP:DO
NODLOP:DO
V06=0
V07=0
DO I=-1,1
DO J=-1,1
NX43(I,J)=0
END DO
END DO
ER1LOP:DO
DO I=1,X00074
IF(X067(I).EQ.IRC.AND.X066(I).EQ.X06)THEN
V08=I
EXIT ER1LOP
END IF
END DO
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''A DOWNSTREAM CHANNEL LINK CANNOT BE FOUND FOR THE NODE AT'',/,&
&1X,''ROW AND COLUMN: '',I4,1X,I4)'
WRITE(X00077,X02)IRC,X06
WRITE(*,X02)IRC,X06
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END DO ER1LOP
DO I=1,X0019
IF(X027(I).EQ.IRC.AND.X028(I).EQ.X06)THEN
V06=V06+1
IF(X016(I,1).EQ.0)THEN
V07=V07+1
V04=X065(I)-X027(I)
X41=X026(I)-X028(I)
NX43(V04,X41)=I
END IF
END IF
END DO
IF(V06.EQ.0)THEN
X016(V08,1)=N
N=N+1
IRC=X027(V08)
X06=X028(V08)
CYCLE NODLOP
END IF
STRLOP:DO
IF(V06.EQ.1)THEN
IF(V08.NE.X00074)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''ONLY ONE INFLOW WAS FOUND NODE: '',I5,/,&
&1X,''A JUNCTION MUST HAVE AT LEAST TWO UPSTREAM INFLOWS.'')'
WRITE(X00077,X02)V08
WRITE(*,X02)V08
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
ELSE
IF(V07.EQ.1)THEN
X016(V08,1)=N
N=N+1
EXIT STRLOP
ELSE
EXIT CPLLOP
END IF
END IF
END IF
IF(V06.EQ.2)THEN
IF(V07.GE.1)THEN
IF(V07.EQ.2)THEN
X016(V08,1)=N
N=N+1
END IF
EXIT STRLOP
ELSE
IF(V08.EQ.(X0019+1))THEN
EXIT CPLLOP
ELSE
IRC=X027(V08)
X06=X028(V08)
CYCLE NODLOP
END IF
END IF
END IF
IF(V07.EQ.0)THEN
IF(V08.EQ.(X0019+1))THEN
EXIT CPLLOP
ELSE
IRC=X027(V08)
X06=X028(V08)
CYCLE NODLOP
END IF
END IF
IF(V07.EQ.1)EXIT STRLOP
IF(X016(V08,(V06-V07+1)).NE.0)EXIT STRLOP
X197=0
X200=0
X199=0
CLKLOP:DO
X29=-1
X99=-1
DO I=1,8
IF(X0016(I).EQ.X08(IRC,X06))THEN
X29=I
X99=I
EXIT CLKLOP
END IF
END DO
IF(X29.EQ.-1)THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X071)V08
WRITE(*,X071)V08
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
EXIT CLKLOP
END DO CLKLOP
EXTLOP:DO
SCNLOP:DO
IF(X29.EQ.8)THEN
X29=1
ELSE
X29=X29+1
END IF
V04=X07(X0016(X29),1)
X41=X07(X0016(X29),2)
IF(X29.EQ.X99)EXIT EXTLOP
IF(NX43(V04,X41).GT.0)THEN
IF(X197.EQ.0)THEN
X197=1
X200=X30(NX43(V04,X41))
IRC=X067(NX43(V04,X41))
X06=X066(NX43(V04,X41))
CYCLE SCNLOP
ELSE
X199=X199+1
IF(X30(NX43(V04,X41)).LT.X200)THEN
CYCLE SCNLOP
ELSE
EXIT EXTLOP
END IF
END IF
ELSE
CYCLE SCNLOP
END IF
EXIT SCNLOP
END DO SCNLOP
EXIT EXTLOP
END DO EXTLOP
LB=V06-V07+1
LE=V06-V07+X199
DO I=LB,LE
X016(V08,I)=N
N=N+1
END DO
CYCLE NODLOP
EXIT STRLOP
END DO STRLOP
ADX180:DO
X29=-1
X99=-1
DO I=1,8
IF(X0016(I).EQ.X08(IRC,X06))THEN
X29=I
X99=I
EXIT ADX180
END IF
END DO
IF(X29.EQ.-1)THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
WRITE(X00077,X071)V08
WRITE(*,X071)V08
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
EXIT ADX180
END DO ADX180
CNTLOP:DO
IF(X29.EQ.8)THEN
X29=1
ELSE
X29=X29+1
END IF
V04=X07(X0016(X29),1)
X41=X07(X0016(X29),2)
IF(X29.EQ.X99)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE FULL SCAN FAILED AT NODE: '',I5)'
WRITE(X00077,X02)V08
WRITE(*,X02)V08
END IF
IF(NX43(V04,X41).GT.0)THEN
IRC=X067(NX43(V04,X41))
X06=X066(NX43(V04,X41))
CYCLE NODLOP
ELSE
CYCLE CNTLOP
END IF
EXIT CNTLOP
END DO CNTLOP
EXIT NODLOP
END DO NODLOP
EXIT CPLLOP
END DO CPLLOP
X00031=0
DO I=1,X0019
DO J=1,7
IF(X016(I,J).GT.X00031)X00031=INT(X016(I,J),KIND=X32)
END DO
END DO
END SUBROUTINE NETNUM
SUBROUTINE NETW1
USE STSYS1,ONLY:X36,X35,X00070,X00071
USE DTCNT1,ONLY:X023,X025,X07,X0023
USE DTRST1,ONLY:X40,X08
IMPLICIT NONE
INTEGER(KIND=X36)::X0001=X00070,MR=X00070,MC=X00070,X29=X00070,KN=X00070
INTEGER(KIND=X36)::X82=X00070,X81=X00070,IV=X00070
INTEGER(KIND=X35)::X00120=X00071,X00119=X00071,IR=X00071,IC=X00071
INTEGER(KIND=X35)::X202=X00071,X201=X00071,X0204=X00071,X0205=X00071
X00120=X025-1
X00119=X023-1
X00121:IF(X0023.EQ.1)THEN
IR=1
IC=1
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(1,1).NE.0)THEN
IF(X08(2,1).EQ.2)THEN
IF(X40(2,1).GT.0)X0001=X0001+1
END IF
IF(X08(1,2).EQ.4)THEN
IF(X40(1,2).GT.0)X0001=X0001+1
END IF
IF(X08(2,2).EQ.1)THEN
IF(X40(2,2).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.6).OR.(X08(IR,IC).EQ.8).OR.(X08(IR,IC).EQ.9))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=1
IC=X025
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(1,X025).NE.0)THEN
IF(X08(2,X025).EQ.2)THEN
IF(X40(2,X025).GT.0)X0001=X0001+1
END IF
IF(X08(1,X00120).EQ.6)THEN
IF(X40(1,X00120).GT.0)X0001=X0001+1
END IF
IF(X08(2,X00120).EQ.3)THEN
IF(X40(2,X00120).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.4).OR.(X08(IR,IC).EQ.7).OR.(X08(IR,IC).EQ.8))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=X023
IC=1
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(X023,1).NE.0)THEN
IF(X08(X00119,1).EQ.8)THEN
IF(X40(X00119,1).GT.0)X0001=X0001+1
END IF
IF(X08(X00119,2).EQ.7)THEN
IF(X40(X00119,2).GT.0)X0001=X0001+1
END IF
IF(X08(X023,2).EQ.4)THEN
IF(X40(X023,2).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.2).OR.(X08(IR,IC).EQ.3).OR.(X08(IR,IC).EQ.6))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=X023
IC=X025
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(X023,X025).NE.0)THEN
IF(X08(X00119,X025).EQ.8)THEN
IF(X40(X00119,X025).GT.0)X0001=X0001+1
END IF
IF(X08(X00119,X00120).EQ.9)THEN
IF(X40(X00119,X00120).GT.0)X0001=X0001+1
END IF
IF(X08(X023,X00120).EQ.6)THEN
IF(X40(X023,X00120).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.1).OR.(X08(IR,IC).EQ.2).OR.(X08(IR,IC).EQ.4))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=1
KN=7
X82=0
X81=1
RC1:DO
IC1:DO IC=2,X00120
IF(X40(IR,IC).EQ.0)CYCLE IC1
X0001=0
X29=KN
V15:DO MR=X82,X81
X0204=IR+MR
V13:DO  MC=-1,1
X29=X29-1
X0205=IC+MC
IF(X08(X0204,X0205).EQ.X29)THEN
IF(X40(X0204,X0205).GT.0)THEN
X0001=X0001+1
IF(X0001.EQ.2)EXIT V15
END IF
END IF
END DO V13
END DO V15
IF(IR.EQ.1)THEN
IF((X08(IR,IC).EQ.1).OR.(X08(IR,IC).EQ.2).OR.(X08(IR,IC).EQ.3))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
ELSE IF(IR.EQ.X023)THEN
IF((X08(IR,IC).EQ.7).OR.(X08(IR,IC).EQ.8).OR.(X08(IR,IC).EQ.9))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
END IF
END DO IC1
IF(IR.EQ.1)THEN
IR=X023
KN=10
X82=-1
X81=0
CYCLE RC1
END IF
EXIT RC1
END DO RC1
IC=1
IV=-1
RC2:DO
IR1:DO IR=2,X00119
IF(X40(IR,IC).EQ.0)CYCLE IR1
X0001=0
X29=10
V14:DO MR=-1,1
X0204=IR+MR
V12:DO MC=-1,1
X29=X29-1
IF(MC.EQ.IV)CYCLE V12
X0205=IC+MC
IF(X08(X0204,X0205).EQ.X29)THEN
IF(X40(X0204,X0205).GT.0)THEN
X0001=X0001+1
IF(X0001.EQ.2)EXIT V14
END IF
END IF
END DO V12
END DO V14
IF(IC.EQ.1)THEN
IF((IR.GT.1).AND.(IR.LT.X023))THEN
IF((X08(IR,IC).EQ.1).OR.(X08(IR,IC).EQ.4).OR.(X08(IR,IC).EQ.7))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
END IF
ELSE IF(IC.EQ.X025)THEN
IF((IR.GT.1).AND.(IR.LT.X023))THEN
IF((X08(IR,IC).EQ.3).OR.(X08(IR,IC).EQ.6).OR.(X08(IR,IC).EQ.9))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X08(X202,X201).EQ.0)THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
END IF
END IF
END DO IR1
IF(IC.EQ.1)THEN
IC=X025
IV=1
CYCLE RC2
END IF
EXIT RC2
END DO RC2
IR2:DO IR=2,X00119
IC2:DO IC=2,X00120
IF(X40(IR,IC).EQ.0)CYCLE IC2
X0001=0
X29=10
MR3:DO MR=-1,1
X0204=IR+MR
MC3:DO MC=-1,1
X29=X29-1
X0205=IC+MC
IF(X08(X0204,X0205).EQ.X29)THEN
IF(X40(X0204,X0205).GT.0)THEN
X0001=X0001+1
IF(X0001.EQ.2)EXIT MR3
END IF
END IF
END DO MC3
END DO MR3
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)THEN
IF(X08(X202,X201).EQ.0)THEN
X40(IR,IC)=2
ELSE
X40(IR,IC)=1
END IF
ELSE IF(X0001.EQ.1)THEN
IF(X08(X202,X201).EQ.0)X40(IR,IC)=102
ELSE IF(X0001.EQ.2)THEN
IF(X08(X202,X201).EQ.0)THEN
X40(IR,IC)=103
ELSE
X40(IR,IC)=101
END IF
END IF
END DO IC2
END DO IR2
ELSE
IR=1
IC=1
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(1,1).NE.0)THEN
IF(X08(2,1).EQ.2)THEN
IF(X40(2,1).GT.0)X0001=X0001+1
END IF
IF(X08(1,2).EQ.4)THEN
IF(X40(1,2).GT.0)X0001=X0001+1
END IF
IF(X08(2,2).EQ.1)THEN
IF(X40(2,2).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.6).OR.(X08(IR,IC).EQ.8).OR.(X08(IR,IC).EQ.9))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=1
IC=X025
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(1,X025).NE.0)THEN
IF(X08(2,X025).EQ.2)THEN
IF(X40(2,X025).GT.0)X0001=X0001+1
END IF
IF(X08(1,X00120).EQ.6)THEN
IF(X40(1,X00120).GT.0)X0001=X0001+1
END IF
IF(X08(2,X00120).EQ.3)THEN
IF(X40(2,X00120).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.4).OR.(X08(IR,IC).EQ.7).OR.(X08(IR,IC).EQ.8))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=X023
IC=1
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(X023,1).NE.0)THEN
IF(X08(X00119,1).EQ.8)THEN
IF(X40(X00119,1).GT.0)X0001=X0001+1
END IF
IF(X08(X00119,2).EQ.7)THEN
IF(X40(X00119,2).GT.0)X0001=X0001+1
END IF
IF(X08(X023,2).EQ.4)THEN
IF(X40(X023,2).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.2).OR.(X08(IR,IC).EQ.3).OR.(X08(IR,IC).EQ.6))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=X023
IC=X025
IF(X40(IR,IC).NE.0)THEN
X0001=0
IF(X40(X023,X025).NE.0)THEN
IF(X08(X00119,X025).EQ.8)THEN
IF(X40(X00119,X025).GT.0)X0001=X0001+1
END IF
IF(X08(X00119,X00120).EQ.9)THEN
IF(X40(X00119,X00120).GT.0)X0001=X0001+1
END IF
IF(X08(X023,X00120).EQ.6)THEN
IF(X40(X023,X00120).GT.0)X0001=X0001+1
END IF
IF(X0001.GT.2)X0001=2
END IF
IF((X08(IR,IC).EQ.1).OR.(X08(IR,IC).EQ.2).OR.(X08(IR,IC).EQ.4))THEN
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
ELSE
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
END IF
END IF
IR=1
KN=7
X82=0
X81=1
IR3:DO
IC3:DO IC=2,X00120
IF(X40(IR,IC).EQ.0)CYCLE IC3
X0001=0
X29=KN
MR4:DO MR=X82,X81
X0204=IR+MR
MC4:DO MC=-1,1
X29=X29-1
X0205=IC+MC
IF(X08(X0204,X0205).EQ.X29)THEN
IF(X40(X0204,X0205).GT.0)THEN
X0001=X0001+1
IF(X0001.EQ.2)EXIT MR4
END IF
END IF
END DO MC4
END DO MR4
IF(IR.EQ.1)THEN
IF((X08(IR,IC).EQ.1).OR.(X08(IR,IC).EQ.2).OR.(X08(IR,IC).EQ.3))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
ELSE IF(IR.EQ.X023)THEN
IF((X08(IR,IC).EQ.7).OR.(X08(IR,IC).EQ.8).OR.(X08(IR,IC).EQ.9))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
END DO IC3
IF(IR.EQ.1)THEN
IR=X023
KN=10
X82=-1
X81=0
CYCLE IR3
END IF
EXIT IR3
END DO IR3
IC=1
IV=-1
IC4:DO
IR4:DO IR=2,X00119
IF(X40(IR,IC).EQ.0)CYCLE IR4
X0001=0
X29=10
MR5:DO MR=-1,1
X0204=IR+MR
MC5:DO MC=-1,1
X29=X29-1
IF(MC.EQ.IV)CYCLE MC5
X0205=IC+MC
IF(X08(X0204,X0205).EQ.X29)THEN
IF(X40(X0204,X0205).GT.0)THEN
X0001=X0001+1
IF(X0001.EQ.2)EXIT MR5
END IF
END IF
END DO MC5
END DO MR5
IF(IC.EQ.1)THEN
IF((IR.GT.1).AND.(IR.LT.X023))THEN
IF((X08(IR,IC).EQ.1).OR.(X08(IR,IC).EQ.4).OR.(X08(IR,IC).EQ.7))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
ELSE IF(IC.EQ.X025)THEN
IF((IR.GT.1).AND.(IR.LT.X023))THEN
IF((X08(IR,IC).EQ.3).OR.(X08(IR,IC).EQ.6).OR.(X08(IR,IC).EQ.9))THEN
IF(X0001.EQ.0)X40(IR,IC)=2
IF(X0001.EQ.1)X40(IR,IC)=102
IF(X0001.EQ.2)X40(IR,IC)=103
ELSE
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)X40(IR,IC)=1
IF(X0001.EQ.2)X40(IR,IC)=101
END IF
END IF
END IF
END DO IR4
IF(IC.EQ.1)THEN
IC=X025
IV=1
CYCLE IC4
END IF
EXIT IC4
END DO IC4
IR5:DO IR=2,X00119
IC5:DO IC=2,X00120
IF(X40(IR,IC).EQ.0)CYCLE IC5
X0001=0
X29=10
MR6:DO MR=-1,1
X0204=IR+MR
MC6:DO MC=-1,1
X29=X29-1
X0205=IC+MC
IF(X08(X0204,X0205).EQ.X29)THEN
IF(X40(X0204,X0205).GT.0)THEN
X0001=X0001+1
IF(X0001.EQ.2)EXIT MR6
END IF
END IF
END DO MC6
END DO MR6
X202=IR+X07(X08(IR,IC),1)
X201=IC+X07(X08(IR,IC),2)
IF(X0001.EQ.0)THEN
X40(IR,IC)=1
ELSE IF(X0001.EQ.1)THEN
ELSE IF(X0001.EQ.2)THEN
X40(IR,IC)=101
END IF
END DO IC5
END DO IR5
END IF X00121
END SUBROUTINE NETW1
SUBROUTINE PRUNE
USE STSYS1,ONLY:X36,X35,X00070,X00071,X34,X00072,X00077,IOS
USE DTCNT1,ONLY:X07,X00050,X023,X025,X011,X057,X0014
USE DTRST1,ONLY:X40,X08,X00061
USE GENIO1,ONLY:TESTIO
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070,X0001=X00070,MR=X00070,MC=X00070
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070,X29=X00070
INTEGER(KIND=X35)::I=X00071,J=X00071,X0204=X00071,X0205=X00071
INTEGER(KIND=X35)::X211=X00071,X212=X00071,X0002=X00071,X00455=X00071
INTEGER(KIND=X35)::V04=X00071,X41=X00071,IR=X00071,IC=X00071
INTEGER(KIND=X35)::X00454=X00071,X274=X00071,X0278=X00071
INTEGER(KIND=X35),DIMENSION(:),ALLOCATABLE::X207,X205,X082
REAL(KIND=X34)::X203=X00072,DIS=X00072,X43=X00072,X206=X00072,X204=X00072
REAL(KIND=X34)::X00126=X00072
REAL(KIND=X34),DIMENSION(:),ALLOCATABLE::TX022,X00124
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE PRUNE; MODULE DEDNM3 (M_DEDNM3.F90).'')'
X051='(1X,''THE DOWNSTREAM SEARCH ALONG CHANNEL PATHS HAS LEFT THE PREVIOUSLY DEFINED PATH.'',/,&
&1X,''THE FLOW VECTORS APPEAR TO BE IN ERROR.'',/,&
&1X,''THIS IS MOST LIKELY A LOGIC ERROR.  CONTACT PROGRAM DEVELOPERS.'')'
X011=0
DO X211=1,X023
DO X212=1,X025
IF((X40(X211,X212).EQ.1).OR.(X40(X211,X212).EQ.2))X011=X011+1
END DO
END DO
X011=X011*2+2
WRITE(X00077,'(1X,''=== ALLOCATING LOCAL JRST, JCST, NORT, TDIST AND VMINLG ARRAYS.'')')
ALLOCATE(X207(X011),STAT=IOS)
X00067=6
X01='JRST'
CALL TESTIO(X00069,X01,X0002,X00067)
ALLOCATE(X205(X011),STAT=IOS)
X00067=6
X01='JCST'
CALL TESTIO(X00069,X01,X0002,X00067)
ALLOCATE(X082(X011),STAT=IOS)
X00067=6
X01='NORT'
CALL TESTIO(X00069,X01,X0002,X00067)
ALLOCATE(TX022(X011),STAT=IOS)
X00067=6
X01='TDIST'
CALL TESTIO(X00069,X01,X0002,X00067)
ALLOCATE(X00124(X011),STAT=IOS)
X00067=6
X01='VMINLG'
CALL TESTIO(X00069,X01,X0002,X00067)
NT1:DO
X207=X00071
X205=X00071
X082=X00071
TX022=X00072
X00124=X00072
X203=0.00001
X00454=0
X274=200
X0278=0
IR1:DO X211=1,X023
IC1:DO X212=1,X025
IF((X40(X211,X212).NE.1).AND.(X40(X211,X212).NE.2))CYCLE IC1
X00454=X00454+1
IF((2*X00454).GT.X011)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE NUMBER OF GENERATED CHANNEL LINKS EXCEEDS THE AVAILABLE ARRAY SIZE'',/,&
&1X,''RESERVED FOR CHANNEL LINK PROPERTIES.'',/,&
&1X,''THE ARRAY SIZE VALUE ICHS IS NOT COMPUTED CORRECTLY.'',/,&
&1X,''ICHS = '',I6,/,&
&1X,''NEEDED ARRAY SIZE = '',I6,/,&
&1X,''LOGIC ERROR.  CONTACT PROGRAM DEVELOPERS.'')'
WRITE(X00077,X02)X011,(2*X00454)
WRITE(*,X02)X011,(2*X00454)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
X207(X00454)=X211
X205(X00454)=X212
DIS=0.0
IR=X211
IC=X212
IF(X40(IR,IC).EQ.2)THEN
X43=REAL((X07(X08(IR,IC),1)*X07(X08(IR,IC),1)+X07(X08(IR,IC),2)*X07(X08(IR,IC),2)),KIND=X34)
DIS=SQRT(X43)/2.0
ELSE
TR1:DO
X43=REAL((X07(X08(IR,IC),1)*X07(X08(IR,IC),1)+X07(X08(IR,IC),2)*X07(X08(IR,IC),2)),KIND=X34)
X206=SQRT(X43)
DIS=DIS+X206
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
IF(X40(IR,IC).EQ.100)CYCLE TR1
EXIT TR1
END DO TR1
IF(X40(IR,IC).LT.100)THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
END IF
IF((X40(IR,IC).EQ.101).OR.(X40(IR,IC).EQ.2).OR.(X40(IR,IC).EQ.102).OR.(X40(IR,IC).EQ.103))THEN
X274=X274+1
X40(IR,IC)=X274
END IF
X082(X00454)=X40(IR,IC)
TX022(X00454)=DIS
X00124(X00454)=X00050(X00061(IR,IC))
END DO IC1
END DO IR1
IF(X00454.EQ.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''NO CHANNELS WERE FOUND IN THE DEM COVERAGE.'',/,&
&1X,''THIS CANNOT HAPPEN AT THIS LOCATION OF THE CODE.'',/,&
&1X,''AN INITIAL CHECK WAS MADE IN SUBROUTINE NETFUL.'',/,&
&1X,''THIS IS A LOGIC ERROR.  CONTACT THE PROGRAM DEVELOPERS.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
J1:DO J=201,X274
J2:DO
X0001=0
X00126=32767
X00455=0
DO I=1,X00454
IF(X082(I).EQ.J)THEN
X0001=X0001+1
X204=TX022(I)-X00126
IF(X204.LT.(-X203))THEN
X00126=TX022(I)
X00455=I
END IF
END IF
END DO
IF(X0001.EQ.0)CYCLE J1
X204=(X00126*X0014)-X00124(X00455)
IF(X204.GE.(-X203))CYCLE J1
IR=X207(X00455)
IC=X205(X00455)
IF((X274.EQ.201).AND.(X0001.EQ.1))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''PROGRAM DEDNM WANTS TO PRUNE THE ONLY CHANNEL IN THE DEM COVERAGE.'',/,&
&1X,''IT IS SHORTER THAN THE MINIMUM ALLOWED FIRST ORDER CHANNEL LENGTH.'',/,&
&1X,''THIS RESULTS IN AN UNREASONABLE ANALYSIS OF A DRAINAGE NETWORK.'',/,&
&1X,''THE USER SHOULD EITHER SELECT A SHORTER MINIMUM SOURCE CHANNEL LENGTH'',/,&
&1X,''(MSCL PARAMETER), OR A SMALLER CRITICAL SOURCE AREA (CSA PARAMETER).'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF(X40(IR,IC).EQ.X082(X00455))THEN
X40(IR,IC)=0
X082(X00455)=0
CYCLE J1
END IF
IF(X40(IR,IC).NE.1)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE CHANNEL PRUNING DOES NOT START AT A SOURCE NODE OF THE NETWORK.'',/,&
&1X,''THIS IS MOST LIKELY A LOGIC ERROR.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
J3:DO
X40(IR,IC)=0
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
IF(X40(IR,IC).EQ.100)CYCLE J3
EXIT J3
END DO J3
IF(X40(IR,IC).EQ.0)THEN
WRITE(X00077,X02)
WRITE(*,X02)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
X082(X00455)=0
X0001=0
X29=10
V15:DO MR=-1,1
X0204=IR+MR
V14:DO MC=-1,1
X29=X29-1
IF((X0204.LT.1).OR.(X0204.GT.X023))CYCLE V14
X0205=IC+MC
IF((X0205.LT.1).OR.(X0205.GT.X025))CYCLE V14
IF((X08(X0204,X0205).EQ.X29).AND.(X40(X0204,X0205).GT.0))THEN
X0001=X0001+1
IF(X0001.GE.2)CYCLE J2
END IF
END DO V14
END DO V15
EXIT J2
END DO J2
IF(X0001.LE.0)THEN
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
V04=IR+X00117
X41=IC+X00118
IF((V04.LT.1).OR.(V04.GT.X023).OR.(X41.LT.1).OR.(X41.GT.X025))THEN
X40(IR,IC)=0
CYCLE J1
ELSE IF(X08(V04,X41).EQ.0)THEN
X40(IR,IC)=0
CYCLE J1
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''A JUNCTION NODE HAS NO UPSTREAM INFLOW.  THIS IS IMPOSSIBLE.'',/,&
&1X,''THIS IS MOST LIKELY A LOGIC ERROR.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
END IF
X40(IR,IC)=100
X0278=1
END DO J1
IF(X0278.EQ.1)THEN
DO IR=1,X023
DO IC=1,X025
IF(X40(IR,IC).EQ.0)THEN
CONTINUE
ELSE IF(X40(IR,IC).GT.0)THEN
X40(IR,IC)=100
ELSE IF(X40(IR,IC).EQ.2)THEN
X40(IR,IC)=1
END IF
END DO
END DO
CALL NETW1
CYCLE NT1
END IF
EXIT NT1
END DO NT1
DO IR=1,X023
DO IC=1,X025
IF(X40(IR,IC).GT.100)THEN
X40(IR,IC)=100
ELSE IF(X40(IR,IC).EQ.2)THEN
X40(IR,IC)=1
END IF
END DO
END DO
WRITE(X00077,'(1X,''=== DEALLOCATING LOCAL JRST, JCST AND NORT ARRAYS.'')')
DEALLOCATE(X207,STAT=IOS)
X00067=7
X01='JRST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X205,STAT=IOS)
X00067=7
X01='JCST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X082,STAT=IOS)
X00067=7
X01='NORT'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(TX022,STAT=IOS)
X00067=7
X01='TDIST'
CALL TESTIO(X00069,X01,X0002,X00067)
DEALLOCATE(X00124,STAT=IOS)
X00067=7
X01='VMINLG'
CALL TESTIO(X00069,X01,X0002,X00067)
END SUBROUTINE PRUNE
SUBROUTINE PRUNE1
USE STSYS1,ONLY:X35,X00071
USE DTCNT1,ONLY:X023,X025
USE DTRST1,ONLY:X40,X045
IMPLICIT NONE
INTEGER(KIND=X35)::I=X00071,J=X00071
DO I=1,X023
DO J=1,X025
IF(X40(I,J).EQ.0)THEN
X045(I,J)=0
ELSE
X045(I,J)=1
END IF
END DO
END DO
END SUBROUTINE PRUNE1
SUBROUTINE RELIEF
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X00077
USE DTCNT1,ONLY:X023,X025,X0017,X00042,X00043,X00040,X00044,X0023
USE DTRST1,ONLY:X03,X068,X046,X049
IMPLICIT NONE
INTEGER(KIND=X36)::MR=X00070,MC=X00070
INTEGER(KIND=X36)::X208=X00070,X0001=X00070,X209=X00070,V01=X00070
INTEGER(KIND=X35)::IC=X00071,IR=X00071,V03=X00071,V02=X00071
INTEGER(KIND=X35)::X00119=X00071,X00120=X00071
INTEGER(KIND=X35)::X212=X00071,X211=X00071,X0205=X00071,X0204=X00071
INTEGER(KIND=X35)::X187=X00071,X189=X00071,X181=X00071,X182=X00071
INTEGER(KIND=X35)::X183=X00071,X184=X00071,X186=X00071,X185=X00071
INTEGER(KIND=X35)::X0201=X00071,IRMAX=X00071,X0202=X00071,X0203=X00071
INTEGER(KIND=X35)::X00351=X00071,X00349=X00071,X00352=X00071,X00350=X00071
INTEGER(KIND=X35)::IRDMN=X00071,IRDMX=X00071,V11MN=X00071,V11MX=X00071
INTEGER(KIND=X35)::IRDMN1=X00071,IRDMX1=X00071,V11MN1=X00071,V11MX1=X00071
INTEGER(KIND=X35)::X0198=X00071,X00348=X00071
INTEGER(KIND=X32)::X0095=X00081,X0104=X00081,NSMO=X00081
CHARACTER(LEN=500)::X02=' ', X051=' '
X051='(/,1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!  WARNING  !!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/)'
DO IC=1,X025
DO IR=1,X023
X068(IR,IC)=0
X046(IR,IC)=0
X049(IR,IC)=0
END DO
END DO
X00119=X023-1
X00120=X025-1
CALL RELIEF1
ROW1:DO X211=2,X00119
COL1:DO X212=2,X00120
IF(X068(X211,X212).LE.3)CYCLE COL1
X049(X211,X212)=X049(X211,X212)+9999
X068(X211,X212)=4
X0201=X211-1
IF(X0201.LT.1)X0201=1
X00351=X0201+1
IRMAX=X211+10
IF(IRMAX.GT.X023)IRMAX=X023
X00349=IRMAX-1
X0202=X212-10
IF(X0202.LT.1)X0202=1
X00352=X0202+1
X0203=X212+10
IF(X0203.GT.X025)X0203=X025
X00350=X0203-1
X0216:DO
X0213:DO
X208=0
ROW2:DO IR=X00351,X00349
COL2:DO IC=X00352,X00350
IF(X068(IR,IC).EQ.4)THEN
ROW3:DO MR=-1,1
X0204=IR+MR
COL3:DO MC=-1,1
X0205=IC+MC
IF(X068(X0204,X0205).LE.4)CYCLE COL3
IF(X03(X0204,X0205).EQ.X03(IR,IC))THEN
X049(X0204,X0205)=X049(X0204,X0205)+9999
X068(X0204,X0205)=4
X208=1
END IF
END DO COL3
END DO ROW3
IF(X068(IR,IC).GT.3)X068(IR,IC)=3
END IF
END DO COL2
END DO ROW2
IF(X208.EQ.1)CYCLE X0213
EXIT X0213
END DO X0213
X208=0
IC=X0202
IF(X0202.NE.1)THEN
DO IR=X0201,IRMAX
IF(X068(IR,IC).EQ.4)THEN
X0202=X0202-10
IF(X0202.LT.1)X0202=1
X00352=X0202+1
X208=1
EXIT
END IF
END DO
END IF
IC=X0203
IF(X0203.NE.X025)THEN
DO IR=X0201,IRMAX
IF(X068(IR,IC).EQ.4)THEN
X0203=X0203+10
IF(X0203.GT.X025)X0203=X025
X00350=X0203-1
X208=1
EXIT
END IF
END DO
END IF
IR=IRMAX
IF(IRMAX.NE.X023)THEN
DO IC=X0202,X0203
IF(X068(IR,IC).EQ.4)THEN
IRMAX=IRMAX+10
IF(IRMAX.GT.X023)IRMAX=X023
X00349=IRMAX-1
X208=1
EXIT
END IF
END DO
END IF
IF(X208.EQ.1)CYCLE X0216
EXIT X0216
END DO X0216
IF(((IRMAX-X0201).GT.2500).OR.((X0203-X0202).GT.2500))THEN
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''THE PROGRAM HAS DETECTED VERY LARGE DEPRESSIONS OR FLAT AREAS'',/,&
&1X,''(SIZE IN EXCESS OF 2500 CELL LENGTHS).'',/,&
&1X,''IN SOME CIRCUMSTANCES THIS MAY LEAD TO THE GENERATION OF SECONDARY'',/,&
&1X,''DEPRESSIONS THAT WILL MAKE IT IMPOSSIBLE TO DETERMINE FLOW DIRECTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''THIS WILL LEAD TO THE TERMINATION OF PROGRAM EXECUTION.'',/,&
&1X,''IF PROGRAM EXECUTION IS TERMINATED FOR THIS REASON, THE USER IS'',/,&
&1X,''ADVISED TO REDUCE THE SIZE OF DEPRESSION OR FLAT AREAS IN THE DEM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
END IF
X0198=-1
IF(X0023.EQ.0)THEN
DO IR=X00351,X00349
DO IC=X00352,X00350
IF(X049(IR,IC).LT.9999)CYCLE
MR3:DO MR=-1,1
V03=IR+MR
DO MC=-1,1
V02=IC+MC
IF(X03(V03,V02).GT.X03(IR,IC))THEN
X046(IR,IC)=X0198
EXIT MR3
END IF
END DO
END DO MR3
END DO
END DO
ELSE
DO IR=X00351,X00349
DO IC=X00352,X00350
IF(X049(IR,IC).LT.9999)CYCLE
MR3A:DO MR=-1,1
V03=IR+MR
DO MC=-1,1
V02=IC+MC
IF(X068(V03,V02).EQ.2)CYCLE
IF(X03(V03,V02).GT.X03(IR,IC))THEN
X046(IR,IC)=X0198
EXIT MR3A
END IF
END DO
END DO MR3A
END DO
END DO
END IF
IRDMN=X0201
IRDMX=IRMAX
V11MN=X0202
V11MX=X0203
IRDMN1=X00351
IRDMX1=X00349
V11MN1=X00352
V11MX1=X00350
X00358:DO
X00348=X0198-1
X209=0
IF(X0023.EQ.0)THEN
IRDMN=30000
IRDMX=0
V11MN=30000
V11MX=0
DO IR=IRDMN1,IRDMX1
DO IC=V11MN1,V11MX1
IF(X046(IR,IC).NE.X0198)CYCLE
IRDMN=MIN(IRDMN,IR)
IRDMX=MAX(IRDMX,IR)
V11MN=MIN(V11MN,IC)
V11MX=MAX(V11MX,IC)
DO MR=-1,1
V03=IR+MR
DO MC=-1,1
V02=IC+MC
IF(X049(V03,V02).LT.9999)CYCLE
IF(X046(V03,V02).GE.0)THEN
X046(V03,V02)=X00348
X209=1
END IF
END DO
END DO
END DO
END DO
IF(X209.EQ.1)THEN
IRDMN=IRDMN-1
IF(IRDMN.LT.1)IRDMN=1
IRDMX=IRDMX+1
IF(IRDMX.GT.X023)IRDMX=X023
V11MN=V11MN-1
IF(V11MN.LT.1)V11MN=1
V11MX=V11MX+1
IF(V11MX.GT.X025)V11MX=X025
IRDMN1=IRDMN
IRDMX1=IRDMX
V11MN1=V11MN
V11MX1=V11MX
X0198=X00348
CYCLE X00358
END IF
ELSE
IRDMN=30000
IRDMX=0
V11MN=30000
V11MX=0
DO IR=IRDMN1,IRDMX1
DO IC=V11MN1,V11MX1
IF(X046(IR,IC).NE.X0198)CYCLE
IRDMN=MIN(IRDMN,IR)
IRDMX=MAX(IRDMX,IR)
V11MN=MIN(V11MN,IC)
V11MX=MAX(V11MX,IC)
DO MR=-1,1
V03=IR+MR
DO MC=-1,1
V02=IC+MC
IF(X049(V03,V02).LT.9999)CYCLE
IF(X068(V03,V02).EQ.2)CYCLE
IF(X046(V03,V02).GE.0)THEN
X046(V03,V02)=X00348
X209=1
END IF
END DO
END DO
END DO
END DO
IF(X209.EQ.1)THEN
IRDMN=IRDMN-1
IF(IRDMN.LT.1)IRDMN=1
IRDMX=IRDMX+1
IF(IRDMX.GT.X023)IRDMX=X023
V11MN=V11MN-1
IF(V11MN.LT.1)V11MN=1
V11MX=V11MX+1
IF(V11MX.GT.X025)V11MX=X025
IRDMN1=IRDMN
IRDMX1=IRDMX
V11MN1=V11MN
V11MX1=V11MX
X0198=X00348
CYCLE X00358
END IF
END IF
EXIT X00358
END DO X00358
DO IR=X0201,IRMAX
DO IC=X0202,X0203
IF(X046(IR,IC).LT.0)X046(IR,IC)=(X046(IR,IC)+ABS(X0198))*2
IF(X049(IR,IC).GE.9999)THEN
X049(IR,IC)=1
IF(X068(IR,IC).GT.3)X068(IR,IC)=3
END IF
END DO
END DO
END DO COL1
END DO ROW1
X0001=0
X00125:DO
IF(X0001.EQ.0)THEN
V01=2
ELSE
V01=1
END IF
DO IC=1,X025
DO IR=1,X023
X049(IR,IC)=X03(IR,IC)
END DO
END DO
X187=2
X181=X00119
X189=2
X182=X00120
NSMO2:DO
X183=X023
X184=X025
X186=0
X185=0
NSMO=0
IR5:DO IR=X187,X181
IC5:DO IC=X189,X182
IF(X0001.EQ.0)THEN
IF(X068(IR,IC).LE.2)THEN
X049(IR,IC)=X03(IR,IC)
CYCLE IC5
END IF
ELSE IF(X0001.EQ.1)THEN
IF((X068(IR,IC).EQ.2).OR.(X068(IR,IC).EQ.1))THEN
X049(IR,IC)=X03(IR,IC)
CYCLE IC5
END IF
END IF
DO MR=-1,1
X0204=IR+MR
DO MC=-1,1
X0205=IC+MC
IF(X03(X0204,X0205).LT.X03(IR,IC))THEN
X049(IR,IC)=X03(IR,IC)
X068(IR,IC)=-1
CYCLE IC5
END IF
END DO
END DO
X049(IR,IC)=X03(IR,IC)+INT(V01,KIND=X32)
NSMO=NSMO+1
X183=MIN(IR,X183)
X184=MIN(IC,X184)
X186=MAX(IR,X186)
X185=MAX(IC,X185)
END DO IC5
END DO IR5
X187=X183-1
X189=X184-1
X181=X186+1
X182=X185+1
IF(X187.LT.2)X187=2
IF(X189.LT.2)X189=2
IF(X181.GT.X00119)X181=X00119
IF(X182.GT.X00120)X182=X00120
NSMO1:DO
IF(NSMO.EQ.0)THEN
DO IC=1,X025
DO IR=1,X023
X03(IR,IC)=X049(IR,IC)
END DO
END DO
EXIT NSMO1
END IF
X183=X023
X184=X025
X186=0
X185=0
NSMO=0
IR6:DO IR=X187,X181
IC6:DO IC=X189,X182
IF(X0001.EQ.0)THEN
IF(X068(IR,IC).LE.2)THEN
X049(IR,IC)=X03(IR,IC)
CYCLE IC6
END IF
ELSE IF(X0001.EQ.1)THEN
IF((X068(IR,IC).EQ.2).OR.(X068(IR,IC).EQ.1))THEN
X049(IR,IC)=X03(IR,IC)
CYCLE IC6
END IF
END IF
IF(X068(IR,IC).EQ.2)CYCLE IC6
DO MR=-1,1
X0204=IR+MR
DO MC=-1,1
X0205=IC+MC
IF(X049(X0204,X0205).LT.X049(IR,IC))THEN
X03(IR,IC)=X049(IR,IC)
X068(IR,IC)=-1
CYCLE IC6
END IF
END DO
END DO
X03(IR,IC)=X049(IR,IC)+INT(V01,KIND=X32)
NSMO=NSMO+1
X183=MIN(IR,X183)
X184=MIN(IC,X184)
X186=MAX(IR,X186)
X185=MAX(IC,X185)
END DO IC6
END DO IR6
X187=X183-1
X189=X184-1
X181=X186+1
X182=X185+1
IF(X187.LT.2)X187=2
IF(X189.LT.2)X189=2
IF(X181.GT.X00119)X181=X00119
IF(X182.GT.X00120)X182=X00120
IF(NSMO.NE.0)CYCLE NSMO2
EXIT NSMO1
END DO NSMO1
EXIT NSMO2
END DO NSMO2
IF(X0001.NE.1)THEN
DO IC=1,X025
DO IR=1,X023
X03(IR,IC)=X03(IR,IC)+INT(X046(IR,IC),KIND=X32)
END DO
END DO

IF(X0001.EQ.0)THEN
X0001=1
CYCLE X00125
END IF
END IF
EXIT X00125
END DO X00125
X0104=X00042
X0095=X00043
IF(X0023.EQ.0)THEN
DO IC=1,X025
DO IR=1,X023
IF(X03(IR,IC).GT.X0104)X0104=X03(IR,IC)
IF(X03(IR,IC).LT.X0095)X0095=X03(IR,IC)
END DO
END DO
ELSE
DO IC=1,X025
DO IR=1,X023
IF(X03(IR,IC).GT.X0104)THEN
IF(X03(IR,IC).NE.X0017)X0104=X03(IR,IC)
END IF
IF(X03(IR,IC).LT.X0095)THEN
IF(X03(IR,IC).NE.X0017)X0095=X03(IR,IC)
END IF
END DO
END DO
END IF
IF(X0104.GT.X00043)THEN
X02='(5X,''MAXIMUM ELEVATION * 100,000 HAS BEEN INCREASED BY SUBROUTINE RELIEF'',/,&
&5X,''FROM'',1X,I8,1X,''TO'',1X,I8,''.'')'
WRITE(X00077,X02)X00043,X0104
WRITE(*,X02)X00043,X0104
X00043=X0104
END IF
X00044=X0104
X00040=X0095
CONTAINS
SUBROUTINE RELIEF1
IMPLICIT NONE
INTEGER(KIND=X36)::MR=X00070,MC=X00070
INTEGER(KIND=X35)::IC=X00071,IR=X00071,X0204=X00071,X0205=X00071
IF(X0023.EQ.0)THEN
DO IR=2,X00119
PREC1:DO IC=2,X00120
DO MR=-1,1
X0204=IR+MR
DO MC=-1,1
X0205=IC+MC
IF(X03(X0204,X0205).LT.X03(IR,IC))THEN
X068(IR,IC)=1
CYCLE PREC1
END IF
END DO
END DO
X068(IR,IC)=5
END DO PREC1
END DO
ELSE
DO IR=2,X00119
PREC2:DO IC=2,X00120
IF(X03(IR,IC).EQ.X0017)THEN
X068(IR,IC)=2
CYCLE PREC2
END IF
DO MR=-1,1
X0204=IR+MR
DO MC=-1,1
X0205=IC+MC
IF(X03(X0204,X0205).LT.X03(IR,IC))THEN
X068(IR,IC)=1
CYCLE PREC2
END IF
END DO
END DO
X068(IR,IC)=5
END DO PREC2
END DO
END IF
END SUBROUTINE RELIEF1
END SUBROUTINE RELIEF
SUBROUTINE SMOOTH
USE STSYS1,ONLY:X00071,X00082,X35,X32,X33
USE DTCNT1,ONLY:X023,X025,X0017,X015,X12,X13,X14
USE DTRST1,ONLY:X03,X049
IMPLICIT NONE
INTEGER(KIND=X35)::I=X00071, J=X00071,K=X00071,L=X00071,X0199=X00071
INTEGER(KIND=X35)::IC=X00071, IR=X00071,V02=X00071,V03=X00071
INTEGER(KIND=X35)::X00120=X00071,X00119=X00071,ICF=X00071,IRF=X00071
INTEGER(KIND=X35)::IDN=X00071,X79=X00071,X0096=X00071
INTEGER(KIND=X35),DIMENSION(1:9)::IW=(/(X00071,I=1,9)/)
REAL(KIND=X33)::X42=X00082,X096=X00082,X100=X00082
X049=0
IW(1)=X14
IW(3)=X14
IW(7)=X14
IW(9)=X14
IW(2)=X13
IW(4)=X13
IW(6)=X13
IW(8)=X13
IW(5)=X12
IRF=1
V03=X023
ICF=1
V02=X025
X00119=X023-1
X00120=X025-1
DO IC=1,X025
X049(IRF,IC)=X03(IRF,IC)
X049(V03,IC)=X03(V03,IC)
END DO
DO IR=1,X023
X049(IR,ICF)=X03(IR,ICF)
X049(IR,V02)=X03(IR,V02)
END DO
X0096=X015
A:DO X79=1,X015
DO K=2,X00119
K1:DO L=2,X00120
X0199=0
IDN=0
X42=0.0
DO I=K-1,K+1
K2:DO J=L-1,L+1
X0199=X0199+1
IF(X03(I,J).EQ.X0017)THEN
IF(X0199.EQ.5)THEN
X049(K,L)=X0017
CYCLE K1
END IF
CYCLE K2
ELSE
X096=REAL(X03(I,J),KIND=X33)
X100=REAL(IW(X0199),KIND=X33)
X42=X42+X096*X100
IDN=IDN+IW(X0199)
END IF
END DO K2
END DO
X049(K,L)=NINT((X42/REAL(IDN,KIND=X33)),KIND=X32)
END DO K1
END DO
X0096=X0096-1
IF(X0096.EQ.0)THEN
DO I=1,X023
DO J=1,X025
X03(I,J)=X049(I,J)
X049(I,J)=0
END DO
END DO
EXIT A
END IF
DO K=2,X00119
K3:DO L=2,X00120
X0199=0
IDN=0
X42=0.0
DO I=K-1,K+1
K4:DO J=L-1,L+1
X0199=X0199+1
IF(X049(I,J).EQ.X0017)THEN
IF(X0199.EQ.5)THEN
X03(K,L)=X0017
CYCLE K3
END IF
CYCLE K4
ELSE
X096=REAL(X049(I,J),KIND=X33)
X100=REAL(IW(X0199),KIND=X33)
X42=X42+X096*X100
IDN=IDN+IW(X0199)
END IF
END DO K4
END DO
X03(K,L)=NINT((X42/REAL(IDN,KIND=X33)),KIND=X32)
END DO K3
END DO
X0096=X0096-1
IF(X0096.EQ.0)EXIT A
END DO A
DO K=1,X023
DO L=1,X025
X03(K,L)=NINT((REAL(X03(K,L),KIND=X33)/10000.),KIND=X32)*10000
END DO
END DO
END SUBROUTINE SMOOTH
SUBROUTINE SUBWTA
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X00077
USE DTCNT1,ONLY:X023,X025,X09,X10,X07,X0019,X011,X0016,X0023,&
X00030
USE DTRST1,ONLY:X08,X048,X045
USE DTCHA1,ONLY:X30,X067,X066,X027,X028,X016,X0022
USE DTCAT1
IMPLICIT NONE
INTEGER(KIND=X36)::X00128=X00070,X0001=X00070,X29=X00070,X99=X00070
INTEGER(KIND=X36)::J=X00070,JX=X00070
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070
INTEGER(KIND=X35)::IR=X00071,IC=X00071,X00074=X00071,K=X00071
INTEGER(KIND=X35)::KO=X00071,V04=X00071,X41=X00071
INTEGER(KIND=X35)::I=X00071
INTEGER(KIND=X35)::X77=X00071,X76=X00071,X74=X00071,NCE=X00071
INTEGER(KIND=X35)::X0195=X00071,X0276=X00071,X0194=X00071,X0277=X00071
INTEGER(KIND=X32)::X195=X00081,X198=X00081
INTEGER(KIND=X32)::X00346=X00081,X059=X00081,X73=X00081
CHARACTER(LEN=300)::X02=' ', X053=' ', X051=' ', X071=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE SUBWTA; MODULE DEDNM3 (M_DEDNM3.F90).'')'
X051='(1X,''LOGICAL OR DATA ERROR.  PROGRAM EXECUTION TERMINATED.'')'
X071='(1X,''CIRCULAR SCAN COULD NOT LOCATE OUTFLOWING VECTOR DIRECTION AT CELL'',/,&
&1X,''GIVEN BY ROW AND COLUMN: '',I4,1X,I4)'
X033=0
X035=X023+1
X037=X025+1
X036=0
X038=0
X00346=0
DO IC=1,X025
IF(X048(1,IC).EQ.1)THEN
X045(1,IC)=-1
X00346=X00346+1
ELSE
X045(1,IC)=-2
END IF
IF(X048(X023,IC).EQ.1)THEN
X045(X023,IC)=-1
X00346=X00346+1
ELSE
X045(X023,IC)=-2
END IF
END DO
DO IR=1,X023
IF(X048(IR,1).EQ.1)THEN
X045(IR,1)=-1
X00346=X00346+1
ELSE
X045(IR,1)=-2
END IF
IF(X048(IR,X025).EQ.1)THEN
X045(IR,X025)=-1
X00346=X00346+1
ELSE
X045(IR,X025)=-2
END IF
END DO
X00074=X0019+1
X027(X00074)=X09+X07(X08(X09,X10),1)
X028(X00074)=X10+X07(X08(X09,X10),2)
X067(X00074)=X09
X066(X00074)=X10
X00128=X30(X00074)
X30(X00074)=0
IF(X00346.NE.0)THEN
DO1:DO K=1,X00074
X0001=0
IR=X067(K)
IC=X066(K)
IF(K.EQ.X00074)THEN
KO=K-1
ELSE
KO=K
END IF
NXT0:DO
NXT1:DO
FLG1:IF(X0001.EQ.0)THEN
IF(X30(K).EQ.1)THEN
X29=0
DO I=-1,1
V04=IR+I
DO J=-1,1
X29=X29+1
X41=IC+J
IF(X045(IR,IC).EQ.-1)THEN
IF((V04.GT.X023).OR.(V04.LT.1).OR.(X41.GT.X025).OR.(X41.LT.1))CYCLE
END IF
IF(X08(V04,X41).EQ.0)CYCLE
IF((10-X08(V04,X41)).EQ.X29)THEN
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+1
END IF
END DO
END DO
EXIT NXT1
END IF
END IF FLG1
X0001=0
EXT1:DO
DO I=1,8
IF(X0016(I).EQ.X08(IR,IC))THEN
X99=I
EXIT EXT1
END IF
END DO
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X071)IR,IC
WRITE(*,X071)IR,IC
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK OUTPUT FILE.'
END DO EXT1
X29=X99
RPT1:DO
IF(X29.EQ.8)THEN
X29=1
ELSE
X29=X29+1
END IF
V04=IR+X07(X0016(X29),1)
X41=IC+X07(X0016(X29),2)
IF(X045(IR,IC).EQ.-1)THEN
IF((V04.GT.X023).OR.(V04.LT.1).OR.(X41.GT.X025).OR.(X41.LT.1))CYCLE RPT1
END IF
IF(X08(V04,X41).EQ.0)CYCLE RPT1
IF((10-X08(V04,X41)).EQ.X0016(X29))THEN
IF(X048(V04,X41).EQ.1)THEN
EXIT RPT1
ELSE
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+2
END IF
END IF
CYCLE RPT1
EXIT RPT1
END DO RPT1
X29=X99
RPT2:DO
IF(X29.EQ.1)THEN
X29=8
ELSE
X29=X29-1
END IF
V04=IR+X07(X0016(X29),1)
X41=IC+X07(X0016(X29),2)
IF(X045(IR,IC).EQ.-1)THEN
IF((V04.GT.X023).OR.(V04.LT.1).OR.(X41.GT.X025).OR.(X41.LT.1))CYCLE RPT2
END IF
IF(X08(V04,X41).EQ.0)CYCLE RPT2
IF((10-X08(V04,X41)).EQ.X0016(X29))THEN
IF(X048(V04,X41).EQ.1)THEN
EXIT RPT2
ELSE
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+3
END IF
END IF
CYCLE RPT2
EXIT RPT2
END DO RPT2
IF((IR.EQ.X067(K)).AND.(IC.EQ.X066(K)))THEN
X29=0
DO I=-1,1
V04=IR+I
DO J=-1,1
X29=X29+1
X41=IC+J
IF(X045(IR,IC).EQ.-1)THEN
IF((V04.GT.X023).OR.(V04.LT.1).OR.(X41.GT.X025).OR.(X41.LT.1))CYCLE
END IF
IF(X08(V04,X41).EQ.0)CYCLE
IF(X048(V04,X41).EQ.0)THEN
IF((10-X08(V04,X41)).EQ.X29)THEN
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+2
END IF
END IF
END DO
END DO
END IF
EXIT NXT1
END DO NXT1
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
X0001=0
IF((IR.NE.X027(K)).OR.(IC.NE.X028(K)))THEN
X0001=1
CYCLE NXT0
END IF
EXIT NXT0
END DO NXT0
END DO DO1
ELSE IF((X00346.EQ.0).AND.(X0023.EQ.1))THEN
DO2:DO K=1,X00074
X0001=0
IR=X067(K)
IC=X066(K)
IF(K.EQ.X00074)THEN
KO=K-1
ELSE
KO=K
END IF
NXT2:DO
NXT3:DO
FLG2:IF(X0001.EQ.0)THEN
IF(X30(K).EQ.1)THEN
X29=0
DO I=-1,1
V04=IR+I
DO J=-1,1
X29=X29+1
X41=IC+J
IF(X08(V04,X41).EQ.0)CYCLE
IF((10-X08(V04,X41)).EQ.X29)THEN
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+1
END IF
END DO
END DO
EXIT NXT3
END IF
END IF FLG2
X0001=0
EXT2:DO
DO I=1,8
IF(X0016(I).EQ.X08(IR,IC))THEN
X99=I
EXIT EXT2
END IF
END DO
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X071)IR,IC
WRITE(*,X071)IR,IC
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK OUTPUT FILE.'
END DO EXT2
X29=X99
RPT3:DO
IF(X29.EQ.8)THEN
X29=1
ELSE
X29=X29+1
END IF
V04=IR+X07(X0016(X29),1)
X41=IC+X07(X0016(X29),2)
IF(X08(V04,X41).EQ.0)CYCLE RPT3
IF((10-X08(V04,X41)).EQ.X0016(X29))THEN
IF(X048(V04,X41).EQ.1)THEN
EXIT RPT3
ELSE
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+2
END IF
END IF
CYCLE RPT3
EXIT RPT3
END DO RPT3
X29=X99
RPT4:DO
IF(X29.EQ.1)THEN
X29=8
ELSE
X29=X29-1
END IF
V04=IR+X07(X0016(X29),1)
X41=IC+X07(X0016(X29),2)
IF(X08(V04,X41).EQ.0)CYCLE RPT4
IF((10-X08(V04,X41)).EQ.X0016(X29))THEN
IF(X048(V04,X41).EQ.1)THEN
EXIT RPT4
ELSE
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+3
END IF
END IF
CYCLE RPT4
EXIT RPT4
END DO RPT4
IF((IR.EQ.X067(K)).AND.(IC.EQ.X066(K)))THEN
X29=0
DO I=-1,1
V04=IR+I
DO J=-1,1
X29=X29+1
X41=IC+J
IF(X08(V04,X41).EQ.0)CYCLE
IF(X048(V04,X41).EQ.0)THEN
IF((10-X08(V04,X41)).EQ.X29)THEN
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+2
END IF
END IF
END DO
END DO
END IF
EXIT NXT3
END DO NXT3
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
X0001=0
IF((IR.NE.X027(K)).OR.(IC.NE.X028(K)))THEN
X0001=1
CYCLE NXT2
END IF
EXIT NXT2
END DO NXT2
END DO DO2
ELSE IF((X00346.EQ.0).AND.(X0023.EQ.0))THEN
DO3:DO K=1,X00074
X0001=0
IR=X067(K)
IC=X066(K)
IF(K.EQ.X00074)THEN
KO=K-1
ELSE
KO=K
END IF
NXT4:DO
NXT5:DO
FLG3:IF(X0001.EQ.0)THEN
IF(X30(K).EQ.1)THEN
X29=0
DO I=-1,1
V04=IR+I
DO J=-1,1
X29=X29+1
X41=IC+J
IF((10-X08(V04,X41)).EQ.X29)THEN
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+1
END IF
END DO
END DO
EXIT NXT5
END IF
END IF FLG3
EXT3:DO
DO I=1,8
IF(X0016(I).EQ.X08(IR,IC))THEN
X99=I
EXIT EXT3
END IF
END DO
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X071)IR,IC
WRITE(*,X071)IR,IC
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK OUTPUT FILE.'
END DO EXT3
X29=X99
RPT5:DO
IF(X29.EQ.8)THEN
X29=1
ELSE
X29=X29+1
END IF
V04=IR+X07(X0016(X29),1)
X41=IC+X07(X0016(X29),2)
IF((10-X08(V04,X41)).EQ.X0016(X29))THEN
IF(X048(V04,X41).EQ.1)THEN
EXIT RPT5
ELSE
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+2
END IF
END IF
CYCLE RPT5
EXIT RPT5
END DO RPT5
X29=X99
RPT6:DO
IF(X29.EQ.1)THEN
X29=8
ELSE
X29=X29-1
END IF
V04=IR+X07(X0016(X29),1)
X41=IC+X07(X0016(X29),2)
IF((10-X08(V04,X41)).EQ.X0016(X29))THEN
IF(X048(V04,X41).EQ.1)THEN
EXIT RPT6
ELSE
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+3
END IF
END IF
CYCLE RPT6
EXIT RPT6
END DO RPT6
IF((IR.EQ.X067(K)).AND.(IC.EQ.X066(K)))THEN
X29=0
DO I=-1,1
V04=IR+I
DO J=-1,1
X29=X29+1
X41=IC+J
IF(X048(V04,X41).EQ.0)THEN
IF((10-X08(V04,X41)).EQ.X29)THEN
X048(V04,X41)=INT(X016(KO,1),KIND=X32)*10+2
END IF
END IF
END DO
END DO
END IF
EXIT NXT5
END DO NXT5
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
X0001=0
IF((IR.NE.X027(K)).OR.(IC.NE.X028(K)))THEN
X0001=1
CYCLE NXT4
END IF
EXIT NXT4
END DO NXT4
END DO DO3
END IF
DO K=1,X00074
IR=X067(K)
IC=X066(K)
IF(K.EQ.X00074)THEN
KO=K-1
ELSE
KO=K
END IF
RPT7:DO
X048(IR,IC)=INT(X016(KO,1),KIND=X32)*10+4
X00117=X07(X08(IR,IC),1)
X00118=X07(X08(IR,IC),2)
IR=IR+X00117
IC=IC+X00118
IF(IR.NE.X027(K))CYCLE RPT7
IF(IC.NE.X028(K))CYCLE RPT7
EXIT RPT7
END DO RPT7
END DO
X0195=1
X0194=X023
X0276=1
X0277=X025
RPT8:DO
IF(X0195.GT.1)THEN
X77=X0195-1
ELSE
X77=1
END IF
IF(X0194.LT.X023)THEN
X76=X0194+1
ELSE
X76=X023
END IF
IF(X0276.GT.1)THEN
X74=X0276-1
ELSE
X74=1
END IF
IF(X0277.LT.X025)THEN
NCE=X0277+1
ELSE
NCE=X025
END IF
X0195=X023
X0194=1
X0276=X025
X0277=1
X73=0
DO IR=X77,X76
DO IC=X74,NCE
IF(X048(IR,IC).GT.0)CYCLE
IF(X08(IR,IC).EQ.0)CYCLE
V04=IR+X07(X08(IR,IC),1)
X41=IC+X07(X08(IR,IC),2)
IF(X045(IR,IC).LE.-1)THEN
IF((V04.LT.1).OR.(V04.GT.X023).OR.(X41.LT.1).OR.(X41.GT.X025))CYCLE
END IF
IF(X048(V04,X41).GT.0)THEN
X048(IR,IC)=X048(V04,X41)
X73=X73+1
X0195=MIN(IR,X0195)
X0194=MAX(IR,X0194)
X0276=MIN(IC,X0276)
X0277=MAX(IC,X0277)
ELSE
CYCLE
END IF
END DO
END DO
IF(X73.GT.0)CYCLE RPT8
EXIT RPT8
END DO RPT8
X059=0
DO IC=1,X025
DO IR=1,X023
IF(X048(IR,IC).GT.0)THEN
X059=X059+1
X195=X048(IR,IC)/10
X198=X048(IR,IC)-(X195*10)
X033(X195,X198)=X033(X195,X198)+1
X033(X195,5)=X033(X195,5)+1
IF(IR.LT.X035(X195,X198))X035(X195,X198)=IR
IF(IR.GT.X036(X195,X198))X036(X195,X198)=IR
IF(IC.LT.X037(X195,X198))X037(X195,X198)=IC
IF(IC.GT.X038(X195,X198))X038(X195,X198)=IC
ENDIF
END DO
END DO
DO I=1,5
X033(1,I)=-1
END DO
DO I=1,X00074
IF(X30(I).EQ.1)THEN
IF(X033(X016(I,1),5).NE.(X0022(I)+1))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''FOR NODE NUMBER '',I4,1X,''THE UPSTREAM DRAINAGE AREA DOES NOT CORRESPOND'',/,&
&1X,''FOR THE CHANNEL LINK AND THE CATCHMENT FILES.'',/,&
&1X,''THE CHANNEL LINK VALUE IS: '',I7,/,&
&1X,''THE CATCHMENT VALUE IS :'',I7)'
WRITE(X00077,X02)X016(I,1),X033(X016(I,1),5),(X0022(I)+1)
WRITE(*,X02)X016(I,1),X033(X016(I,1),5),(X0022(I)+1)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK OUTPUT FILE.'
END IF
END IF
END DO
DO I=1,X0019
IF(X30(I).NE.1)THEN
IF(X033(X016(I,1),1).NE.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''AT NODE NUMBER: '',I5,1X,''WHICH IS OF STRAHLER ORDER: '',I5,1X,/,&
&1X,''THE SOURCE NODE DRAINAGE AREA IS NOT ZERO.'',/,&
&1X,''IT IS: '',I6,1X,''CELLS LARGE.'')'
WRITE(X00077,X02)I,X30(I),X033(X016(I,1),1)
WRITE(*,X02)I,X30(I),X033(X016(I,1),1)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK OUTPUT FILE.'
END IF
X033(X016(I,1),1)=-1
END IF
END DO
DO I=1,X011
DO J=1,4
IF((X035(I,J).EQ.X023+1).OR.(X037(I,J).EQ.X025+1).OR.&
(X036(I,J).EQ.0).OR.(X038(I,J).EQ.0))THEN
X035(I,J)=-1
X037(I,J)=-1
X036(I,J)=-1
X038(I,J)=-1
END IF
END DO
END DO
IF(X059.NE.(X00030+1))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''CATCHMENT AREA DOES NOT ADD UP TO WATERSHED AREA:'',/,&
&1X,I6,1X,I6)'
WRITE(X00077,X02)X059,(X00030+1)
WRITE(*,X02)X059,(X00030+1)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK OUTPUT FILE.'
END IF
X027(X00074)=X09
X028(X00074)=X10
X067(X00074)=X09
X066(X00074)=X10
X30(X00074)=X00128
DO I=1,X00074
X034(I)=X30(I)
X052(I)=X033(X016(I,1),1)
X23(I)=X033(X016(I,1),2)
X22(I)=X033(X016(I,1),3)
ICHA(I)=X033(X016(I,1),4)
X00033(I)=X033(X016(I,1),5)
DO J=1,4
X18(I,J)=X035(X016(I,1),J)
X20(I,J)=X036(X016(I,1),J)
X19(I,J)=X037(X016(I,1),J)
X21(I,J)=X038(X016(I,1),J)
END DO
DO J=2,3
JX=J+3
X18(I,JX)=X18(I,J)
X20(I,JX)=X20(I,J)
X19(I,JX)=X19(I,J)
X21(I,JX)=X21(I,J)
IF((X18(I,J).EQ.-1).OR.(X20(I,J).EQ.-1).OR.&
(X19(I,J).EQ.-1).OR.(X21(I,J).EQ.-1))THEN
X18(I,JX)=X18(I,4)
X19(I,JX)=X19(I,4)
X21(I,JX)=X21(I,4)
X20(I,JX)=X20(I,4)
ELSE
IF(X18(I,4).LE.X18(I,JX))X18(I,JX)=X18(I,4)
IF(X20(I,4).GT.X20(I,JX))X20(I,JX)=X20(I,4)
IF(X21(I,4).GT.X21(I,JX))X21(I,JX)=X21(I,4)
IF(X19(I,4).LE.X19(I,JX))X19(I,JX)=X19(I,4)
END IF
END DO
END DO
END SUBROUTINE SUBWTA
SUBROUTINE SUBWT1
USE STSYS1,ONLY:X35,X00071
USE DTCNT1,ONLY:X023,X025
USE DTRST1,ONLY:X40,X048
IMPLICIT NONE
INTEGER(KIND=X35)::IR=X00071,IC=X00071
DO IC=1,X025
DO IR=1,X023
IF(X40(IR,IC).GT.0)THEN
X048(IR,IC)=1
ELSE
X048(IR,IC)=0
END IF
END DO
END DO
END SUBROUTINE SUBWT1
SUBROUTINE UPAREA
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X00077
USE DTCNT1,ONLY:X023,X025,X0023,X00029,X07
USE DTRST1,ONLY:X08,ICA,X271
INTEGER(KIND=X36)::X00117=X00070,X00118=X00070
INTEGER(KIND=X35)::IR=X00071,IC=X00071,V04=X00071,X41=X00071
INTEGER(KIND=X32)::X273=X00081
CHARACTER(LEN=500)::X02=' ', X053=' '
X00029=-1
IF(X0023.EQ.0)THEN
ICA=0
ELSE
DO IC=1,X025
DO IR=1,X023
IF(X271(IR,IC).EQ.0)THEN
ICA(IR,IC)=-1
ELSE
ICA(IR,IC)=0
END IF
END DO
END DO
END IF
IR1:DO IR=1,X023
IC1:DO IC=1,X025
IF(X271(IR,IC).EQ.4)THEN
CONTINUE
ELSE IF(X271(IR,IC).EQ.2)THEN
ICA(IR,IC)=0
X273=0
V04=IR
X41=IC
PATH:DO
IF(X271(V04,X41).EQ.1)THEN
IF(ICA(V04,X41).GT.X00029)X00029=ICA(V04,X41)
ELSE
IF(ICA(V04,X41).EQ.X273)X273=X273+1
X00117=X07(X08(V04,X41),1)
X00118=X07(X08(V04,X41),2)
V04=V04+X00117
X41=X41+X00118
ICA(V04,X41)=ICA(V04,X41)+X273
CYCLE PATH
END IF
EXIT PATH
END DO PATH
ELSE IF(X271(IR,IC).EQ.3)THEN
ICA(IR,IC)=0
END IF
END DO IC1
END DO IR1
IF(X00029.EQ.-1)THEN
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE UPAREA; MODULE DEDNM3 (M_DEDNM3.F90).'')'
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE LARGEST UPSTREAM AREA IN THE DEM ARRAY WAS NOT COMPUTED.'',/,&
&1X,''THE DEM RASTER HAS ELEVATION VALUES, FLOW VECTORS, OR A STRUCTURE THAT COULD'',/,&
&1X,''NOT BE PROCESSED FOR UPSTREAM DRAINAGE AREA.'',/,&
&1X,''CHECK DEM INPUT RASTER AND FLOW VECTORS TO IDENTIFY THE LOCATION OF THE'',/,&
&1X,''PROBLEM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL MODULE TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'
END IF
END SUBROUTINE UPAREA
END MODULE DEDNM3
MODULE DEDNM2
CONTAINS
SUBROUTINE CAPLIM
USE STSYS1,ONLY:X00077
IMPLICIT NONE
CHARACTER(LEN=700)::X02=' ', X053=' '
X053='(1X)'
WRITE(X00077,X053)
WRITE(X00077,X053)
X02='(1X,''CAPABILITIES, LIMITATIONS AND SPECIFICATIONS OF SOFTWARE TOPAZ:'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM PROCESSES THE RASTER DIGITAL ELEVATION MODEL (DEM) OF'',/,&
&3X,''A WATERSHED TO DEFINE THE DRAINAGE NETWORK, SUBDIVIDE THE WATERSHED INTO'',/,&
&3X,''SUBCATCHMENTS, AND EXTRACT SELECTED CHANNEL AND SUBCATCHMENT GEOMETRIC'',/,&
&3X,''PARAMETERS.  THE DEM SHOULD REPRESENT LANDSCAPES THAT ARE DISSECTED BY'')'
WRITE(X00077,X02)
X02='(3X,''CONCENTRATED-FLOW CHANNELS AND THAT DISPLAY SUFFICIENT RELIEF TO'',/,&
&3X,''TOPOGRAPHICALLY DEFINE FLOW CONVERGENCE AND DOWNSTREAM FLOW PATHS.'',/,&
&3X,''INCLINED AND PERFECTLY FLAT SURFACES WITHIN THE DIGITAL LANDSCAPE ARE'',/,&
&3X,''ACCEPTED BY PROGRAM DEDNM, BUT THE ABSENCE OF ANY DETAILED RELIEF OVER'',/,&
&3X,''LARGE SURFACES MAY RESULT IN LOCAL FLOW PATHS THAT DEVIATE FROM ACTUAL'',/,&
&3X,''CONDITIONS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM EXTRACTS THE FOLLOWING RASTER IMAGES FROM A GIVEN DEM:'',/,&
&3X,''* WATERSHED INPUT ELEVATIONS AFTER AGGREGATION OR RESAMPLING;'',/,&
&3X,''* WATERSHED ELEVATIONS AFTER AGGREGATION OR RESAMPLING, AND SMOOTHING;'',/,&
&3X,''* WATERSHED ELEVATIONS AFTER AGGREGATION OR RESAMPLING, SMOOTHING, AND'',/,&
&5X,''DEPRESSION ANALYSIS, DEPRESSION OUTLET ADJUSTMENT, AND FILLING;'',/,&
&3X,''* WATERSHED ELEVATIONS AFTER AGGREGATION OR RESAMPLING, SMOOTHING,'')'
WRITE(X00077,X02)
X02='(5X,''DEPRESSION ANALYSIS, DEPRESSION OUTLET ADJUSTMENT, FILLING, AND RELIEF'',/,&
&5X,''MODIFICATION TO ESTABLISH POSITIVE DRAINAGE IN FLAT AREAS;'',/,&
&3X,''* LOCAL FLOW VECTORS;'',/,&
&3X,''* FLOW PATH CODES;'',/,&
&3X,''* DEFINITION OF FLOW PATHS (BEGINNING AND ENDING POINTS);'')'
WRITE(X00077,X02)
X02='(3X,''* LOCAL UPSTREAM DIRECT DRAINAGE AREAS;'',/,&
&3X,''* CODES FOR CSA AND MSCL PARAMETERS AFTER AGGREGATION OR RESAMPLING;'',/,&
&3X,''* DRAINAGE NETWORK FOR ENTIRE DEM COVERAGE;'',/,&
&3X,''* OUTLINE OF WATERSHED;'',/,&
&3X,''* DRAINAGE NETWORK WITH STRAHLER ORDERS WITHIN WATERSHED BOUNDARIES ONLY;'',/,&
&3X,''* SUBCATCHMENT LOCATION, EXTENT AND INDEXES, WITHIN WATERSHED BOUNDARIES'',/,&
&5X,''ONLY, INCLUDING DRAINAGE NETWORK.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM PROVIDES THE FOLLOWING REPORT AND TABULAR OUTPUT:'',/&
&3X,''* REPORT OF PROGRAM EXECUTION FOR PROGRAM DEDNM;'',/,&
&3X,''* TABLE OF GEOMETRIC AND TOPOLOGIC CHANNEL PARAMETERS;'',/,&
&3X,''* TABLE OF SUBCATCHMENT AREA PARAMETERS;'',/,&
&3X,''* TABLE OF SUBCATCHMENT WINDOW SITES.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM PROVIDES A COMPREHENSIVE INDEXING OF THE CHANNEL LINKS AND'',/,&
&3X,''SUBCATCHMENTS.  THIS INDEXING (NUMBERING) FOLLOWS THE SCHEME DESCRIBED IN:'',/,&
&3X,''DETERMINATION OF THE EXECUTION SEQUENCE OF CHANNELS IN A DRAINAGE'')'
WRITE(X00077,X02)
X02='(3X,''NETWORK FOR CASCADE ROUTING; J. GARBRECHT; 1988; HYDROSOFT; SOFTWARE'',/,&
&3X,''FOR HYDRAULICS, HYDROLOGY AND HYDRODYNAMICS; COMPUTATIONAL MECHANICS'',/,&
&3X,''PUBLICATIONS; VOL. 1, NO. 3, JULY 1988.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE IDENTIFICATION OF THE SOURCES OF A GENERATED DRAINAGE NETWORK REQUIRES'',/,&
&3X,''THE INPUT OF A CRITICAL SOURCE AREA (CSA), I.E. A REPRESENTATIVE'',/,&
&3X,''THRESHOLD (MINIMUM) DRAINAGE AREA AT THE BOTTOM OF WHICH A SOURCE'',/,&
&3X,''CHANNEL (1ST ORDER CHANNEL) IS INITIATED AND MAINTAINED.  ALSO'')'
WRITE(X00077,X02)
X02='(3X,''REQUIRED IS A MINIMUM SOURCE CHANNEL LENGTH (MSCL) FOR FIRST ORDER CHANNELS'',/,&
&3X,''TO BE CLASSIFIED AS FIRST ORDER CHANNELS.  BOTH THESE INPUT PARAMETERS'',/,&
&3X,''CAN BE USED TO INTRODUCE THE EFFECT OF SCALE AND RESOLUTION INTO THE DEM'',/,&
&3X,''PROCESSING.  THE DRAINAGE NETWORK, THE ORDER OF THE NETWORK, THE DRAINAGE'')'
WRITE(X00077,X02)
X02='(3X,''DENSITY, THE CHANNEL GEOMETRIC PARAMETERS, THE WATERSHED SUBDIVISION AND'',/,&
&3X,''THE SUBCATCHMENT GEOMETRIC PARAMETERS ARE ALL A FUNCTION OF THESE TWO INPUT'',/,&
&3X,''PARAMETERS.  THE CSA AND MSCL PARAMETERS CAN BE PROVIDED AS SPATIALLY'',/,&
&3X,''VARIABLE PARAMETERS.  UP TO 5 DIFFERENT VALUES ARE ALLOWED TO GENERATE A'',/,&
&3X,''DRAINAGE NETWORK WITH SPATIALLY VARIABLE CHARACTERISTICS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE BASIC UNITS OF PROGRAM DEDNM ARE METERS FOR LENGTHS AND HECTARES'',/,&
&3X,''FOR AREAS;  ELEVATION VALUES ARE ROUNDED TO THE NEAREST DECIMETER.'',/,&
&3X,''THIS ROUNDING IS NECESSARY TO ALLOW THE TREATMENT OF FLAT AREAS WITH'',/,&
&3X,''INDETERMINATE FLOW PATHS.  THIS TREATMENT USES ELEVATION INCREMENTS'',/,&
&3X,''SMALLER THAN A DECIMETER (0.01 MILLIMETERS) TO IMPOSE LIKELY FLOW'',/,&
&3X,''GRADIENTS ON FLAT AREAS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE DEM MUST BE OF SUFFICIENT VERTICAL AND HORIZONTAL RESOLUTION TO'',/,&
&3X,''FULLY DEFINE THE DETAILS OF THE FEATURES THAT ARE TO BE EXTRACTED.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE DRAINAGE NETWORK LOCATION AND EXTENT IS DEFINED BY STRINGS OF CELLS.'',/,&
&3X,''THE WIDTH OF A CHANNEL CANNOT BE INFERRED FROM THE CELLS THAT IDENTIFY'',/,&
&3X,''THE EXISTENCE OF A CHANNEL.  ALSO, CELL VALUES REPRESENT THE'',/,&
&3X,''AVERAGE ELEVATION UNDER THE ENTIRE CELL, AND THEREFORE THEY MAY NOT'')'
WRITE(X00077,X02)
X02='(3X,''BE REPRESENTATIVE OF ACTUAL CHANNEL THALWEG ELEVATIONS.  THIS IS'',/,&
&3X,''PARTICULARLY TRUE FOR NARROW INCISED CHANNELS THAT ARE OF THE SAME'',/,&
&3X,''ORDER OF MAGNITUDE OR SMALLER THAN THE CELL SIZE.  THIS CAN LEAD TO'')'
WRITE(X00077,X02)
X02='(3X,''POOR APPROXIMATIONS OF CHANNEL SLOPE VALUES.  SIMILARLY, CHANNEL'',/,&
&3X,''SINUOSITY WITHIN A VALLEY CAN ONLY BE PROPERLY REPRODUCED IF THE CELL'',/,&
&3X,''SIZE AND ELEVATIONS CAN REFLECT THE SINUOUS PATTERN OF THE CHANNEL.'',/,&
&3X,''THE SINUOSITY OF THE VALLEY BETWEEN LATERAL RISING TERRAIN IS ALWAYS'',/,&
&3X,''REPRODUCED.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE OUTPUT OF THIS PROGRAM QUANTIFIES THE DIGITAL LANDSCAPE (INPUT DEM)'',/,&
&3X,''WHICH MAY NOT NECESSARILY BE A GOOD REPRESENTATION OF THE ACTUAL'',/,&
&3X,''LANDSCAPE.  IF THE INPUT DEM IS OF POOR QUALITY OR RESOLUTION AND DOES'',/,&
&3X,''NOT ACCURATELY REFLECT THE LANDSCAPE CONDITIONS, THEN THE OUTPUT OF THIS'',/,&
&3X,''PROGRAM CANNOT BE EXPECTED TO PROVIDE A GOOD CHARACTERIZATION OF THE '',/,&
&3X,''ACTUAL LANDSCAPE.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- LANDSCAPE DRAINAGE PATTERNS EXTRACTED BY PROGRAM DEDNM MAY NOT BE SUITABLE'',/,&
&3X,''FOR FLOW ANALYSIS IF RUNOFF GRADIENTS ARE NOT CONTROLLED BY'',/,&
&3X,''LANDSCAPE TOPOGRAPHY, AS IN THE PRESENCE OF BACKWATER OR TIDAL EFFECTS,'',/,&
&3X,''WHICH MAY HAVE WATER SURFACE GRADIENTS THAT ARE REVERSE TO THE'',/,&
&3X,''TERRAIN GRADIENTS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE WATERSHED OF INTEREST MUST BE ENTIRELY INCLUDED IN THE DEM AND SHOULD'',/,&
&3X,''NOT TOUCH THE EDGE OF THE DEM.  IF IT DOES TOUCH THE EDGE OF THE DEM OR'',/,&
&3X,''IF IT IS ADJACENT TO AND AREA OF INDETERMINATE ELEVATIONS, THEN IT IS'')'
WRITE(X00077,X02)
X02='(3X,''LIKELY THAT THE TRUE WATERSHED BOUNDARIES EXTEND BEYOND THE DEM'',/,&
&3X,''BOUNDARIES OR INTO THE AREA OF INDETERMINATE ELEVATIONS.  UNDER THESE'',/,&
&3X,''CONDITIONS THE COMPUTED WATERSHED BOUNDARIES, DRAINAGE NETWORK AND'',/,&
&3X,''SUBCATCHMENTS WOULD BE INCOMPLETE.  THE USER MAY HOWEVER OVERRIDE THE'',/,&
&3X,''PROGRAM TERMINATION AND PROCEED WITH THE LIKELY INCOMPLETE WATERSHED.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE USER MUST PROVIDE A ROW COLUMN-CELL COORDINATE THAT IDENTIFIES THE'',/,&
&3X,''WATERSHED OUTLET.  FOR NUMERICAL REASONS THE WATERSHED OUTLET CANNOT BE'',/,&
&3X,''SITUATED ON THE EDGE OF THE DEM.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM IS BASED ON THE D-8 METHOD (DETERMINISTIC 8 NEIGHBORS).'',/,&
&3X,''ALL ASSUMPTIONS AND LIMITATION OF THE D-8 METHOD APPLY (FAIRFIELD AND'',/,&
&3X,''LEYMARIE, 1991; COSTA-CABRAL AND BURGES, 1994).  PARTICULARLY, THE FLOW'',/,&
&3X,''DIRECTION AT ANY ONE CELL CAN BE IN ERROR BY AS MUCH AS 22.5 DEGREES.'',/,&
&3X,''HOWEVER, IN DISSECTED LANDSCAPES WITH CONVERGENT FLOW THE GENERAL'')'
WRITE(X00077,X02)
X02='(3X,''DRAINAGE DIRECTION OVER THE DISTANCE OF SEVERAL CELLS IS RELATIVELY WELL'',/,&
&3X,''REPRODUCED BECAUSE BEGINNING AND ENDING POINTS OF DRAINAGE PATHS ARE'',/,&
&3X,''LOCATION CONTROLLED AND NOT LIMITED TO THE 8 DIRECTIONS THAT APPLY TO A '',/,&
&3X,''SINGLE CELL.  ALSO, THE D-8 METHOD IS NOT CAPABLE OF HANDLING DIVERGENT'',/,&
&3X,''FLOW.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM IS BASED ON THE DOWNSLOPE FLOW ROUTING CONCEPT.  AS SUCH'',/,&
&3X,''UPSTREAM DRAINAGE AREAS AND DRAINAGE PATHS ARE ASSUMED TO BE ADEQUATELY'',/,&
&3X,''DESCRIBE BY DOWNSLOPE FLOW ROUTING FROM ONE CELL SPILLING ONTO THE'',/,&
&3X,''NEIGHBORING CELL LOCATED IN THE DIRECTION OF STEEPEST DESCENT.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- CALIBRATION IS NECESSARY TO OPTIMIZE THE EXTRACTED DRAINAGE NETWORK AND '',/,&
&3X,''SUBCATCHMENT PARAMETERS WITH REGARD TO FIELD CONDITIONS.  THE USER MAY'',/,&
&3X,''SPEED-UP PROGRAM EXECUTION FOR CALIBRATION PURPOSES BY CHOOSING THE'',/,&
&3X,''CALIBRATION OPTION.  HOWEVER, THE USER MUST HAVE MADE AT LEAST ONE INITIAL'',/,&
&3X,''FULL RUN OF PROGRAM DEDNM BEFORE THE CALIBRATION OPTION CAN BE EXERCISED.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM ACCEPTS ONLY RASTER CELLS THAT ARE SQUARES.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE ELEVATION VALUES IN THE DEM MUST BE POSITIVE INTEGER OR DECIMAL'',/,&
&3X,''NUMBERS; THE ELEVATION VALUE OF ZERO IS NOT ACCEPTABLE.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- IF DESIRED BY THE USER, THE INPUT DEM CAN BE AGGREGATED OR RESAMPLED INTO'',/,&
&3X,''ONE WITH A COARSER GRID DURING THE INITIAL READING OF THE DEM DATA.'',/,&
&3X,''THIS AGGREGATION OR RESAMPLING MAY BE DESIRABLE TO OVERCOME MACHINE MEMORY,'',/,&
&3X,''OPERATING SYSTEM AND EXECUTION SPEED LIMITATIONS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- WHEN AGGREGATION IS PERFORMED, THE AGGREGATION OF THE INPUT DEM INTO'',/,&
&3X,''ONE WITH A COARSER GRID IS ACCOMPLISHED BY LINEAR AVERAGING OF RASTER'',/,&
&3X,''ELEVATION VALUES OVER A SQUARE HAVING THE SAME NUMBER OF HORIZONTAL '',/,&
&3X,''AND VERTICAL RASTER CELLS (NNOD).  THE USER CANNOT AGGREGATE OVER'')'
WRITE(X00077,X02)
X02='(3X,''A DIFFERENT NUMBER OF HORIZONTAL AND VERTICAL RASTER CELLS.'',/,&
&3X,''THE MAXIMUM NUMBER FOR NNOD IS CURRENTLY SET TO 20 (A SQUARE OF'',/,&
&3X,''400 RASTER CELLS).  THIS VALUE CAN BE CHANGED WITH VERY MINOR CHANGES'',/,&
&3X,''TO THE SOFTWARE.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- WHEN RESAMPLING IS PERFORMED, THE RESAMPLING OF THE INPUT DEM INTO ONE'',/,&
&3X,''WITH A COARSER GRID IS ACCOMPLISHED BY SELECTING THE DEM ELEVATION VALUE'',/,&
&3X,''OF THE CENTER CELL OF THE RESAMPLING BOX (NNOD*NNOD).  IF THIS ELEVATION'',/,&
&3X,''IS INDETERMINATE, THEN THE DEM ELEVATION VALUE OF THE CELL WHICH IS '',/,&
&3X,''CLOSEST TO THE CENTER AND WHICH HAS A VALID DEM ELEVATION VALUE IS PICKED'',/,&
&3X,''AS THE RESAMPLED VALUE.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- IF AGGREGATION OR RESAMPLING IS PERFORMED ON THE INPUT DEM ELEVATIONS,''/,&
&3X,''THEN A CORRESPONDING AGGREGATION OR RESAMPLING IS PERFORMED ON THE'',/,&
&3X,''INPUT CODES FOR THE CSA AND MSCL PARAMETERS.  AGGREGATION IS ACCOMPLISHED'',/,&
&3X,''BY RETAINING THE MOST FREQUENTLY OCCURRING CODE VALUE IN THE AGGREGATION'',/,&
&3X,''WINDOW, AND RESAMPLING IS ACCOMPLISHED BY SELECTING THE CODE VALUE AT'',/,&
&3X,''THE CENTER OR CLOSEST TO THE CENTER OF THE RESAMPLING WINDOW.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- IF DESIRED BY THE USER, THE ENTERED ELEVATION DATA CAN BE SMOOTHED'',/,&
&3X,''USING A WEIGHTED, SINGLE OR MULTIPLE PASS, 3 BY 3 BOX-CAR FILTER.'',/,&
&3X,''THE CELL WEIGHTING AND NUMBER OF SMOOTHING PASSES IS USER PROVIDED.'',/,&
&3X,''AFTER SMOOTHING THE ELEVATION DATA IS ROUNDED TO THE NEAREST DECIMETER.'',/,&
&3X,''THIS ROUNDING IS NECESSARY TO ALLOW THE TREATMENT OF FLAT AREAS WITH'',/,&
&3X,''INDETERMINATE FLOW PATHS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- DEPRESSIONS (PITS) IN THE DEM ELEVATION DATA ARE ASSUMED TO BE SPURIOUS.'',/,&
&3X,''DEPRESSIONS ARE CLASSIFIED AS EITHER SINK DEPRESSIONS OR IMPOUNDMENT'',/,&
&3X,''DEPRESSIONS.  IMPOUNDMENT DEPRESSIONS ARE CAUSED BY A NARROW SWELL OR A'',/,&
&3X,''LOCAL BLOCKAGE ALONG A FLOW PATH SIMILAR TO A DAM ACROSS A STREAM.  SINK'',/,&
&3X,''DEPRESSIONS ARE SURROUNDED BY A SIGNIFICANT WIDTH OF HIGHER ELEVATIONS.'')'
X02='(3X,''BOTH TYPES OF DEPRESSIONS ARE ANALYZED, FILLED AND TREATED AS FLAT'',/,&
&3X,''SURFACES.  IF DESIRED BY THE USER, THE OUTLET OF IMPOUNDMENT DEPRESSIONS'',/,&
&3X,''CAN BE ANALYZED AND MODIFIED IF THE NARROW SWELL OR LOCAL BLOCKAGE DOES'',/,&
&3X,''NOT EXCEED TWO CELLS IN WIDTH.  UNDER THESE CONDITIONS THE SWELL '',/,&
&3X,''OR BLOCKAGE CAN BE LOWERED TO THE LEVEL OF THE HIGHEST OF THE TWO ADJACENT'',/,&
&3X,''CELL ELEVATIONS THAT DEFINE THE SWELL OR BLOCKAGE.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- FLAT AREAS IN THE DEM ELEVATION DATA (INCLUDING FLAT AREAS AS A RESULT OF'',/,&
&3X,''DEPRESSION FILLING) ARE MODIFIED TO PRODUCE THE MOST LIKELY DRAINAGE PATHS'',/,&
&3X,''AND TO PRODUCE A FULLY CONNECTED DRAINAGE NETWORK.  THE MODIFICATIONS ARE'',/,&
&3X,''A FUNCTION OF THE FALLING AND RISING TERRAIN THAT SURROUNDS THE FLAT AREA.'')'
WRITE(X00077,X02)
X02='(3X,''THE RELIEF MODIFICATION USES INCREMENTAL ELEVATIONS OF 2/100,000 OF A'',/,&
&3X,''DEM ELEVATION UNIT (1 METER) TO BUILD GRADIENTS OVER FLAT SURFACES THAT'',/,&
&3X,''DRAIN FLOW AWAY FROM RISING TERRAIN AND TOWARDS THE NEAREST OUTLET OF'',/,&
&3X,''THE FLAT SURFACE.  THIS ALSO PROMOTES FLOW CONVERGENCE.  IN MOST CASES'')'
WRITE(X00077,X02)
X02='(3X,''THE FINAL ELEVATION INCREMENTATION IS NOT EXPECTED TO ALTER THE ORIGINAL'',/,&
&3X,''TOPOGRAPHY BY A SIGNIFICANT AMOUNT, YET IT IS SUFFICIENT TO REMOVE'',/,&
&3X,''THE DRAINAGE INDETERMINACY OF FLAT AREAS.  FLAT AREAS THAT ARE OVER'',/,&
&3X,''1500 CELLS LONG MAY BE EXCESSIVELY LARGE AND MAY EXCEED THE CAPABILITIES'',/,&
&3X,''OF THE ALGORITHM.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE EDGE OF THE DEM IS CONSIDERED A SPECIAL BOUNDARY.  RASTER CELLS ON'',/,&
&3X,''THE EDGE OF THE DEM THAT DO NOT HAVE ANY NEIGHBOR AT A LOWER ELEVATION'',/,&
&3X,''ARE ASSUMED TO HAVE A FLOW VECTOR POINTING OFF THE DEM.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE DEPRESSION FILLED AND RELIEF CORRECTED ELEVATIONS, THE FLOW VECTORS,'',/,&
&3X,''FLOW PATH CODES, THE UPSTREAM AREAS AND THE DRAINAGE NETWORK ARE'',/,&
&3X,''COMPUTED FOR THE ENTIRE DEM RASTER.  THE FOLLOWING RASTERS AND PARAMETERS'',/,&
&3X,''ARE COMPUTED FOR THE DRAINAGE AREA UPSTREAM OF A USER SPECIFIED POINT'')'
WRITE(X00077,X02)
X02='(3X,''(USUALLY THE WATERSHED OUTLET POINT): THE FULLY CONNECTED DRAINAGE'',/,&
&3X,''NETWORK, THE WATERSHED SUBDIVISION, THE SUBCATCHMENTS AND ALL'',/,&
&3X,''CORRESPONDING NETWORK, CHANNEL AND SUBCATCHMENT PARAMETERS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM DOES NOT HAVE GIS DISPLAY CAPABILITIES.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- PROGRAM DEDNM IS AN INTERACTIVE PROGRAM WRITTEN IN FORTRAN 90.  THE'',/,&
&3X,''INTERACTIVE PORTION OF THE PROGRAM REQUIRES THE USER TO DEFINE THE EXACT'',/,&
&3X,''LOCATION OF THE WATERSHED OUTLET GIVEN A DISPLAY OF THE COMPUTED'',/,&
&3X,''CHANNEL NETWORK.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE SIZE OF THE DEM THAT CAN BE PROCESSED BY PROGRAM DEDNM IS LIMITED BY'',/,&
&3X,''THE ACCESSIBLE MACHINE MEMORY AND OPERATING SYSTEM LIMITATIONS '',/,&
&3X,''UNDER WHICH PROGRAM DEDNM IS COMPILED AND EXECUTED.  THE SIZE OF THE'',/,&
&3X,''DEM (IN NUMBER OF ROWS AND COLUMNS) IS SET DYNAMICALLY BY THE PROGRAM AS'',/,&
&3X,''A FUNCTION OF USER INPUT OF NUMBER OF ROWS AND COLUMNS FOR THE DEM.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE SIZE OF THE INTEGER ELEVATION VALUES OF THE DEM MUST BE COMPATIBLE'',/,&
&3X,''WITH THE COMPILER LIMITATIONS REGARDING THE REPRESENTATION AND'',/,&
&3X,''PROCESSING OF INTEGER VALUES.  CONSIDERATION SHOULD BE GIVEN TO THE'',/,&
&3X,''FACT THAT, FOR COMPUTATIONAL PURPOSES, THE INPUT ELEVATION VALUES'')'
WRITE(X00077,X02)
X02='(3X,''ARE INTERNALLY MULTIPLIED BY 100,000 (TO ALLOW THE TREATMENT OF LOW'',/,&
&3X,''RELIEF TERRAIN).  THEREFORE, A 32 BIT INTEGER (INTEGER*4) REPRESENTATION'',/,&
&3X,''MUST BE USED.  THE 32 BIT INTEGER REPRESENTATION CAN PROCESS ELEVATION'',/,&
&3X,''VALUES BETWEEN 1.0 AND +9,999.0 METERS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- THE SIZE OF THE WATERSHED AREA, IN NUMBER OF CELLS, MUST BE WITHIN'',/,&
&3X,''THE RANGE OF VALUES THAT CAN BE REPRESENTED BY AN INTEGER*4 NUMBER'',/,&
&3X,''(2,147,483,648).'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- SOME COMPILERS TAKE ADVANTAGE OF THE GREATER PRECISION OF CURRENT'',/,&
&3X,''VARIABLE VALUES IN A REGISTER AS OPPOSED TO THE LESSER PRECISION OF'',/,&
&3X,''THE VALUE WHEN RELOADED FROM MEMORY.  A DIFFERENCE IN PRECISION MAY'',/,&
&3X,''OCCUR BECAUSE THE PRECISION OF THE DATUM IS GREATER IN A REGISTER'')'
WRITE(X00077,X02)
X02='(3X,''THAN IN MEMORY.  UNDER CERTAIN CONDITIONS PROGRAM DEDNM IS SENSITIVE'',/,&
&3X,''TO DIFFERENCES IN PRECISION OF COMPUTED VARIABLE VALUES WHEN THEY ARE'',/,&
&3X,''USED DIRECTLY FROM THE REGISTER AS OPPOSED TO BEING RELOADED FROM MEMORY.'',/,&
&3X,''TO ENSURE CONSISTENT RESULTS THE USER SHOULD SET THE SWITCH OF THE'')'
WRITE(X00077,X02)
X02='(3X,''COMPILER TO CONSISTENTLY CHOOSE THE MEMORY REFERENCE PRECISION FOR'',/,&
&3X,''NON-INTEGER OPERATIONS, IF AVAILABLE.  IF NOT AVAILABLE IT IS POSSIBLE'',/,&
&3X,''THAT THE VERIFICATION TESTS PRODUCE SLIGHTLY DIFFERENT RESULTS DUE TO'',/,&
&3X,''ROUNDING ERROR.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
X02='(1X,''- SOME OPERATIONS IN TOPAZ ARE PERFORMED AT THE DOUBLE PRECISION LEVEL (SUCH'',/,&
&3X,''AS SUMMATIONS OF SMALL AND LARGE VALUES).  AFTER COMPLETION OF THE '',/,&
&3X,''OPERATIONS THE RESULT IS CONVERTED BACK TO SINGLE PRECISION.  THE'',/,&
&3X,''INTRINSIC FUNCTION FOR BACK CONVERSION TRUNCATES THE DOUBLE PRECISION'')'
WRITE(X00077,X02)
X02='(3X,''TO A SINGLE PRECISION NUMBER.  IT DOES NOT ROUND THE NUMBER!'',/,&
&3X,''AS A RESULT, DOUBLE PRECISION NUMBERS SUCH AS 4.44999999 ARE TRUNCATED'',/,&
&3X,''TO SINGLE PRECISION VALUES OF 4.449999 EVEN THOUGH IT SHOULD HAVE'',/,&
&3X,''BEEN ROUNDED TO 4.450000.  THIS MAY, UNDER CERTAIN CIRCUMSTANCES, LEAD'',/,&
&3X,''TO A SLIGHT ROUNDING ERROR AS THE VALUE IS PRINTED WITH A LIMITED'',/,&
&3X,''NUMBER OF SIGNIFICANT DIGITS.'')'
WRITE(X00077,X02)
WRITE(X00077,X053)
WRITE(X00077,X053)
END SUBROUTINE CAPLIM
SUBROUTINE HEADER
USE STSYS1,ONLY:X00077
USE DTCNT1,ONLY:X0006,X0009,X0010,X0012,HEADE,X0015
IMPLICIT NONE
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' ', X071=' '
X053='(A)'
X051='(1X)'
X071='(1X,/,1X)'
X0006(2:78)=&
'TOPAZ SOFTWARE : TOPAZ PARAMETERIZATION SOFTWARE SYSTEM                      '
X0015(2:78)=&
'                 VERSION 3.12, AUGUST 1999'
X0009(2:78)=&
'PROGRAM DEDNM : DIGITAL ELEVATION DRAINAGE NETWORK MODEL PROGRAM             '
X0010(2:78)=&
'                VERSION 3.10, APRIL 1999'
X0012(2:78)=&
'J. GARBRECHT, USDA-ARS, EL RENO, OKLAHOMA, USA.                              '
HEADE(2:78)=&
'L. MARTZ, UNIVERSITY OF SASKATCHEWAN, SASKATOON, CANADA.                     '
WRITE(X00077,X051)
WRITE(X00077,X053)X0006
WRITE(X00077,X053)X0015
WRITE(X00077,X053)X0009
WRITE(X00077,X053)X0010
WRITE(X00077,X051)
WRITE(X00077,X053)X0012
WRITE(X00077,X053)HEADE
WRITE(X00077,X071)
WRITE(*,X051)
WRITE(*,X053)X0006
WRITE(*,X053)X0015
WRITE(*,X053)X0009
WRITE(*,X053)X0010
WRITE(*,X051)
WRITE(*,X053)X0012
WRITE(*,X053)HEADE
WRITE(*,X071)
X02='(1X,''DISCLAIMER'')'
WRITE(X00077,X02)
WRITE(*,X02)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''THIS PROGRAM AND ITS SUBROUTINES ARE ACCEPTED AND USED BY THE RECIPIENT UPON'',/,&
&1X,''THE EXPRESS UNDERSTANDING THAT THE DEVELOPERS MAKE NO WARRANTIES, EXPRESSED'',/,&
&1X,''OR IMPLIED, CONCERNING THE ACCURACY, COMPLETENESS, RELIABILITY OR'',/,&
&1X,''SUITABILITY FOR ANY ONE PURPOSE, AND THAT THE DEVELOPERS SHALL BE UNDER NO'',/,&
&1X,''LIABILITY TO ANY PERSON BY REASON OF ANY USE MADE THEREOF.'')'
WRITE(X00077,X02)
WRITE(*,X02)
WRITE(X00077,X051)
WRITE(*,X051)
X02='(1X,''THE SUBROUTINES IN THIS PROGRAM CANNOT BE LIFTED, EXTRACTED OR TRANSFERRED'',/,&
&1X,''OUT OF THIS PROGRAM FOR USE WITH OTHER PROGRAMS OR OTHER PURPOSES BECAUSE'',/,&
&1X,''INPUT VARIABLES INTO SUBROUTINES MUST HAVE BEEN PROCESSED AND ASSIGNED'',/,&
&1X,''SPECIFIC VALUES BY PRECEDING SUBROUTINES THAT REFLECT PROGRAM, CODE AND'')'
WRITE(X00077,X02)
X02='(1X,''TERRAIN SPECIFIC PARTICULARITIES.  THE USE OF A SUBROUTINE FOR OTHER PURPOSES'',/,&
&1X,''THAN IN THIS PROGRAM MAY PRODUCE, AT BEST, INEXECUTABLE CODE, OR, AT WORST,'',/,&
&1X,''ERRONEOUS RESULTS THAT GO UNRECOGNIZED.'')'
WRITE(X00077,X02)
WRITE(X00077,X051)
X02=' (1X,''THE AUTHORS AND DEVELOPERS OF THIS PROGRAM AND ITS SUBROUTINES SHALL BE'',/,&
&1X,''ACKNOWLEDGED WHEN THE CODE, THE MODEL AND/OR THE NUMERICAL SOLUTION'',/,&
&1X,''TECHNIQUES USED HEREIN ARE DIRECTLY APPLIED IN CONJUNCTION WITH ANOTHER'',/,&
&1X,''CODE, OR DESCRIBED AND/OR REFERRED TO IN A PUBLICATION OR PRESENTATION.'')'
WRITE(X00077,X02)
WRITE(X00077,X051)
WRITE(*,X051)
END SUBROUTINE HEADER
SUBROUTINE INPCOD
USE STSYS1,ONLY:X36,X35,X00070,X00071,X34,X00075,X00077,IOS
USE DTCNT1,ONLY:X15,X057,X056,X023,X025,X0024,X014,X042,X0017,&
X00050,X00046
USE DTRST1,ONLY:X00061,X08
USE GENIO1,ONLY:TESTIO
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X061=X00070,X062=X00070,X226=X00070,X97=X00070,MV=X00070
INTEGER(KIND=X36)::X0062=X00070,X00067=X00070,X00122=X00070,X0103=X00070
INTEGER(KIND=X36)::X060=X00070,X00453=X00070,X00095=X00070
INTEGER(KIND=X35)::I=X00071,J=X00071,X0002=X00071,X272=X00071
INTEGER(KIND=X35)::IR=X00071,IC=X00071,K=X00071,L=X00071,M=X00071
INTEGER(KIND=X35)::IB=X00071,IE=X00071,JB=X00071,JE=X00071
INTEGER(KIND=X35)::X41=X00071,X079=X00071,X0073=X00071
INTEGER(KIND=X36),DIMENSION(1:5)::X059=(/(X00070,I=1,5)/)
INTEGER(KIND=X36),DIMENSION(:,:),ALLOCATABLE::IA
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' ', X071=' ', X072=' ', X073=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE INPCOD; MODULE DEDNM2 (M_DEDNM2.F90).'',/,&
&1X,''INPUT FILE NTGCOD.INP.'')'
X051='(1X,''INDETERMINATE CODE VALUES (0) WERE ASSIGNED TO RASTER CELLS WITH VALID'',/,&
&1X,''ELEVATION VALUES.  THE USER MUST ASSIGN A VALID CODE VALUE TO ALL'',/,&
&1X,''CELLS THAT HAVE A VALID ELEVATION VALUE.'')'
X071='(1X,''INPUT DATA ERROR. ROW = '',I5,''; COLUMN = '',I5,'' .'',/,&
&1X,''CODE VALUE OUT OF RANGE = '',I3,'' .'',/,&
&1X,''THE INPUT CODE VALUES MUST BE BETWEEN 0 AND 5, INCLUSIVE.'')'
X072='(1X,''NO CODE VALUE WAS IDENTIFIABLE.  LOGIC ERROR.'')'
X073='(1X,''A VALID CSA AND/OR MSCL VALUE IS NOT SUPPLIED FOR THE FOLLOWING'',/,&
&1X,''CSA-MSCL CODE THAT IS INPUT THROUGH FILE NTGCOD.INP:'',1X,I2,/,&
&1X,''EVERY CODE SUPPLIED IN FILE NTGCOD.INP MUST HAVE A CORRESPONDING'',/,&
&1X,''VALID CSA AND MSCL VALUE.'')'
IF(X042(5).EQ.0)THEN
X00061=1
ELSE
X01='NTGCOD.INP'
OPEN(UNIT=X00075,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00075,X01,X0002,X00067)
X061=5
X062=0
IF(X042(1).EQ.0)THEN
DO IR=1,X023
DO IC=1,X025
READ(X00075,*,IOSTAT=IOS)X226
X00067=2
X01='NTGCOD.INP'
CALL TESTIO(X00075,X01,IR,X00067)
IF((X226.GE.X062).AND.(X226.LE.X061))THEN
X00061(IR,IC)=X226
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X071)IR,IC,X226
WRITE(*,X071)IR,IC,X226
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF((X226.EQ.0).AND.(X08(IR,IC).NE.0))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
END DO
ELSE IF(X042(1).EQ.1)THEN
WRITE(X00077,'(3X,''=== ALLOCATING IA ARRAY.'')')
ALLOCATE(IA(20,X15),STAT=IOS)
X00067=6
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
X0073=INT(X014,KIND=X35)*INT(X014,KIND=X35)
IR1:DO IR=1,X023
DO L=1,X014
DO IC=1,X0024
READ(X00075,*,IOSTAT=IOS)X226
X00067=2
X01='NTGCOD.INP'
CALL TESTIO(X00075,X01,IR,X00067)
IF((X226.GE.X062).AND.(X226.LE.X061))THEN
IA(L,IC)=X226
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X071)((IR-1)*X014+L),IC,X226
WRITE(*,X071)((IR-1)*X014+L),IC,X226
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
END DO
IC1:DO IC=1,X025
X41=(IC-1)*INT(X014,KIND=X35)
X079=X41+1
X97=1
RPT1:DO
DO K=1,X057
X059(K)=0
END DO
DO L=1,X014
DO K=X079,X41+X014
DO M=X97,X057
MV=M-1
IF(IA(L,K).EQ.MV)THEN
X059(M)=X059(M)+1
EXIT
END IF
END DO
END DO
END DO
X0103=0
X060=0
DO M=1,X057
IF(X059(M).GT.X0103)THEN
X0103=X059(M)
X060=M
END IF
END DO
IF(X060.EQ.0)THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
ELSE IF(X060.EQ.1)THEN
IF(X08(IR,IC).EQ.0)THEN
X00061(IR,IC)=X060-1
CYCLE IC1
ELSE
IF(X0103.EQ.X0073)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''INDETERMINATE CODE VALUES (0) WERE ASSIGNED TO RASTER CELLS WITH VALID'',/,&
&1X,''ELEVATION VALUES.  THE USER MUST ASSIGN A VALID CODE VALUE TO ALL'',/,&
&1X,''CELLS THAT HAVE A VALID ELEVATION VALUE.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
ELSE
IF(X97.EQ.1)THEN
X97=2
CYCLE RPT1
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
END IF
END IF
ELSE IF((X060.GE.2).AND.(X060.LE.6))THEN
X00061(IR,IC)=X060-1
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''AN UNRECOGNIZED CODE VALUES WAS ENCOUNTERED.'',/,&
&1X,''A LOGIC ERROR HAS OCCURED.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
EXIT RPT1
END DO RPT1
END DO IC1
END DO IR1
WRITE(X00077,'(3X,''=== DEALLOCATING IA ARRAY.'')')
DEALLOCATE(IA,STAT=IOS)
X00067=7
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
ELSE IF(X042(1).EQ.2)THEN
WRITE(X00077,'(3X,''=== ALLOCATING IA ARRAY.'')')
ALLOCATE(IA(20,X15),STAT=IOS)
X00067=6
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
X0073=INT(X014,KIND=X35)*INT(X014,KIND=X35)
X00122=INT((REAL(X014,KIND=X34)/2.0),KIND=X36)
X00453=X00122+1
IR2:DO IR=1,X023
DO L=1,X014
DO IC=1,X0024
READ(X00075,*,IOSTAT=IOS)X226
X00067=2
X01='NTGCOD.INP'
CALL TESTIO(X00075,X01,IR,X00067)
IF((X226.GE.X062).AND.(X226.LE.X061))THEN
IA(L,IC)=X226
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X071)((IR-1)*X014+L),IC,X226
WRITE(*,X071)((IR-1)*X014+L),IC,X226
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
END DO
IC2:DO IC=1,X025
X41=(IC-1)*X014
X079=X41+1
X272=0
DO L=1,X014
DO K=X079,X41+X014
IF(IA(L,K).EQ.0)X272=X272+1
END DO
END DO
IF(MOD(X014,2_X36).NE.0)THEN
IF(IA(X00453,X41+X00453).NE.0)THEN
X00061(IR,IC)=IA(X00453,X41+X00453)
CYCLE IC2
ELSE IF(IA(X00453,X41+X00453).EQ.0)THEN
IF(X08(IR,IC).EQ.0)THEN
X00061(IR,IC)= 0
CYCLE IC2
ELSE
IF(X272.GE.(INT(X014,KIND=X35)*INT(X014,KIND=X35)))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X051)
WRITE(*,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END IF
END IF
END IF
IF(MOD(X014,2_X36).EQ.0)THEN
X0062=1
X00095=1
ELSE
X0062=2
X00095=2
END IF
RPT2:DO
IB=X00122-X0062+X00095
IE=X00122+X0062
JB=X41+X00122-X0062+X00095
JE=X41+X00122+X0062
IF((IB.LT.1).OR.(IE.GT.X014).OR.(JB.LT.1).OR.(JE.GT.X0024))THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE COUNTERS FOR THE RESAMPLING WINDOW ARE ILLOGICAL.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
DO I=IB,IE
DO J=JB,JE
IF(IA(I,J).NE.0)THEN
X00061(IR,IC)=IA(I,J)
CYCLE IC2
END IF
END DO
END DO
X0062=X0062+1
CYCLE RPT2
EXIT RPT2
END DO RPT2
END DO IC2
END DO IR2
WRITE(X00077,'(3X,''=== DEALLOCATING IA ARRAY.'')')
DEALLOCATE(IA,STAT=IOS)
X00067=7
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
END IF
DO IR=1,X023
DO IC=1,X025
IF(X00061(IR,IC).GT.0)THEN
IF((X00046(X00061(IR,IC)).EQ.-1).OR.(X00050(X00061(IR,IC)).LT.0))THEN
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X073)X00061(IR,IC)
WRITE(*,X073)X00061(IR,IC)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
END IF
END DO
END DO
CLOSE(UNIT=X00075,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00075,X01,X0002,X00067)
END IF
END SUBROUTINE INPCOD
SUBROUTINE INDEM
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,&
X34,X33,X00072,X00082,X00077,X00075,IOS
USE DTCNT1,ONLY:X0029,X0030,X15,X042,X006,X0017,X014,X023,X025,&
X0025,X0024,X0023
USE DTRST1,ONLY:X03
USE GENIO1,ONLY:TESTIO
IMPLICIT NONE
INTEGER::X00069=X00070
INTEGER(KIND=X36)::X00067=X00070,X0062=X00070,X00095=X00070
INTEGER(KIND=X35)::X0002=X00071,IR=X00071,IC=X00071,NR=X00071,NC=X00071,L=X00071,K=X00071
INTEGER(KIND=X35)::X41=X00071,X079=X00071
INTEGER(KIND=X35)::IB=X00071,IE=X00071,JB=X00071,JE=X00071,I=X00071,J=X00071
INTEGER(KIND=X35)::X0073=X00071,X00113=X00071,X00122=X00071,X00453=X00071
INTEGER(KIND=X35)::X063=X00071,X0217=X00071
INTEGER(KIND=X32)::X061=X00081,X062=X00081,X226=X00081
INTEGER(KIND=X32),DIMENSION(:,:),ALLOCATABLE::IA
REAL(KIND=X34)::X43=X00072,X064=X00072
REAL(KIND=X33)::X42=X00082,VX43=X00082,VX080=X00082,VX081=X00082
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' ', X071=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE INDEM; MODULE DEDNM2 (M_DEDNM2.F90).'',/,&
&1X,''INPUT FILE DEDNM.INP.'')'
X051='(1X,''THE INPUT DEM ELEVATION VALUES MUST BE GREATER THAN 1.0,'',/,&
&1X,''AND SMALLER THAN 9999.0 METERS.'',/,&
&1X,''THE VALUE READ WAS : '',F6.1,'' .'',/,&
&1X,''ERROR AT ROW = '',I5,''; COLUMN = '',I5,'' .'')'
X071='(1X,''INPUT DATA ERROR. ROW = '',I5,''; COLUMN = '',I5,'' .'',/,&
&1X,''ELEVATION VALUE OUT OF RANGE = '',F6.1,'' .'',/,&
&1X,''THE INPUT DEM ELEVATION VALUES MUST BE GREATER THAN: '',F6.1,/,&
&1X,''AND SMALLER THAN: '',F6.1,'' METERS,'',/,&
&1X,''AS ENTERED FOR MINIMUM AND MAXIMUM ELEVATION VALUE IN FILE DNMCNT.INP.'')'
X01='DEDNM.INP'
OPEN(UNIT=X00075,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00075,X01,X0002,X00067)
X0023=0
X061=NINT((X0030*10.0),KIND=X32)*10000
X062=NINT((X0029*10.0),KIND=X32)*10000
IF(X042(1).EQ.0)THEN
X023=X0025
X025=X0024
DO IR=1,X023
DO IC=1,X025
READ(X00075,*,IOSTAT=IOS)X43
X00067=2
X01='DEDNM.INP'
CALL TESTIO(X00075,X01,IR,X00067)
X226=NINT((X43*10.0),KIND=X32)*10000
IF((X226.GE.X062).AND.(X226.LE.X061))THEN
X03(IR,IC)=X226
ELSE IF(X226.EQ.X006)THEN
X03(IR,IC)=X0017
X0023=1
ELSE IF((X226.LT.100000).OR.(X226.GT.999900000))THEN
WRITE(X00077,X053)
WRITE(*,X053)
VX43=REAL((X226),KIND=X33)/100000.
WRITE(X00077,X051)VX43,IR,IC
WRITE(*,X051)VX43,IR,IC
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
VX43=REAL((X226),KIND=X33)/100000.
VX080=REAL((X062),KIND=X33)/100000.
VX081=REAL((X061),KIND=X33)/100000.
WRITE(X00077,X071)IR,IC,VX43,VX080,VX081
WRITE(*,X071)IR,IC,VX43,VX080,VX081
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
END DO
ELSE IF(X042(1).EQ.1)THEN
WRITE(X00077,'(3X,''=== ALLOCATING IA ARRAY.'')')
ALLOCATE(IA(20,X15),STAT=IOS)
X00067=6
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
NR=X0025/X014
NC=X0024/X014
X0073=X014*X014
X00113=INT((REAL(X0073,KIND=X34)/2.0),KIND=X35)
DO_X0075:DO IR=1,NR
DO L=1,X014
DO IC=1,X0024
READ(X00075,*,IOSTAT=IOS)X43
X00067=2
X01='DEDNM.INP'
CALL TESTIO(X00075,X01,IR,X00067)
X226=NINT((X43*10.0),KIND=X32)*10000
IF((X226.GE.X062).AND.(X226.LE.X061))THEN
IA(L,IC)=X226
ELSE IF(X226.EQ.X006)THEN
IA(L,IC)=X0017
ELSE IF((X226.LE.100000).OR.(X226.GT.999900000))THEN
WRITE(X00077,X053)
WRITE(*,X053)
VX43=REAL((X226),KIND=X33)/100000.
X0217=(IR-1)*X014+L
WRITE(X00077,X051)VX43,X0217,IC
WRITE(*,X051)VX43,X0217,IC
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
VX43=REAL((X226),KIND=X33)/100000.
VX080=REAL((X062),KIND=X33)/100000.
VX081=REAL((X061),KIND=X33)/100000.
X0217=(IR-1)*X014+L
WRITE(X00077,X071)X0217,IC,VX43,VX080,VX081
WRITE(*,X071)X0217,IC,VX43,VX080,VX081
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
END DO
DO IC=1,NC
X41=(IC-1)*X014
X079=X41+1
X063=0
X42=0.0
DO L=1,X014
DO K=X079,X41+X014
IF(IA(L,K).EQ.X0017)THEN
X063=X063+1
ELSE
X42=X42+REAL((IA(L,K)),KIND=X33)
END IF
END DO
END DO
IF(X063.GT.X00113)THEN
X03(IR,IC)=X0017
X0023=1
ELSE
X064=REAL((X0073-X063),KIND=X34)
X03(IR,IC)=NINT((X42/REAL(X064,KIND=X33)),KIND=X32)
END IF
END DO
END DO DO_X0075
X023=NR
X025=NC
DO K=1,X023
DO L=1,X025
X03(K,L)=NINT((REAL(X03(K,L),KIND=X33)/10000.),KIND=X32)*10000
END DO
END DO
WRITE(X00077,'(3X,''=== DEALLOCATING IA ARRAY.'')')
DEALLOCATE(IA,STAT=IOS)
X00067=7
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
ELSE IF(X042(1).EQ.2)THEN
WRITE(X00077,'(3X,''=== ALLOCATING IA ARRAY.'')')
ALLOCATE(IA(20,X15),STAT=IOS)
X00067=6
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
NR=X0025/X014
NC=X0024/X014
X0073=X014*X014
X00113=INT((REAL(X0073,KIND=X34)/2.0),KIND=X35)
X00122=INT((REAL(X014,KIND=X34)/2.0),KIND=X35)
X00453=X00122+1
DO_X00114:DO IR=1,NR
DO L=1,X014
DO IC=1,X0024
READ(X00075,*,IOSTAT=IOS)X43
X00067=2
X01='DEDNM.INP'
CALL TESTIO(X00075,X01,IR,X00067)
X226=NINT((X43*10.0),KIND=X32)*10000
IF((X226.GE.X062).AND.(X226.LE.X061))THEN
IA(L,IC)=X226
ELSE IF(X226.EQ.X006)THEN
IA(L,IC)=X0017
ELSE IF((X226.LE.100000).OR.(X226.GT.999900000))THEN
WRITE(X00077,X053)
WRITE(*,X053)
VX43=REAL((X226),KIND=X33)/100000.
X0217=(IR-1)*X014+L
WRITE(X00077,X051)VX43,X0217,IC
WRITE(*,X051)VX43,X0217,IC
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
VX43=REAL((X226),KIND=X33)/100000.
VX080=REAL((X062),KIND=X33)/100000.
VX081=REAL((X061),KIND=X33)/100000.
X0217=(IR-1)*X014+L
WRITE(X00077,X071)X0217,IC,VX43,VX080,VX081
WRITE(*,X071)X0217,IC,VX43,VX080,VX081
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
END DO
DO_X0076:DO IC=1,NC
X41=(IC-1)*X014
X079=X41+1
X063=0
DO L=1,X014
DO K=X079,X41+X014
IF(IA(L,K).EQ.X0017)X063=X063+1
END DO
END DO
IF(X063.GT.(X00113))THEN
X03(IR,IC)=X0017
X0023=1
CYCLE DO_X0076
END IF
IF(MOD(X014,2_X36).NE.0)THEN
IF(IA(X00453,X41+X00453).NE.X0017)THEN
X03(IR,IC)=IA(X00453,X41+X00453)
CYCLE DO_X0076
END IF
END IF
IF(MOD(X014,2_X36).EQ.0)THEN
X0062=1
X00095=1
ELSE
X0062=2
X00095=2
END IF
DO
IB=X00122-X0062+X00095
IF(IB.LT.1)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE COUNTERS FOR THE RESAMPLING WINDOW ARE ILLOGICAL.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.'
END IF
IE=X00122+X0062
IF(IE.GT.X014)THEN
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''THE COUNTERS FOR THE RESAMPLING WINDOW ARE ILLOGICAL.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.'
END IF
JB=X41+X00122-X0062+X00095
JE=X41+X00122+X0062
DO I=IB,IE
DO J=JB,JE
IF(IA(I,J).NE.X0017)THEN
X03(IR,IC)=IA(I,J)
CYCLE DO_X0076
END IF
END DO
END DO
X0062=X0062+1
END DO
END DO DO_X0076
END DO DO_X00114
X023=NR
X025=NC
WRITE(X00077,'(3X,''=== DEALLOCATING IA ARRAY.'')')
DEALLOCATE(IA,STAT=IOS)
X00067=7
X01='IA'
CALL TESTIO(X00069,X01,X0002,X00067)
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''PROGRAM LOGIC ERROR.'',/,&
&1X,''AN UNACCEPTABLE VALUE FOR IOPT(1) WAS ENCOUNTERED.'',/,&
&1X,''VALUE IS:'',1X,I8)'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.'
END IF
X02='(5X,''FINAL NUMBER OF ROWS AND COLUMNS OF THE RASTER ARRAYS:'',/,&
&15X,''ROW = '',I6,3X,''COLUMN = '',I6,/,&
&5X,''NOTE: IF AGGREGATION OR RESAMPLING WAS SELECTED THE NUMBERS REPRESENT'',/,&
&11X,''      THE NEW SIZE OF THE AGGREGATED OR RESAMPLED RASTER ARRAYS.'')'
WRITE(X00077,X02)X023,X025
CLOSE(UNIT=X00075,STATUS='KEEP', IOSTAT=IOS)
X00067=5
X01='DEDNM.INP'
CALL TESTIO(X00075,X01,X0002,X00067)
END SUBROUTINE INDEM
SUBROUTINE INCNT
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X34,&
X00077,X00076,IOS
USE DTCNT1,ONLY:X00051,X00052,X00054,&
X00042,X00043,X014,X042,X0014,X0025,X0024,&
X09,X10,X00046,X001,X00050,X0031,X005,&
X00039,X010,X0017,X015,X12,X13,X14,X039,X041,&
X0029,X0030,X006,X00045,X00041,X0026,X0027,&
X0028,X15,X17,X16,X00047,X00083,X009,X008,X057
USE GENIO1,ONLY:READCM,TESTIO
IMPLICIT NONE
INTEGER::X00068=X00070,X04=X00070
INTEGER(KIND=X36)::X00067=X00070,K=X00070,X0003=X00070,X0001=X00070
INTEGER(KIND=X36)::X00102=X00070,X00103=X00070
INTEGER(KIND=X36)::IAFLAG=X00070,IDFLAG=X00070
INTEGER(KIND=X35)::I=X00071
INTEGER(KIND=X35)::X0042=X00071,X0040=X00071,X0002=X00071,X00069=X00071
CHARACTER(LEN=20)::X0063=' '
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' ', X071=' ', X072=' ', X073=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE INCNT; MODULE DEDNM2 (M_DEDNM2.F90).'')'
X051='(1X,''AN ERROR IN INPUT DATA WAS DETECTED.'',/,&
&1X,''RECORD NUMBER:'',1X,I5,/,&
&1X,''ERROR IN INPUT FILE DNMCNT.INP.'')'
X071='(1X,''READ STATEMENT ERROR OF UNSPECIFIED NATURE.'',/,&
&1X,''USER PROVIDED INPUT DATA COULD NOT BE READ.'',/,&
&1X,''THE USER MUST ENTER A VALUE OF EITHER 0 OR 1.'')'
X072='(1X,''INTERACTIVE INPUT DOES NOT CONFORM TO SPECIFICATIONS.'')'
X073='(1X,''THE CSA AND MSCL CODES IN THE FIRST COLUMN ARE NOT IN CORRECT ORDER.'',/,&
&1X,''THEY MUST BE IN ASCENDING ORDER 0 TO 5.'',/,&
&1X,''THE CODE OUT OF ORDER IS:'',1X,I3)'
X01='DNMCNT.INP'
OPEN(UNIT=X00076,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00076,X01,X00069,X00067)
X0042=0
X0040=13
X04=X00076
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
X02='(A)'
READ(X00076,X02,IOSTAT=IOS)X00051
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0042=X0042+1
READ(X00076,X02,IOSTAT=IOS)X00052
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0042=X0042+1
READ(X00076,X02,IOSTAT=IOS)X00054
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0040=10
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0026
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X0026.LT.0).OR.(X0026.GT.60))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE ZONE OF THE UTM PROJECTION MUST BE AN INTEGER BETWEEN'',/,&
&1X,''0 AND 60, INCLUSIVE.'',/,&
&1X,''THE VALUE ENTERED WAS:'',1X,I4)'
WRITE(X00077,X02)X0026
WRITE(*,X02)X0026
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=6
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0027
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X0027.LT.0).OR.(X0027.GT.1000000))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE VALUE ENTERED FOR THE UTM EASTING COORDINATE IS OUT OF'',&
&1X,''RANGE.'',/,&
&1X,''THE EASTING COORDINATE MUST BE A VALUE BETWEEN 0 AND 1,000,000.'',/,&
&1X,''THE VALUE ENTERED WAS:'',1X,I11)'
WRITE(X00077,X02)X0027
WRITE(*,X02)X0027
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=6
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0028
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X0028.LT.0).OR.(X0028.GT.10000000))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE VALUE ENTERED FOR THE UTM NORTHING COORDINATE IS OUT OF RANGE.'',/,&
&1X,''THE NORTHING COORDINATE MUST BE A VALUE BETWEEN 0 AND 10,000,000.'',/,&
&1X,''THE VALUE ENTERED WAS:'',1X,I11)'
WRITE(X00077,X02)X0028
WRITE(*,X02)X0028
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=6
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0025
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
BACKSPACE(UNIT=X00076,IOSTAT=IOS)
X00067=9
CALL TESTIO(X00077,X01,X0002,X00067)
X0063=' '
X02='(A)'
READ(X00076,X02,IOSTAT=IOS)X0063
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
DO I=1,20
IF(X0063(I:I).EQ.'.') THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INTEGER VALUE MUST BE ENTERED FOR THE NUMBER OF ROWS IN THE DEM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
IF(X0025.LT.10)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE NUMBER OF ROWS IN THE RASTER MUST BE AT LEAST 10'',/&
&1X,''THE VALUE ENTERED WAS: '',I5)'
WRITE(*,X02)X0025
WRITE(X00077,X02)X0025
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=6
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0024
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
BACKSPACE(UNIT=X00076,IOSTAT=IOS)
X00067=9
CALL TESTIO(X00077,X01,X0002,X00067)
X0063=' '
X02='(A)'
READ(X00076,X02,IOSTAT=IOS)X0063
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
DO I=1,20
IF(X0063(I:I).EQ.'.') THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INTEGER VALUE MUST BE ENTERED FOR THE NUMBER OF COLUMNS IN THE DEM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
IF(X0024.LT.10)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE NUMBER OF COLUMNS IN THE RASTER MUST BE AT LEAST 10'',/&
&1X,''THE VALUE ENTERED WAS: '',I5)'
WRITE(*,X02)X0024
WRITE(X00077,X02)X0024
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X15=X0024+5
X0040=5
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0029
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0029=REAL(NINT((X0029*10.0),KIND=X32),KIND=X34)/10.0
X00042=NINT((X0029*100000.0),KIND=X32)
IF((X00042.LT.100000).OR.(X00042.GT.999900000))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE MINIMUM DEM ELEVATION VALUE MUST BE A NUMBER GREATER THAN'',/,&
&1X,''OR EQUAL TO 1.0, AND LESS THAN OR EQUAL TO 9999.0'',/,&
&1X,''THE VALUE ENTERED IS : '',F10.2)'
WRITE(*,X02)X0029
WRITE(X00077,X02)X0029
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=5
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X0030
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0030=REAL(NINT((X0030*10.0),KIND=X32),KIND=X34)/10.0
X00043=NINT((X0030*100000.0),KIND=X32)
IF((X00043.LE.X00042).OR.(X00043.GT.999900000))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE MAXIMUM DEM ELEVATION VALUE MUST BE A NUMBER GREATER'',/,&
&1X,''THAN'',/,&
&1X,''1.0 (ONE), LESS THAN OR EQUAL TO 9999.0, AND GREATER THAN THE'',/,&
&1X,''MINIMUM DEM ELEVATION VALUE.'',/,&
&1X,''THE MINIMUM ELEVATION VALUE ENTERED IS : '',I10,/,&
&1X,''AND A MAXIMUM ELEVATION VALUE ENTERED IS : '',I10)'
WRITE(X00077,X02)X00042,X00043
WRITE(*,X02)X00043,X00043
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X00041=X00043
X00045=X00042
BACKSPACE(UNIT=X00076,IOSTAT=IOS)
X00067=9
CALL TESTIO(X00077,X01,X0002,X00067)
X0063=' '
X02='(A)'
READ(X00076,X02,IOSTAT=IOS)X0063
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
K=0
DO I=1,20
IF((X0063(I:I).GE.'0') .AND. (X0063(I:I) .LE. '9')) THEN
IF((K.EQ.0).AND.(X0063(I:I).EQ.'0')) CYCLE
K=K+1
ELSE IF(X0063(I:I).EQ.'.') THEN
EXIT
END IF
END DO
X00039=K
IF(K.GT.4)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE NUMBER OF DIGITS LEADING THE FLOATING POINT IS TOO LARGE: '',I6,/,&
&1X,''THE MAXIMUM ELEVATION VALUE IS 9999.0 AND SHOULD ONLY HAVE 4'',/,&
&1X,''DIGITS LEADING THE FLOATING POINT.'',/,&
&1X,''THE MAXIMUM ELEVATION VALUE ENTERED IS: '',F9.1)'
WRITE(X00077,X02)K,X0030
WRITE(*,X02)K,X0030
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=7
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X005
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X005=REAL(NINT((X005*10.0),KIND=X32),KIND=X34)/10.0
IF((NINT((X005*10.0),KIND=X32).LT.-99999).OR.(NINT((X005*10.0),KIND=X32).GT.99999))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE ELEVATION VALUE FOR INDETERMINATE ELEVATION CANNOT BE WITHIN THE'',/,&
&1X,''RANGE OF ACCEPTED ELEVATION VALUES.'',/,&
&1X,''IT CAN ALSO NOT BE LESS THAN -9999.9 OR GREATER THAN 9999.9'',/,&
&1X,''THE ENTERED VALUE WAS : '',F10.2,1X,''.'',/,&
&1X,''THE RANGE OF ACCEPTED ELEVATION VALUES IS BETWEEN:'',1X,F10.2,1X,F10.2)'
WRITE(X00077,X02)X005,X0029,X0030
WRITE(*,X02)X005,X0029,X0030
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF((NINT((X005*10.),KIND=X32).GE.NINT((X0029*10.),KIND=X32)).AND.&
(NINT((X005*10.),KIND=X32).LE.NINT((X0030*10.),KIND=X32)))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
WRITE(X00077,X02)X005,X0029,X0030
WRITE(*,X02)X005,X0029,X0030
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X006=NINT((X005*10.0),KIND=X32)*10000
X0017=NINT(((X0029)-5.0),KIND=X32)*100000
X0040=4
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X00047
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF(NINT((X00047*10000.),KIND=X32).GT.1000000000)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE VALUE ENTERED FOR THE LENGTH/WIDTH OF A RASTER CELL IS OUT OF'',/,&
&1X,''RANGE; IT MUST BE GREATER OR EQUAL TO 1.0 AND SMALLER THAN'',/,&
&1X,''100,000 METERS (100 KM).'',/,&
&1X,''THE VALUE ENTERED IS: '',1X,F10.2)'
WRITE(X00077,X02)X00047
WRITE(*,X02)X00047
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF(NINT((X00047*10000.),KIND=X32).LT.10000)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
WRITE(X00077,X02)X00047
WRITE(*,X02)X00047
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=9
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X010
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
BACKSPACE(UNIT=X00076,IOSTAT=IOS)
X00067=9
CALL TESTIO(X00077,X01,X0002,X00067)
X0063=' '
X02='(A)'
READ(X00076,X02,IOSTAT=IOS)X0063
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
DO I=1,20
IF(X0063(I:I).EQ.'.') THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''A REAL VALUE HAS BEEN ENTERED FOR THE ORIENTATION OF THE OF THE DEM'',/,&
&1X,''AN INTEGER VALUE OF 0 TO 359 MUST BE ENTERED FOR THE ORIENTATION OF THE DEM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
IF((X010.LT.0).OR.(X010.GT.359))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE NUMBER OF SMOOTHING PASSES TO BE PERFORMED'',/,&
&1X,''THE NUMBER OF PASSES MUST BE BETWEEN 1 AND 100.'')'
WRITE(X00077,X02)X010
WRITE(*,X02)X010
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=8
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X039
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0040=8
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X041
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X039.LE.1).OR.(X039.GE.X0025).OR.(X041.LE.1).OR.(X041.GE.X0024))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE WATERSHED OUTLET CANNOT BE LOCATED ON THE EDGE OR OUTSIDE OF THE DEM.'',/,&
&1X,''THE FOLLOWING VALUES WERE ENTERED OR COMPUTED AFTER AGGREGATION/RESAMPLING;'',/,&
&1X,''    ROW = '',I4,1X,''  COLUMN = '',I4,/,&
&1X,''SELECT A WATERSHED OUTLET INSIDE OFF THE EDGE OF THE DEM'')'
WRITE(X00077,X02)X039,X041
WRITE(*,X02)X039,X041
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=13
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(1)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(1).GT.2).OR.(X042(1).LT.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE AGGREGATION/RESAMPLING OPTION.'',/,&
&1X,''YOU MUST ENTER   0,  1, OR   2  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=8
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X014
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X014.LT.1).OR.(X014.GT.20))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE NUMBER OF DEM CELLS THAT ARE TO BE AGGREGATED/RESAMPLED INTO ONE VALUE'',/,&
&1X,''(REDUCTION FACTOR) IS NOT WITHIN BOUNDS OF 1 - 20.'',/,&
&1X,''THE ENTERED VALUE IS : '',I3)'
WRITE(X00077,X02)X014
WRITE(*,X02)X014
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF((X042(1).EQ.1).OR.(X042(1).EQ.2))THEN
X009=(X0025/INT(X014,KIND=X35))
X008=(X0024/INT(X014,KIND=X35))
IF((X009.LT.10).OR.(X008.LT.10))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE FACTOR FOR AGGREGATION/RESAMPLING IS TO LARGE.  THE RESULTING'',/,&
&1X,''NUMBER OF ROWS OR COLUMNS IN THE DEM IS LESS THAN 10.'',/,&
&1X,''DECREASE THE SIZE OF THE AGGREGATION/RESAMPLING FACTOR.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
ELSE IF(X042(1).EQ.0)THEN
X009=X0025
X008=X0024
X014=1
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''LOGIC ERROR.  AN UNACCEPTABLE VALUE FOR IOPT(1) WAS ENCOUNTERED.'',/,&
&1X,''THE VALUE WAS: '',I9)'
WRITE(X00077,X02)X042(1)
WRITE(*,X02)X042(1)
STOP 'ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  CHECK REPORT FILE.'
END IF
IF((X009.GT.X00083).OR.(X008.GT.X00083))THEN
X0001=0
DO
X02='(1X,''THE NUMBER OF ROWS OR COLUMNS IN THE AGGREGATED/RESAMPLED DEM,''1X,I5,1X,'', IS LARGE.'')'
WRITE(X00077,X02)X009
WRITE(*,X02)X009
X02='(1X,''DO YOU WISH TO CONTINUE?  ENTER  1 TO CONTINUE,'',/,&
&1X,''                             OR  0 TO STOP PROGRAM EXECUTION.'')'
WRITE(*,X02)
READ(*,*,IOSTAT=IOS)X0003
X00067=1
CALL TESTIO(X00068,X01,X00069,X00067)
IF(X0003.EQ.1)THEN
EXIT
ELSE IF(X0003.EQ.0)THEN
X02='(1X,''THE USER ELECTED NOT TO PROCEED WITH THE GIVEN DEM ARRAY DIMENSIONS.'',/,&
&1X,''PROGRAM EXECUTION WAS TERMINATED.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'PROGRAM EXECUTION TERMINATED BY USER.'
ELSE
WRITE(X00077,X071)
WRITE(*,X071)
IF(X0001.EQ.0)THEN
X0001=1
CYCLE
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  INPUT ERROR.  CHECK REPORT FILE.'
END IF
END IF
END DO
END IF
X17=X009+5
X16=X008+5
X0014=X00047*REAL(X014,KIND=X34)
X001=(X0014*X0014)/10000.0
IF(NINT((X0014*10000.),KIND=X32).GE.20000000)THEN
X0001=0
DO
X02='(1X,''THE LENGTH OF A SIDE OF A CELL, AFTER AGGREGATION/RESAMPLING IS: '',F10.1,/,&
&1X,''DO YOU WISH TO CONTINUE WITH THIS LARGE A VALUE?'',/,&
&1X,''ENTER  1  FOR YES, OR  0  FOR NO.'',/)'
WRITE(*,X02)X0014
READ(*,*,IOSTAT=IOS)X0003
X00067=1
CALL TESTIO(X00068,X01,X00069,X00067)
IF(X0003.EQ.1)THEN
EXIT
ELSE IF(X0003.EQ.0)THEN
X02='(1X,''THE USER ELECTED NOT TO PROCEED WITH THE GIVEN CELL DIMENSIONS.'',/,&
&1X,''PROGRAM EXECUTION WAS TERMINATED.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'PROGRAM EXECUTION TERMINATED BY USER.'
ELSE
WRITE(X00077,X071)
WRITE(*,X071)
IF(X0001.EQ.0)THEN
X0001=1
CYCLE
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  INPUT ERROR.  CHECK REPORT FILE.'
END IF
END IF
END DO
END IF
IF((X042(1).EQ.1).OR.(X042(1).EQ.2))THEN
X09=NINT((REAL(X039,KIND=X34)/REAL(X014,KIND=X34)),KIND=X35)
X10=NINT((REAL(X041,KIND=X34)/REAL(X014,KIND=X34)),KIND=X35)
ELSE
X09=X039
X10=X041
END IF
IF((X09.LE.1).OR.(X09.GE.X0025).OR.(X10.LE.1).OR.(X10.GE.X0024))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE WATERSHED OUTLET CANNOT BE LOCATED ON THE EDGE OR OUTSIDE OF THE DEM.'',/,&
&1X,''THE FOLLOWING VALUES WERE ENTERED OR COMPUTED AFTER AGGREGATION/RESAMPLING;'',/,&
&1X,''    ROW = '',I4,1X,''  COLUMN = '',I4,/,&
&1X,''SELECT A WATERSHED OUTLET INSIDE OFF THE EDGE OF THE DEM.'')'
WRITE(X00077,X02)X09,X10
WRITE(*,X02)X09,X10
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=7
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(4)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(4).NE.1).AND.(X042(4).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE USER OPTION TO SMOOTH THE INPUT DATA.'',/&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=7
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X015
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF(X042(4).EQ.1)THEN
IF((X015.LE.0).OR.(X015.GT.100))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE NUMBER OF SMOOTHING PASSES TO BE PERFORMED'',/,&
&1X,''THE NUMBER OF PASSES MUST BE BETWEEN 1 AND 100.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END IF
X0040=10
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X12
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X13
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X14
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF(X042(4).EQ.1)THEN
IF((X12.EQ.0).AND.(X13.EQ.0).AND.(X14.EQ.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''ALL WEIGHTING VALUES FOR THE SMOOTHING PROCESS MAY NOT BE EQUAL TO 0 AT ONCE.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF((X12.GT.100).OR.(X13.GT.100).OR.(X14.GT.100))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE MAXIMUM VALUE ALLOWED FOR ANY WEIGHTING VALUE FOR THE SMOOTHING PROCESS IS 100.'',/,&
&1X,''A NUMBER LARGER THAN 100 HAS BEEN ENTERED AS A WEIGHTING VALUE.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END IF
X0040=9
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(2)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(2).LT.0).OR.(X042(2).GT.2))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE DEPRESSION ANALYSIS OPTION.'',/,&
&1X,''YOU MUST ENTER   0,  1, OR   2  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=11
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(3)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(3).LT.0).OR.(X042(3).GT.2))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE DEM PARTIAL PROCESSING OPTION.'',/,&
&1X,''YOU MUST ENTER   0 , 1 OR  2  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=11
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(5)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0040=37
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X00068
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF(X00068.NE.0)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
WRITE(X00077,X073)X00068
WRITE(X00077,X073)X00068
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
DO I=1,X057
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X00068,X0031(I),X00050(I)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF(X00068.NE.I)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
WRITE(X00077,X073)X00068
WRITE(*,X073)X00068
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END DO
IF((X0031(1).LT.0.0).OR.(X00050(1).LT.0.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)(X0042-4)
WRITE(*,X053)
WRITE(*,X051)(X0042-4)
X02='(1X,''ERROR IN THE CRITICAL SOURCE AREA (CSA) AND/OR'',/,&
&1X,''MINIMUM SOURCE CHANNEL LENGTH (MSCL).'',/,&
&1X,''THE CSA AND/OR MSCL VALUES WAS FOUND TO BE EQUAL TO -1.0.'',/,&
&1X,''THE CSA AND MSCL VALUE FOR CODE 1 MUST BE AN ACCEPTABLE VALUE FOR'',/,&
&1X,''NETWORK IDENTIFICATION TO BE POSSIBLE.'',/,&
&1X,''CORRECT THE CSA AND/OR MSCL VALUE FOR CODE 1 IN FILE DNMCNT.INP.'',/,&
&1X,''THE INCORRECT VALUES PROVIDED ARE:'',/,&
&1X,''CSA:'',1X,F10.2,1X,''MSCL:'',1X,F10.2)'
WRITE(X00077,X02)X0031(1),X00050(1)
WRITE(*,X02)X0031(1),X00050(1)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X00102=0
X00103=0
DO I=1,X057
IAFLAG=0
IF((X0031(I).GT.(-1.0*1.001)).AND.(X0031(I).LT.(-1.0*0.999)))THEN
IAFLAG=1
END IF
IDFLAG=0
IF((X00050(I).GT.(-1.0*1.01)).AND.(X00050(I).LT.(-1.0*0.99)))THEN
IDFLAG=1
END IF
IF(((IAFLAG.EQ.1).AND.(X00050(I).GT.-0.001)).OR.&
((IDFLAG.EQ.1).AND.(X0031(I).GT.-0.001)))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''ERROR IN THE CRITICAL SOURCE AREA (CSA) AND/OR MINIMUM SOURCE CHANNEL'',/,&
&1X,''LENGTH (MSCL).'',/,&
&1X,''EITHER BOTH CSA AND MSCL PARAMETERS FOR A GIVEN CODE MUST BE DEFINED,'',/,&
&1X,''OR BOTH MUST BE INDETERMINATE (-1.0).'',/,&
&1X,''CORRECT THE INPUT CSA AND MSCL PARAMETERS IN FILE DNMCNT.INP.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF(IAFLAG.EQ.0)THEN
IF((X0031(I).LT.0.001).OR.(X0031(I).LT.X001))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE THRESHOLD VALUE FOR THE DRAINAGE AREA AT THE BOTTOM OF WHICH A'',/,&
&1X,''FIRST ORDER CHANNEL BEGINS (CRITICAL SOURCE AREA) IS TO SMALL.'',/,&
&1X,''IT MUST BE LARGER THAN 0.001 HECTARES AND LARGER THAN THE AREA OF A CELL,'',/,&
&1X,''OR IT MUST BE -1.0 FOR NOT APPLICABLE.'',/,&
&1X,''THE ENTERED CODE AND CSA VALUE IS: '',1X,I3,1X,F10.2)'
WRITE(X00077,X02)I,X0031(I)
WRITE(*,X02)I,X0031(I)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END IF
IF(IAFLAG.EQ.1)THEN
X00046(I)=-1
X00102=1
ELSE
IF(X00102.NE.0)THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''ERROR IN THE CRITICAL SOURCE AREA (CSA) AND/OR MINIMUM SOURCE'',/,&
&1X,''CHANNEL LENGTH (MSCL).'',/,&
&1X,''ALL DEFINED CSA AND MSCL VALUES MUST BE GROUPED AND PLACED AT THE TOP'',/,&
&1X,''OF THE TABLE AND ALL INDETERMINATE VALUES OF CSA AND MSCL (-1) MUST'',/,&
&1X,''BE GROUPED AND PLACED AT THE BOTTOM OF THE TABLE.'',/,&
&1X,''CORRECT THE CSA AND/OR MSCL VALUES IN FILE DNMCNT.INP.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X00046(I)=NINT((X0031(I)/X001),KIND=X35)
IF(X00046(I).LE.0)X00046(I)=1
END IF
IF((X00046(I).LE.10).AND.(X00046(I).GT.-1))X00103=1
IF((X00050(I).GT.0.01).OR.(X00050(I).LT.-0.01))THEN
IF((IDFLAG.EQ.0).AND.((X00050(I).LT.1.0)&
.OR.(X00050(I).LT.X00047)))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE VALUE FOR THE MINIMUM CHANNEL LENGTH FOR A CHANNEL TO BE'',/,&
&1X,''CLASSIFIED AS A CHANNEL IS TOO SHORT.'',/,&
&1X,''IT MUST BE LONGER THAN 1.0 METER AND LONGER THAN A CELL SIDE,'',/,&
&1X,''OR IT MUST BE -1.0 FOR NOT APPLICABLE, OR 0.0 FOR NO PRUNING.'',/,&
&1X,''THE ENTERED CODE AND MSCL VALUE IS:'',1X,I3,1X,F10.2)'
WRITE(X00077,X02)I,X00050(I)
WRITE(*,X02)I,X00050(I)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
END IF
END DO
IF(X00103.EQ.1)THEN
DO
X02='(/,1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!  WARNING  !!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE INCNT; MODULE DEDNM1 (M_DEDNM1.F90)'',/,&
&1X,''INPUT FILE DNMCNT.INP.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''A USER PROVIDED CSA VALUE IS SMALLER THAN 10 CELL-AREAS.  THIS MAY'',/,&
&1X,''RESULT IN A POOR DRAINAGE NETWORK DEFINITION.  A CSA VALUE LARGER THAN'',/,&
&1X,''AT LEAST 10 CELL AREAS IS GENERALLY RECOMMENDED, BUT NOT REQUIRED.'',/,&
&1X,''ENTER A  0  TO TERMINATE EXECUTION, OR'',/,&
&1X,''ENTER A  1  TO PROCEED WITH CURRENT CSA VALUES.'',/)'
WRITE(X00077,X02)
WRITE(*,X02)
READ(*,*,IOSTAT=IOS)X0003
X00067=1
CALL TESTIO(X00068,X01,X00069,X00067)
IF(X0003.EQ.1)THEN
X02='(/,10X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&10X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&10X,''!!!!!!!!!!!!!!!  WARNING  !!!!!!!!!!!!!!!!'',/,&
&10X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&10X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',//,&
&1X,''USER ELECTED TO CONTINUE PROGRAM EXECUTION WITH A CSA VALUE'',/,&
&1X,''THAT IS LOWER THAN THE MINIMUM RECOMMENDED VALUE OF AT LEAST 10 CELL-AREAS'',/,&
&1X,''FOR ACCURATE DRAINAGE NETWORK DEFINITION.'',/)'
WRITE(X00077,X02)
WRITE(*,X02)
EXIT
ELSE IF(X0003.EQ.0)THEN
X02='(1X,''THE USER ELECTED NOT TO PROCEED WITH THE GIVEN CSA VALUES.'',/,&
&1X,''PROGRAM EXECUTION WAS TERMINATED.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'PROGRAM EXECUTION TERMINATED BY USER.'
ELSE
WRITE(X00077,X071)
WRITE(*,X071)
IF(X0001.EQ.0)THEN
X0001=1
CYCLE
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
WRITE(X00077,X072)
WRITE(*,X072)
STOP 'ABNORMAL PROGRAM TERMINATION.  INPUT ERROR.  CHECK REPORT FILE.'
END IF
END IF
END DO
END IF
X0040=10
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(10)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(10).LT.0).AND.(X042(10).GT.3))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE OPTION OF CALIBRATION RUN.'',/,&
&1X,''YOU MUST ENTER   0 , 1 ,  2 , OR  3  FOR THE OPTION VALUE.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF((X042(10).GT.0).AND.(X042(3).EQ.1))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE OPTION OF "CALIBRATION RUN" AND THE OPTION OF PERFORMING THE DEM'',/,&
&1X,''ELEVATION PRE-PROCESSING ONLY" WERE SELECTED.  THESE OPTIONS ARE MUTUALLY'',/,&
&1X,''EXCLUSIVE.  SELECT ONE OR THE OTHER ONLY.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
IF((X042(10).EQ.3).AND.(X042(5).EQ.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''THE OPTION FOR NEW NTGCOD.INP FILE FOR SPATIALLY VARIABLE'',/,&
&1X,''CSA/MSCL PARAMETERS ON A CALIBRATION RUN, AND THE OPTION FOR SINGLE'',/,&
&1X,''CSA/MSCL PARAMETERS HAVE BEEN SELECTED. THE OPTIONS ARE MUTUALLY'',/,&
&1X,''EXCLUSIVE.  PLEASE CHECK INPUT FILE DNMCNT.INP.'')'
WRITE(X00077,X02)
WRITE(*,X02)
END IF
X0040=6
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(11)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(11).NE.1).AND.(X042(11).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE ERROR CHECKING OPTION.'',/,&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=14
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(13)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(13).NE.1).AND.(X042(13).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE OPTION TO PRINT PROGRAM CAPABILITIES.'',/,&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=3
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(12)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(12).NE.1).AND.(X042(12).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE OPTION TO ECHO THE INPUT DATA.'',/,&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=3
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(16)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(16).NE.1).AND.(X042(16).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE USER OPTION TO PRINT THE'',/,&
&1X,''TABLE OF CHANNEL NETWORK PROPERTIES'',/,&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=3
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(15)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(15).NE.1).AND.(X042(15).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE USER OPTION TO PRINT THE'',/,&
&1X,''TABLE OF SUBCATCHMENT CHARACTERISTICS.'',/,&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
X0040=3
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(17)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
IF((X042(17).NE.1).AND.(X042(17).NE.0))THEN
WRITE(X00077,X053)
WRITE(X00077,X051)X0042
WRITE(*,X053)
WRITE(*,X051)X0042
X02='(1X,''AN INCORRECT VALUE WAS ENTERED FOR THE USER OPTION TO PRINT THE'',/,&
&1X,''TABLE OF CATCHMENT WINDOW SIZE.'',/,&
&1X,''YOU MUST ENTER A  1  OR  0  FOR THE DESIRED OPTION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  ERROR IN INPUT FILE.'
END IF
CLOSE(UNIT=X00076,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00076,X01,X0002,X00067)
END SUBROUTINE INCNT
SUBROUTINE INUPDT
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,X34,X00072,&
X00077
USE DTCNT1
USE GENIO2,ONLY:IOCNT
IMPLICIT NONE
INTEGER(KIND=X36)::X002=X00070,X0001=X00070
INTEGER(KIND=X36)::X0081=X00070,X0084=X00070
INTEGER(KIND=X36)::X083=X00070,X084=X00070,X085=X00070
INTEGER(KIND=X35)::I=X00071
INTEGER(KIND=X35)::X086=X00071,X067=X00071,X066=X00071
INTEGER(KIND=X35)::X095=X00071,X070=X00071,X0077=X00071,X0078=X00071
INTEGER(KIND=X35)::X0082=X00071,X00109=X00071,X00110=X00071
INTEGER(KIND=X32)::X00106=X00081,X00105=X00081,X00104=X00081
INTEGER(KIND=X36),DIMENSION(1:X056)::X0083=(/(X00070,I=1,X056)/)
INTEGER(KIND=X35),DIMENSION(1:X057)::X00450=(/(X00071,I=1,X057)/)
REAL(KIND=X34)::X00111=X00072,X0080=X00072,X00107=X00072,X00108=X00072
REAL(KIND=X34),DIMENSION(1:X057)::X0275=(/(X00072,I=1,X057)/),X00451=(/(X00072,I=1,X057)/)
CHARACTER(LEN=500)::X02=' ', X053=' ', X051=' '
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''PROGRAM DEDNM; SUBROUTINE INUPDT.'',/,&
&1X,''INPUT FILES DNMCNT.INP AND OUTCNT.UNF.'')'
X051='(1X,''THIS IS NOT ALLOWED ON A CALIBRATION RUN.'')'
X067=X17
X066=X16
X086=X15
X070=X10
X095=X09
X0078=X041
X0077=X039
X00106=X0026
X00105=X0027
X00104=X0028
X00111=X0014
X0082=X010
X0080=X005
X0081=X014
X00109=X0025
X00110=X0024
X0084=X015
X083=X12
X084=X13
X085=X14
X00107=X0029
X00108=X0030
DO I=1,X057
X0275(I)=X0031(I)
X00451(I)=X00050(I)
X00450(I)=X00046(I)
END DO
DO I=1,X056
X0083(I)=X042(I)
END DO
X002=2
CALL IOCNT(X002)
X042(3)=X0083(3)
X042(10)=X0083(10)
IF(X042(10).EQ.1)THEN
DO I=1,X057
X0031(I)=X0275(I)
X00050(I)=X00451(I)
X00046(I)=X00450(I)
END DO
END IF
IF(X042(10).EQ.2)THEN
X09=X095
X10=X070
END IF
IF((X042(10).EQ.1).OR.(X042(10).EQ.3))THEN
IF((X0078.NE.X041).OR.(X0077.NE.X039))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE INITIAL WATERSHED OUTLET LOCATION HAS BEEN CHANGED.'',/,&
&1X,''THIS IS NOT ALLOWED ON CALIBRATION OPTION 1 OR 3.'',/,&
&1X,''PREVIOUS INITIAL OUTLET ROW/COLUMN:'',1X,I9,1X,I9,/,&
&1X,''CURRENT INITIAL OUTLET ROW/COLUMN: '',1X,I9,1X,I9)'
WRITE(*,X02)X039,X041,X0077,X0078
WRITE(X00077,X02)X039,X041,X0077,X0078
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
END IF
IF((X042(10).EQ.2).OR.(X042(10).EQ.3))THEN
X0001=0
X0079:DO I=1,X057
IF(NINT(X0031(I),KIND=X32).EQ.-1)THEN
IF(NINT(X0031(I),KIND=X32).NE.NINT(X0275(I),KIND=X32))THEN
X0001=1
EXIT X0079
END IF
ELSE IF((X0031(I).LT.(X0275(I)*0.999999)).OR.(X0031(I).GT.(X0275(I)*1.000001)))THEN
X0001=1
EXIT X0079
END IF
IF(NINT(X00050(I),KIND=X32).EQ.-1)THEN
IF(NINT(X00050(I),KIND=X32).NE.NINT(X00451(I),KIND=X32))THEN
X0001=1
EXIT X0079
END IF
ELSE IF((X00050(I).LT.(X00451(I)*0.999999)).OR.(X00050(I).GT.(X00451(I)*1.000001)))THEN
X0001=1
EXIT X0079
END IF
END DO X0079
IF(X0001.EQ.1)THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''A USER ENTERED VALUE FOR THE CSA/MSCL HAS CHANGED.'',/,&
&1X,''THIS IS NOT ALLOWED ON CALIBRATION OPTION 2 OR 3.'',/,&
&1X,''PREVIOUS CSA/MSCL:'',1X,I2,2(1X,F9.2),/,&
&1X,''CURRENT CSA/MSCL: '',1X,I2,2(1X,F9.2))'
WRITE(*,X02)I,X0031(I),X00050(I),I,X0275(I),X00451(I)
WRITE(X00077,X02)I,X0031(I),X00050(I),I,X0275(I),X00451(I)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
END IF
IF((X0026.NE.X00106).OR.(X0027.NE.X00105).OR.(X0028.NE.X0028))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE USER ENTERED VALUES FOR THE UTM COORDINATES HAVE BEEN CHANGED.'',/,&
&1X,''PREVIOUS ZONE/EASTING/NORTHING:'',1X,I3,2(1X,I9),/,&
&1X,''CURRENT ZONE/EASTING/NORTHING: '',1X,I3,2(1X,I9))'
WRITE(*,X02)X0026,X0027,X0028,X00106,X00105,X00104
WRITE(X00077,X02)X0026,X0027,X0028,X00106,X00105,X00104
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF((X0029*1.000001.LT.X00107).OR.(X0029*0.999999.GT.X00107).OR.&
(X0030*1.000001.LT.X00108).OR.(X0030*0.999999.GT.X00108))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE ORIGINAL VALUE OF THE MIN/MAX ELEVATION OF THE DEM HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS MIN/MAX ELEVATION: '',1X,F9.4,1X,F9.4,/,&
&1X,''CURRENT MIN/MAX ELEVATION:  '',1X,F9.4,1X,F9.4)'
WRITE(*,X02)X0029,X0030,X00107,X00108
WRITE(X00077,X02)X0029,X0030,X00107,X00108
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF((X005*0.999999.GT.X0080).OR.(X005*1.000001.LT.X0080))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE USER ENTERED VALUE FOR INDETERMINATE ELEVATIONS HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS VALUE:'',1X,F9.2,/,&
&1X,''CURRENT VALUE: '',1X,F9.2)'
WRITE(*,X02)X005,X0080
WRITE(X00077,X02)X005,X0080
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF(X014.NE.X0081)THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE LEVEL OF AGGREGATION OR RESAMPLING HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS VALUE:'',1X,I6,/,&
&1X,''CURRENT VALUE: '',1X,I6)'
WRITE(*,X02)X014,X0081
WRITE(X00077,X02)X014,X0081
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF((X0025.NE.X00109).OR.(X0024.NE.X00110))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE NUMBER OF ROWS/COLUMNS IN THE DEM HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS NUMBER OF ROWS/COLUMNS:'',1X,I6,1X,I6,/,&
&1X,''CURRENT NUMBER OF ROWS/COLUMNS:'',1X,I6,1X,I6)'
WRITE(*,X02)X0025,X0024,X00109,X00110
WRITE(X00077,X02)X0025,X0024,X00109,X00110
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF(NINT((X0014*100.0),KIND=X32).NE.NINT((X00111*100.0),KIND=X32))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE LENGTH OF A CELL SIDE HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS VALUE:'',1X,F7.2,/,&
&1X,''CURRENT VALUE: '',1X,F7.2)'
WRITE(*,X02)X0014,X00111
WRITE(X00077,X02)X0014,X00111
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF(X010.NE.X0082)THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE ORIENTATION OF THE RASTER HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS VALUE:'',1X,I3,/,&
&1X,''CURRENT VALUE: '',1X,I3)'
WRITE(*,X02)X010,X0082
WRITE(X00077,X02)X010,X0082
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
DO I=1,19
IF(X042(I).NE.X0083(I))THEN
IF(I.EQ.3)CYCLE
IF(I.EQ.10)CYCLE
IF(I.EQ.5)THEN
X02='(1X,''THE USER CANNOT SWITCH FROM A SPATIALLY VARIABLE CSA/MSCL PARAMETER'',/,&
&1X,''CASE TO A SPATIALLY UNIFORM PARAMETER CASE, OR VICE VERSA,'',/,&
&1X,''DURING A CALIBRATION RUN.  ONLY CSA/MSCL PARAMETER VALUES CAN BE'',/,&
&1X,''CHANGED FOR A CALIBRATION RUN.'')'
WRITE(*,X02)
WRITE(X00077,X02)
END IF
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE VALUE OF USER OPTION'',1X,I2,1X,''HAS BEEN CHANGED.'',/,&
&1X,''PREVIOUS VALUE:'',1X,I6,/,&
&1X,''CURRENT VALUE: '',1X,I6)'
WRITE(*,X02)I,X042(I),X0083(I)
WRITE(X00077,X02)I,X042(I),X0083(I)
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
END DO
IF((X12.NE.X083).OR.(X13.NE.X084).OR.(X14.NE.X085).OR.(X015.NE.X0084))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE VALUE THE WEIGHTS OF CELL FOR SMOOTHING OR THE NUMBER OF SMOOTHING'',/,&
&1X,''PASSES BEEN CHANGED.'',/,&
&1X,''PREVIOUS/CURRENT NUMBER OF PASSES:'',1X,I3,1X,I3,/,&
&1X,''PREVIOUS CENTER/CROSS/DIAGONAL  :'',1X,I3,1X,I3,1X,I3,/,&
&1X,''CURRENT CENTER/CROSS/DIAGONAL   :'',1X,I3,1X,I3,1X,I3)'
WRITE(*,X02)X015,X0084,X12,X13,X14,X083,X084,X085
WRITE(X00077,X02)X015,X0084,X12,X13,X14,X083,X084,X085
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
IF((X17.NE.X067).OR.(X16.NE.X066).OR.(X15.NE.X086))THEN
WRITE(*,X053)
WRITE(X00077,X053)
X02='(1X,''THE RASTER ARRAY SIZE (IRS,ICS AND IAS) HAS CHANGED.'',/,&
&1X,''PREVIOUS RASTER SIZE VALUES:'',1X,I6,1X,I6,1X,I6,/,&
&1X,''CURRENT RASTER SIZE VALUES:'',1X,I6,1X,I6,1X,I6)'
WRITE(*,X02)X067,X066,X086,X17,X16,X15
WRITE(X00077,X02)X067,X066,X086,X17,X16,X15
WRITE(*,X051)
WRITE(X00077,X051)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF
END SUBROUTINE INUPDT
SUBROUTINE IOINIT
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00077,X00080,X00073,IOS
USE DTCNT1,ONLY:X042,X38
USE GENIO1,ONLY:TESTIO,CHKFIL
IMPLICIT NONE
INTEGER(KIND=X35)::I=X00071,J=X00071
INTEGER(KIND=X36)::X00066=X00070,X00067=X00070,X26=X00070
INTEGER(KIND=X36),DIMENSION(1:8)::X95=(/(X00070,I=1,8)/)
INTEGER(KIND=X36),DIMENSION(1:X38)::X0085=(/(X00070,I=1,X38)/)
INTEGER(KIND=X36),DIMENSION(1:9,1:2)::X96=RESHAPE((/((X00070,I=1,9),J=1,2)/),(/9,2/))
INTEGER(KIND=X35)::X25=X00071,X0042=X00071,X0002=X00071
CHARACTER(LEN=12)::X01
CHARACTER(LEN=500)::X02=' '
IF((X042(10).EQ.1).OR.(X042(10).EQ.2).OR.(X042(10).EQ.3))THEN
X01='OUTCNT.UNF'
X00066=2
CALL CHKFIL(X01,X00066)
OPEN(UNIT=X00080,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00080,X01,X0002,X00067)
READ(X00080,IOSTAT=IOS)X25,X25,X25,X25,X26,X26,X26,X26,X26,X95,X96,X0085(X38)
X00067=2
X0042=1
CALL TESTIO(X00080,X01,X0042,X00067)
CLOSE(UNIT=X00080,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00080,X01,X0002,X00067)
IF(X0085(1).EQ.2)THEN
X02='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''SUBROUTINE IOINIT; MODULE DEDNM2 (M_DEDNM2.F90)'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''THE PREVIOUS RUN OF PROGRAM DEDNM WAS FOR ELEVATION PRE-PROCESSING ONLY.'',/,&
&1X,''THE CALIBRATION AND NETWORK GENERATION OPTIONS REQUIRE A PREVIOUS FULL'',/,&
&1X,''OR CALIBRATION RUN OF PROGRAM DEDNM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
STOP 'ABNORMAL PROGRAM TERMINATION.  NO INPUT FILE.'
END IF
ELSE
X01='OUTCNT.UNF'
! OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, ACCESS='SEQUENTIAL' , IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
X01='DNMCNT.INP'
X00066=2
CALL CHKFIL(X01,X00066)
IF(X042(10).EQ.0)THEN
X01='DEDNM.INP'
X00066=2
CALL CHKFIL(X01,X00066)
END IF
IF((X042(10).EQ.0).OR.(X042(10).EQ.3))THEN
IF(X042(5).EQ.1)THEN
IF((X042(3).EQ.0).OR.(X042(3).EQ.2))THEN
X01='NTGCOD.INP'
X00066=2
CALL CHKFIL(X01,X00066)
END IF
END IF
END IF
IF(((X042(10).EQ.1).OR.(X042(10).EQ.2).OR.(X042(10).EQ.3)).AND.&
((X042(3).EQ.0).OR.(X042(3).EQ.2)))THEN
X01='FLOVEC.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
X01='RELIEF.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
X01='UPAREA.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
ELSE
X01='FLOVEC.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='RELIEF.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='UPAREA.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
IF(((X042(10).EQ.1).OR.(X042(10).EQ.2).OR.(X042(10).EQ.3)).AND.&
(X042(3).EQ.0))THEN
X01='INDTAR.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
X01='FILDEP.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
X01='FLOPAT.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
X01='INELEV.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
X01='SMOOTH.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
ELSE
X01='INDTAR.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='FILDEP.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='FLOPAT.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='INELEV.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='SMOOTH.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
IF(((X042(10).EQ.1).OR.(X042(10).EQ.3)).AND.(X042(3).EQ.0))THEN
X01='BOUND.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
ELSE
X01='BOUND.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01,IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
IF(((X042(10).EQ.1).OR.(X042(10).EQ.2)).AND.&
((X042(3).EQ.0).OR.(X042(3).EQ.2)))THEN
X01='NTGCOD.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
ELSE
X01='NTGCOD.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01,IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
IF((X042(10).EQ.2).AND.(X042(3).EQ.0))THEN
X01='NETFUL.OUT'
X00066=2
CALL CHKFIL(X01,X00066)
ELSE
X01='NETFUL.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
IF((X042(10).EQ.2).AND.(X042(3).EQ.0))THEN
X01='NTWINT.FIL'
X00066=2
CALL CHKFIL(X01,X00066)
ELSE
X01='NTWINT.FIL'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01,IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END IF
X01='NETW.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='SUBWTA.OUT'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01,IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='NETW.TAB'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='SBCT.TAB'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='CATWIN.TAB'
OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='OUTCHA.UNF'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
X01='OUTCAT.UNF'
!OPEN(UNIT=X00073,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='UNFORMATTED', IOSTAT=IOS)
OPEN(UNIT=X00073,FILE=X01, IOSTAT=IOS)
X00067=3
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE IOINIT
SUBROUTINE OTCNT1
USE STSYS1,ONLY:X36,X35,X00070,X00071
USE DTCNT1,ONLY:X056,IORD,X38,X057,X054,X042,&
X00044,X00040,X00049,X00048,X00032,X00031,X040
USE GENIO2,ONLY:IOCNT
IMPLICIT NONE
INTEGER(KIND=X36)::X002=X00070
INTEGER(KIND=X35)::I=X00071
X00049=DBLE(X00044)/100000.
X00048=DBLE(X00040)/100000.
IF(X042(3).EQ.0)THEN
X00032=(X00031*10)+4
ELSE
X00032=-99999
END IF
IF(X042(3).EQ.0)THEN
X040(1)=1
ELSE IF(X042(3).EQ.1)THEN
X040(1)=2
ELSE IF(X042(3).EQ.2)THEN
X040(1)=3
END IF
DO I=2,X38
X040(I)=0
END DO
X002=1
CALL IOCNT(X002)
END SUBROUTINE OTCNT1
SUBROUTINE OUTLET(X00116)
USE STSYS1,ONLY:X36,X35,X00070,X00071,IOS
USE DTCNT1,ONLY:X023,X025,X09,X10,X042,X0016,X07,X00029
USE DTRST1,ONLY:X40,ICA,X049,X08
IMPLICIT NONE
INTEGER(KIND=X36)::X00116
INTEGER(KIND=X36)::IDIV=X00070
INTEGER(KIND=X36)::X94=X00070,X0001=X00070
INTEGER(KIND=X35)::X93=X00071,IRE=X00071,X91=X00071,X92=X00071
INTEGER(KIND=X35)::X0274=X00071,IC=X00071,IR=X00071,CNT=X00071,I=X00071
CHARACTER(LEN=500)::X02=' ', X053=' '
X053='(1X,''RE-ENTER THE ROW AND COLUMN NUMBERS FOR THE DRAINAGE AREA OUTLET.'')'
X00116=0
X0001=0
IF(X00029.LE.999999)THEN
IDIV=1
ELSE IF((X00029.GT.999999).AND.(X00029.LE.9999999))THEN
IDIV=10
ELSE IF(X00029.GT.9999999)THEN
IDIV=100
END IF
PASS1:DO
X00449:IF((X042(10).EQ.0).OR.(X042(10).EQ.2).OR.(X0001.EQ.1))THEN
X00116=1
X91=X10-5
IF(X91.LT.1)X91=1
X93=X09-7
IF(X93.LT.1)X93=1
IRE=X09+7
IF(IRE.GT.X023)IRE=X023
X92=10
X0274=X91-1
IF((X0274+X92).GT.X025)X92=X025-X0274
DO IC=X0274+1,X0274+X92
DO IR=X93,IRE
IF(X40(IR,IC).LE.1)THEN
X049(IR,IC)=0
ELSE
X049(IR,IC)=ICA(IR,IC)
END IF
END DO
END DO
X02='(5X,10(2X,I5))'
WRITE(*,X02)((X0274+IC),IC=1,X92)
DO IR=X93,IRE
X02='(1X,I4,10(1X,I6))'
WRITE(*,X02)IR,(INT((X049(IR,IC)/IDIV)),IC=X0274+1,X0274+X92)
END DO
LOC7:DO
X02='(1X,''THE DRAINAGE AREA OUTLET IS DEFINED BY ROW '',I4,'' AND COLUMN '',I4,''.'',/,&
&1X,''ENTER 0 IF YOU WANT TO CHANGE THESE VALUES;'',/,&
&1X,''ENTER 1 IF YOU WANT TO PROCEED WITH THESE VALUES: '')'
WRITE(*,X02)X09,X10
READ(*,*,IOSTAT=IOS)X94
IF(IOS.NE.0)CYCLE LOC7
IF((X94.NE.1).AND.(X94.NE.0))THEN
X02='(1X,''YOU MUST ENTER   0, OR   1  FOR THE DESIRED OPTION.'')'
WRITE(*,X02)
CYCLE LOC7
END IF
IF(X94.EQ.0)THEN
X00116=1
LOC8:DO
X02='(1X,''ENTER A NEW ROW AND COLUMN OF THE RASTER CELL DEFINING THE DRAINAGE'',/,&
&1X,''AREA OUTLET.'')'
WRITE(*,X02)
X02='(1X,''ENTER THE ROW NUMBER: '')'
WRITE(*,X02)
READ(*,*,IOSTAT=IOS)X09
IF(IOS.NE.0)CYCLE LOC8
EXIT LOC8
END DO LOC8
IF((X09.GT.X023).OR.(X09.LT.1))THEN
X02='(1X,''THE NUMBER OF THE ROW YOU ENTERED, '',I6,'', IS OUTSIDE THE BOUNDARIES'',/,&
&1X,''OF THE RASTER ARRAY, 1 THROUGH '',I6)'
WRITE(*,X02)X09,X023
WRITE(*,X053)
CYCLE LOC7
END IF
LOC6:DO
X02='(1X,''ENTER THE COLUMN NUMBER: '')'
WRITE(*,X02)
READ(*,*,IOSTAT=IOS)X10
IF(IOS.NE.0)CYCLE LOC6
EXIT LOC6
END DO LOC6
IF((X10.GT.X025).OR.(X10.LT.1))THEN
X02='(1X,''THE NUMBER OF THE COLUMN YOU ENTERED, '',I6,'', IS OUTSIDE THE BOUNDARIES'',/,&
&1X,''OF THE RASTER ARRAY, 1 THROUGH '',I6)'
WRITE(*,X02)X10,X025
WRITE(*,X02)
CYCLE LOC7
END IF
CYCLE PASS1
END IF
EXIT LOC7
END DO LOC7
END IF X00449
X0001=0
IF(X049(X09,X10).LT.1)THEN
X02='(1X,''THE SELECTED OUTLET CELL IS NOT A CHANNEL CELL.'',/,&
&1X,''FOR A NETWORK AND WATERSHED TO BE EVALUATED THE SELECTED OUTLET'',/,&
&1X,''MUST BE A CHANNEL CELL.'')'
WRITE(*,X02)
WRITE(*,X053)
X0001=1
CYCLE PASS1
END IF
IF((X09.EQ.X023).OR.(X09.EQ.1))THEN
X02='(1X,''THE NUMBER OF THE ROW YOU ENTERED, '',I6,'', IS ON THE EDGE OF THE'',/,&
&1X,''DEM. YOU CANNOT SELECT 1 OR '',I6,'' AS A ROW NUMBER.'',/,&
&1X,''ENTER A VALUE BETWEEN, BUT NOT INCLUDING, 1 AND '',I6,''.'')'
WRITE(*,X02)X09,X023,X023
WRITE(*,X053)
CYCLE PASS1
END IF
IF((X10.GE.X025).OR.(X10.LE.1))THEN
X02='(1X,''THE NUMBER OF THE COLUMN YOU ENTERED, '',I6,'', IS ON THE EDGE OF THE'',/,&
&1X,''DEM. YOU CANNOT SELECT 1 OR '',I6,'' AS A COLUMN NUMBER.'',/,&
&1X,''ENTER A VALUE BETWEEN, BUT NOT INCLUDING, 1 AND '',I6,''.'')'
WRITE(*,X02)X10,X025,X025
WRITE(*,X02)
CYCLE PASS1
END IF
CNT=0
X0001=0
DO I=1,8
IR=X09-X07(X0016(I),1)
IC=X10-X07(X0016(I),2)
IF(IR.LE.X023)THEN
IF(IC.LE.X025)THEN
IF(X40(IR,IC).GT.0)THEN
IF(X08(IR,IC).EQ.X0016(I))THEN
CNT=CNT+1
IF(CNT.GT.1)THEN
X02='(1X,''THE SELECTED OUTLET CELL IS A JUNCTION CELL.'',/,&
&1X,''FOR A NETWORK AND WATERSHED TO BE EVALUATED THE SELECTED OUTLET'',/,&
&1X,''MUST NOT BE A JUNCTION CELL.'')'
WRITE(*,X02)
WRITE(*,X053)
X0001=1
CYCLE PASS1
END IF
END IF
END IF
END IF
END IF
END DO
EXIT PASS1
END DO PASS1
END SUBROUTINE OUTLET
SUBROUTINE RUNOPT
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00076,X00077,IOS
USE DTCNT1,ONLY:X042
USE GENIO1,ONLY:TESTIO,READCM,CHKFIL
IMPLICIT NONE
INTEGER::X04=X00070
INTEGER(KIND=X36)::X00066=X00070,X00067=X00070
INTEGER(KIND=X35)::X0040=X00071,X0042=X00071,X0002=X00071
CHARACTER(LEN=12)::X01=' '
WRITE(X00077,'(4X,''*** BEGINNING SUBROUTINE CHKFIL.'')')
X01='DNMCNT.INP'
X00066=2
X04=X00076
CALL CHKFIL(X01,X00066)
OPEN(UNIT=X04,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X04,X01,X0002,X00067)
X0042=0
X01='DNMCNT.INP'
X0040=181
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(3)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0040=11
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(5)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0040=53
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(10)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
X0040=21
CALL READCM(X0040,X04,X01,X0042)
X0042=X0042+1
READ(X00076,*,IOSTAT=IOS)X042(13)
X00067=2
CALL TESTIO(X00076,X01,X0042,X00067)
CLOSE(UNIT=X00076,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00076,X01,X0002,X00067)
END SUBROUTINE RUNOPT
END MODULE DEDNM2
MODULE DEDNM1
CONTAINS
SUBROUTINE OTCNT
USE STSYS1,ONLY:X36,X00070,X34,X00072,X00077
USE DTCNT1,ONLY:X00051,X00052,X00054,&
X057,X0026,X0027,X0028,&
X00042,X00043,X014,X042,X00047,X0014,X0025,X0024,&
X039,X041,X09,X10,X00050,X0031,X006,X005,X00046,&
X0017,X010,X015,X12,X13,X14,X0030,X0029,X00039,&
X00083,X009,X008,X00045,X00041,X001
IMPLICIT NONE
INTEGER(KIND=X36)::I=X00070
REAL(KIND=X34)::TX001=X00072
CHARACTER(LEN=500)::X02=' ', X053=' '
X053='(1X)'
X02='(/,1X,''PRINT-OUT OF INPUT DATA FROM FILE DNMCNT.INP AND RELATED DATA.'',/)'
WRITE(X00077,X02)
X02='(3X,''>>> DEM RASTER PARAMETERS <<<'')'
WRITE(X00077,X02)
X02='(3X,''- TITLE OF CURRENT TOPAZ APPLICATION (3 LINES):'',/)'
WRITE(X00077,X02)
X02='(A79)'
WRITE(X00077,X02)X00051
WRITE(X00077,X02)X00052
WRITE(X00077,X02)X00054
X02='(1X)'
WRITE(X00077,X02)
X02='(3X,''- ZONE OF THE DEM:'',1X,I3)'
WRITE(X00077,X02)X0026
X02='(3X,''- EASTING AND NORTHING COORDINATE OF THE UPPER LEFT CORNER OF THE DEM:'',/,&
&15X,I10,2X,I10)'
WRITE(X00077,X02)X0027,X0028
X02='(3X,''- NUMBER OF ROWS AND COLUMNS IN THE INPUT DEM:'',1X,I5,2X,I5)'
WRITE(X00077,X02)X0025,X0024
X02='(3X,''- PRELIMINARY NUMBER OF ROWS AND COLUMNS IN THE DEM AFTER AGGREGATION/'',/,&
&5X,''RESAMPLING (VALUES WILL BE FINALIZED AFTER READING ACTUAL DEM DATA):'',/,&
&15X,I10,2X,I10)'
WRITE(X00077,X02)X009,X008
X02='(3X,''- ARRAY SIZE LIMIT BEYOND WHICH A WARNING FOR LARGE ARRAY SIZE IS PRINTED:'',/,&
&15X,I6)'
WRITE(X00077,X02)X00083
X02='(3X,''- ARRAY SIZE FOR COLUMNS BEFORE AGGREGATION/RESAMPLING:'',1X,I8)'
WRITE(X00077,X02)X0024
X02='(3X,''- ARRAY SIZE FOR ROWS AND COLUMNS AFTER AGGREGATION/RESAMPLING:'',/,&
&15X,I8,2X,I8)'
WRITE(X00077,X02)X009,X008
X02='(3X,''- USER ENTERED MAXIMUM AND MINIMUM ELEVATION IN METERS ROUNDED'',/,&
&5X,''TO THE NEAREST DECIMETER:'',1X,F7.1,2X,F7.1)'
WRITE(X00077,X02)X0030,X0029
X02='(3X,''- NUMBER OF DIGITS IN THE MAXIMUM ELEVATION VALUE BEFORE THE'',/,&
&5X,''DECIMAL POINT:'',1X,I2)'
WRITE(X00077,X02)X00039
X02='(3X,''- INITIAL USER ENTERED MAXIMUM AND MINIMUM ELEVATION VALUE IN METERS'',/,&
&5X,''TIMES 100000 (VALUE MAY CHANGE AFTER RELIEF INCREMENTATION OF FLAT AREA.):'',/,&
&15X,I10,2X,I10)'
WRITE(X00077,X02)X00041,X00045
X02='(3X,''- MAXIMUM AND MINIMUM DEM ELEVATION VALUE IN PROGRAM INTERNAL UNITS:'',/,&
&15X,I10,2X,I10)'
WRITE(X00077,X02)X00043,X00042
X02='(3X,''- USER ENTERED ELEVATION VALUE SPECIFYING INDETERMINATE ELEVATIONS:'',1X,F5.2)'
WRITE(X00077,X02)X005
X02='(3X,''- DEM ELEVATION VALUE SPECIFYING INDETERMINATE ELEVATIONS IN'',/,&
&5X,''PROGRAM INTERNAL UNITS:'',1X,I10)'
WRITE(X00077,X02)X006
X02='(3X,''- PROGRAM INTERNAL INDETERMINATE ELEVATION VALUE:'',1X,I8)'
WRITE(X00077,X02)X0017
X02='(3X,''- LENGTH OF A CELL IN METERS OF THE INPUT DEM RASTER BEFORE AND AFTER'',/,&
&5X,''AGGREGATION/RESAMPLING:'',1X,F10.3,2X,F10.3)'
WRITE(X00077,X02)X00047,X0014
X02='(3X,''- AREA OF A CELL IN HECTARES OF THE INPUT DEM RASTER BEFORE AND AFTER'',/,&
&5X,''AGGREGATION/RESAMPLING:'',1X,F10.3,2X,F10.3)'
TX001=X00047*X00047
WRITE(X00077,X02)TX001/10000.,X001
X02='(3X,''- ORIENTATION OF THE DEM RASTER:'',1X,I2)'
WRITE(X00077,X02)X010
X02='(3X,''- USER ENTERED ROW AND COLUMN COORDINATES OF THE OUTLET OF THE WATERSHED'',/,&
&5X,''BEFORE AGGREGATION/RESAMPLING:'',/,&
&15X,'' ROW:= '',I4,2X,''COL:= '',I4)'
WRITE(X00077,X02)X039,X041
X02='(3X,''- INITIAL ROW AND COLUMN COORDINATES OF THE OUTLET OF THE WATERSHED:'',/,&
&15X,'' ROW:= '',I4,2X,''COL:= '',I4,/,&
&5X,''NOTE: IF AGGREGATION/RESAMPLING WAS SELECTED THE COORDINATES REFER TO'',/,&
&5X,''      THE AGGREGATED/RESAMPLED DEM RASTER.'')'
WRITE(X00077,X02)X09,X10
X02='(/,3X,''>>> DEM ELEVATION PRE-PROCESSING AND PARTIAL PROCESSING OPTIONS <<<'')'
WRITE(X00077,X02)
X02='(3X,''- OPTION FOR AGGREGATING/RESAMPLING THE DEM RASTER:'',1X,I1)'
WRITE(X00077,X02)X042(1)
X02='(3X,''- AGGREGATION/RESAMPLING FACTOR:'',1X,I2)'
WRITE(X00077,X02)X014
X02='(3X,''- OPTION FOR SMOOTHING THE INPUT DEM DATA:'',1X,I1)'
WRITE(X00077,X02)X042(4)
X02='(3X,''- NUMBER OF SMOOTHING PASSES TO BE MADE:'',1X,I4)'
WRITE(X00077,X02)X015
X02='(3X,''- WEIGHT ASSIGNED TO THE CENTER, CROSS AND DIAGONAL CELLS:'',/,&
&15X,I4,2X,I4,2X,I4)'
WRITE(X00077,X02)X12,X13,X14
X02='(3X,''- OPTION FOR ANALYSIS AND ADJUSTMENT OF THE DEPRESSION OUTLET:'',1X,I1)'
WRITE(X00077,X02)X042(2)
X02='(3X,''- OPTION FOR FULL OR PARTIAL DEM PROCESSING:'',1X,I1)'
WRITE(X00077,X02)X042(3)
X02='(/,3X,''>>> DEM PROCESSING OPTIONS AND NETWORK EXTRACTION PARAMETERS <<<'')'
WRITE(X00077,X02)
X02='(/,8X,''CSA-MSCL    CSA       MSCL     THRESHOLD NUMBER'',/,&
&8X,''  CODE     VALUE     VALUE     OF CELLS DEFINING'',/,&
&8X,''            [HA]      [M]          A CHANNEL'',/)'
WRITE(X00077,X02)
X02='(10X,''  0'',7X,''N/A'',7X,''N/A'',12X,''N/A'')'
WRITE(X00077,X02)
X02='(10X,I3,1X,F10.2,2X,F8.1,9X,I5)'
DO I=1,X057
WRITE(X00077,X02)(I),X0031(I),X00050(I),X00046(I)
END DO
X02='(1X)'
WRITE(X00077,X02)
X02='(3X,''- OPTION FOR CALIBRATION RUN OF DEDNM:'',1X,I1)'
WRITE(X00077,X02)X042(10)
X02='(3X,''- RASTER CHECKING FOR ERRORS AND INCONSISTENCIES:'',1X,I1)'
WRITE(X00077,X02)X042(11)
X02='(/,3X,''>>> USER OUTPUT OPTIONS <<<'',/,&
&5X,''FOR ALL OF THE FOLLOWING OPTIONS:'',/,&
&5X,''  A VALUE OF  1  INDICATES WRITE A FILE TO OUTPUT, OR,'',/,&
&5X,''  A VALUE OF  0  INDICATES DO NOT WRITE A FILE.'')'
WRITE(X00077,X02)
X02='(3X,''- WRITE INPUT DATA TO FILE DEDNM.RPT:'',1X,I1)'
WRITE(X00077,X02)X042(12)
X02='(3X,''- WRITE MODULE CAPABILITIES TO DEDNM.RPT:'',1X,I1)'
WRITE(X00077,X02)X042(13)
X02='(3X,''- WRITE TABULAR DRAINAGE NETWORK DATA FILE NETW.TAB:'',1X,I1)'
WRITE(X00077,X02)X042(16)
X02='(3X,''- WRITE TABULAR SUBCATCHMENT DATA FILE SBCT.TAB:'',1X,I1)'
WRITE(X00077,X02)X042(15)
WRITE(X00077,X053)
END SUBROUTINE OTCNT
SUBROUTINE OTCHA
USE STSYS1,ONLY:X36,X35,X00070,X00071,X34,X33,X00072,X00073,IOS
USE DTCNT1,ONLY:X00051,X00052,X00054,X0006,X0009,X0010,X0012,HEADE,X0019
USE GENIO1
USE DTCHA1
IMPLICIT NONE
INTEGER(KIND=X36)::J=X00070,X00067=X00070
INTEGER(KIND=X35)::X0002=X00071,X00074=X00071,I=X00071
REAL(KIND=X34)::X88=X00072,X89=X00072
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=10):: X053=' ', X051=' '
CHARACTER(LEN=900)::X02=' '
X053='(A)'
X051='(79(A))'
X01='NETW.TAB'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
WRITE(X00073,X053)X0006
WRITE(X00073,X053)X0009
WRITE(X00073,X053)X0010
X02='(1X)'
WRITE(X00073,X02)
WRITE(X00073,X053)X0012
WRITE(X00073,X053)HEADE
X02='(//,1X,''TITLE OF CURRENT TOPAZ APPLICATION:'',/)'
WRITE(X00073,X02)
WRITE(X00073,X051)X00051
WRITE(X00073,X051)X00052
WRITE(X00073,X051)X00054
X02='(///,1X,''TABLE OF RASTER-NETWORK CHANNEL LINK INFORMATION AS COMPUTED BY PROGRAM DEDNM'',//)'
WRITE(X00073,X02)
X02='(1X,''CHAN. CHANNEL      COORDINATES           CHANNEL    TERRAIN           UPSTREAM AREA FLOWING'',&
&1X,''        DIRECT             NODE INDEX                 SLOPE * 1000'',/,&
&1X,''CNTR  ORDER  UPSTREAM     DOWNSTREAM     LENGTH   ELEVATION IN        INTO FOLLOWING'',&
&1X,''NODES         DRAINAGE              (MULTIPLE NODES)'',/,&
&1X,''                       PREV.     LAST   IN # CELL    METERS         UPSTR.    DWSTR.-1'',&
&1X,''   DWSTR.     AREA         I------------------------I    DIRECT    SMOOTHED'',/,&
&1X,'' #      #  ROW  COL  ROW  COL  ROW  COL  WIDTHS   UPSTR. DWSTR.         [ALL AREAS IN'',&
&1X,''NUMBER OF CELLS]       1    2    3    4    5    6    7'')'
WRITE(X00073,X02)
X02='(''----------------------------------------------------------------------------------------------------------'',&
&''----------------------------------------------------------'',/,&
&''    1    2    3   4    5    6    7    8       9      10     11         12         13        14        15 '',&
&''    16    17   18   19   20   21   22       23       24'',/,&
&''----------------------------------------------------------------------------------------------------------'',&
&''----------------------------------------------------------'',/)'
WRITE(X00073,X02)
X00074=X0019+1
X02='(1X,I4,3X,I2,6(1X,I4),1X,F9.2,1X,F6.1,1X,F6.1,1X,I9,2X,I9,1X,I9,1X,I9,2X,7(1X,I4),2(1X,F9.3))'
DO I=1,X00074
X88=REAL((REAL(X020(I),KIND=X33)/100000.),KIND=X34)
X89=REAL((REAL(X021(I),KIND=X33)/100000.),KIND=X34)
WRITE(X00073,X02)I,X30(I),X067(I),X066(I),X065(I),X026(I),X027(I),X028(I),X022(I),X88,X89,&
&X017(I),X0022(I),X019(I),X018(I),(X016(I,J),J=1,7),X00037(I),X00038(I)
END DO
X02='(1X,''  -1'')'
WRITE(X00073,X02)
X02='(/,1X,''** NOTES **'',/)'
WRITE(X00073,X02)
X02='(1X,''- COLUMNS 1 THROUGH 22 ARE COMPUTED BY PROGRAM DEDNM;'',/,&
&1X,''  COLUMNS 23 AND 24 ARE COMPUTED BY PROGRAM PARAM.'')'
WRITE(X00073,X02)
X02='(/,1X,''- FOR COMPLEX JUNCTION NODES THE CHANNEL LINK INFORMATION'',/,&
&1X,''  RELATES TO THE FIRST NODE NUMBER ONLY.'',/)'
WRITE(X00073,X02)
X02='(1X,''- BECAUSE THE NETWORK MAY CONTAIN COMPLEX JUNCTIONS, THE NUMBER OF CHANNEL'',/,&
&1X,''  LINKS MAY BE SMALLER THAN THE THEORETICALLY EXPECTED NUMBER BASED ON'',/,&
&1X,''  THE COUNT OF SOURCE NODES.''/)'
WRITE(X00073,X02)
X02='(1X,''- THE LAST LINE OF DATA DOES NOT REPRESENT A CHANNEL LINK.  IT REPRESENTS'',/,&
&1X,''  THE WATERSHED OUTLET CELL.'',/)'
WRITE(X00073,X02)
X02='(1X,''- ELEVATION VALUES ARE REPORTED TO THE NEAREST DECIMETER.'',/)'
WRITE(X00073,X02)
X02='(1X,''- THE THREE DRAINAGE AREA COLUMNS UNDER THE HEADING OF UPSTREAM AREA DO NOT'',/,&
&1X,''  INCLUDE THE AREA OF THE CURRENT CELL ITSELF.  THEY INCLUDE ALL (CHANNEL'',/,&
&1X,''  AND OVERLAND) INFLOWS FLOWING INTO THE CURRENT CELL.  THIS LAST COMMENT'',/,&
&1X,''  IS PARTICULARLY RELEVANT FOR THE COLUMN LABELED *UPSTR.*.'',/)'
WRITE(X00073,X02)
X02='(1X,''- THE DIRECT DRAINAGE AREA IS ALL OVERLAND AREA FLOWING DIRECTLY INTO A'',/,&
&1X,''  CHANNEL LINK.  THIS DOES NOT INCLUDE UPSTREAM CHANNEL INFLOW, BUT IT DOES'',/,&
&1X,''  INCLUDE UPSTREAM OVERLAND INFLOW INTO THE FIRST CELL OF A CHANNEL LINK.'',/,&
&1X,''  ALSO, THE DIRECT DRAINAGE AREA FOR FIRST ORDER CHANNELS DOES NOT'',/,&
&1X,''  INCLUDE THE DRAINAGE AREA FLOWING INTO THE CHANNEL SOURCE NODE OR CELL.'',/,&
&1X,''  THIS SOURCE DRAINAGE AREA IS GIVEN FOR FIRST ORDER CHANNELS BY THE COLUMN'',/,&
&1X,''  LABELED *UPSTR.*.'',/)'
WRITE(X00073,X02)
X02='(1X,''- THE DIRECT DRAINAGE AREA INTO THE OUTLET CELL, AS WELL AS THE AREA OF THE'',/,&
&1X,''  OUTLET CELL ITSELF, ARE ACCOUNTED FOR IN THE LAST CHANNEL LINK (PREVIOUS'',/,&
&1X,''  TO LAST DATA LINE).'',/,&
&1X,''  AS A RESULT, THE VALUE OF THE DIRECT DRAINAGE AREA OF THE LAST CHANNEL'')'
WRITE(X00073,X02)
X02='(1X,''  LINK INCLUDES, IN ADDITION TO ITS OWN DIRECT DRAINAGE AREA, THE DIRECT'',/,&
&1X,''  DRAINAGE AREA INTO THE OUTLET CELL, AS WELL AS THE AREA OF THE OUTLET'',/,&
&1X,''  CELL ITSELF.  THIS NECESSITATES THAT THE UPSTREAM AREA LABELED'',/,&
&1X,''  "DWSTR.-1" OF THE LAST CHANNEL LINK ALSO INCLUDES THE DIRECT DRAINAGE'',/,&
&1X,''  AREA OF THE OUTLET CELL, AS WELL AS THE AREA OF THE OUTLET CELL ITSELF.'',/)'
WRITE(X00073,X02)
X02='(1X,''- VALUE OF -1 INDICATES TERM NOT APPLICABLE.'',/)'
WRITE(X00073,X02)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE OTCHA
SUBROUTINE OTSBC
USE STSYS1,ONLY:X36,X35,X00070,X00071,X00073,IOS
USE GENIO1,ONLY:TESTIO
USE DTCNT1,ONLY:X00051,X00052,X00054,X0006,X0009,X0010,X0012,HEADE,X0019
USE DTCHA1,ONLY:X30,X016
USE DTCAT1,ONLY:X052,X22,X23,ICHA,X00033
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X00074=X00071,I=X00071
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=10):: X053=' ', X051=' '
CHARACTER(LEN=600)::X02=' '
X053='(A)'
X051='(79(A))'
X01='SBCT.TAB'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
WRITE(X00073,X053)X0006
WRITE(X00073,X053)X0009
WRITE(X00073,X053)X0010
X02='(1X)'
WRITE(X00073,X02)
WRITE(X00073,X053)X0012
WRITE(X00073,X053)HEADE
X02='(//,1X,''TITLE OF CURRENT TOPAZ APPLICATION:'',/)'
WRITE(X00073,X02)
WRITE(X00073,X051)X00051
WRITE(X00073,X051)X00052
WRITE(X00073,X051)X00054
X02='(///,1X,''TABLE OF RASTER-NETWORK SUBCATCHMENT INFORMATION AS COMPUTED BY PROGRAM DEDNM'',//)'
WRITE(X00073,X02)
X02='(/,1X,''NOTE: FOR COMPLEX JUNCTION NODES ONLY THE SUBCATCHMENT INFORMATION'',/,&
&1X,''PERTAINING TO THE FIRST NODE NUMBER IS GIVEN.  SUBSEQUENT NODES'',/,&
&1X,''ARE HYPOTHETICAL NODES AND HAVE NO CORRESPONDING SUBCATCHMENT INFORMATION.'',/)'
WRITE(X00073,X02)
X02='(/,1X,''CHAN. CHAN. CHAN.      SUBCATCHMENT AREA IN NUMBER OF CELLS'',/,&
&1X,''CNTR. ORDER INDEX     SOURCE   LEFT   RIGHT  CHANNEL   TOTAL'')'
WRITE(X00073,X02)
X02='(''----------------------------------------------------------------'',/)'
WRITE(X00073,X02)
X00074=X0019+1
X02='(1X,I4,4X,I2,3X,I4,3X,I7,1X,I7,1X,I7,1X,I7,1X,I7)'
DO I=1,X00074
WRITE(X00073,X02)I,X30(I),X016(I,1),X052(I),X22(I),X23(I),ICHA(I),X00033(I)
END DO
X02='(1X,''  -1'')'
WRITE(X00073,X02)
X02='(/,1X,''** NOTE **'',//,&
&1X,''- BECAUSE THERE MAY BE JUNCTIONS WITH MULTIPLE TRIBUTARIES, THE NUMBER'',/,&
&1X,''  OF SUBCATCHMENTS MAY BE SMALLER THAN THE THEORETICALLY EXPECTED NUMBER.'',/)'
WRITE(X00073,X02)
X02='(1X,''- THE LAST LINE OF DATA DOES NOT REPRESENT A SUBCATCHMENT.'',/,&
&1X,''  IT REPRESENTS THE WATERSHED OUTLET CELL.'',/)'
WRITE(X00073,X02)
X02='(1X,''- THE SUBCATCHMENT AREAS INTO THE OUTLET CELL ARE ACCOUNTED FOR IN THE'',/,&
&1X,''  LAST CHANNEL LINK (PREVIOUS TO LAST DATA LINE).'',/,&
&1X,''  AS A RESULT, THE VALUE OF THE SUBCATCHMENT AREAS OF THE LAST CHANNEL'',/,&
&1X,''  LINK INCLUDE, IN ADDITION TO THEIR OWN SUBCATCHMENT AREAS, THE SUBCATCHMENT'',/,&
&1X,''  AREAS INTO THE OUTLET CELL.'',/)'
WRITE(X00073,X02)
X02='(1X,''- VALUE OF -1 INDICATES TERM NOT APPLICABLE.'')'
WRITE(X00073,X02)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE OTSBC
SUBROUTINE OTWIN
USE STSYS1,ONLY:X00070,X00071,X00073,IOS,X36,X35
USE GENIO1,ONLY:TESTIO
USE DTCNT1,ONLY:X00051,X00052,X00054,X0006,X0009,X0010,X0012,HEADE,X0019
USE DTCHA1,ONLY:X016
USE DTCAT1,ONLY:X18,X19,X20,X21
IMPLICIT NONE
INTEGER(KIND=X36)::X00067=X00070
INTEGER(KIND=X35)::X00074=X00071,I=X00071,J=X00071
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=10)::X053=' '
CHARACTER(LEN=400)::X02=' '
X053='(A)'
X01='CATWIN.TAB'
OPEN(UNIT=X00073,FILE=X01,STATUS='OLD',ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=3
CALL TESTIO(X00073,X01,X0002,X00067)
WRITE(X00073,X053)X0006
WRITE(X00073,X053)X0009
WRITE(X00073,X053)X0010
X02='(1X)'
WRITE(X00073,X02)
WRITE(X00073,X053)X0012
WRITE(X00073,X053)HEADE
X02='(//,1X,''TITLE OF CURRENT TOPAZ APPLICATION:'',/)'
WRITE(X00073,X02)
WRITE(X00073,X053)X00051
WRITE(X00073,X053)X00052
WRITE(X00073,X053)X00054
X02='(///,1X,''TABLE OF RASTER-NETWORK SUBCATCHMENT WINDOW INFORMATION AS COMPUTED BY PROGRAM DEDNM'',//)'
WRITE(X00073,X02)
X02='(/,1X,''NOTE: FOR COMPLEX JUNCTION NODES ONLY THE  SUBCATCHMENT INFORMATION'',/,&
&1X,''PERTAINING TO THE FIRST NODE NUMBER IS GIVEN.  SUBSEQUENT NODES'',/,&
&1X,''ARE HYPOTHETICAL NODES AND HAVE NO CORRESPONDING SUBCATCHMENT INFORMATION.'',/)'
WRITE(X00073,X02)
X02='(''             SOURCE              RIGHT                LEFT              CHANNEL'',&
&''        RIGHT SUBCATCHMENT  LEFT SUBCATCHMENT'')'
WRITE(X00073,X02)
X02='(''        SUBCATCHMENT AREA   SUBCATCHMENT AREA   SUBCATCHMENT AREA         AREA'',&
&''          AND CHANNEL AREA   AND CHANNEL AREA'')'
WRITE(X00073,X02)
X02='(''NODE   MIN  MIN  MAX  MAX  MIN  MIN  MAX  MAX  MIN  MIN  MAX  MAX  MIN  MIN  MAX  MAX  MIN  MIN  '',&
&''MAX  MAX  MIN  MIN  MAX  MAX'')'
WRITE(X00073,X02)
X02='(''NUMBER ROW  COL  ROW  COL  ROW  COL  ROW  COL  ROW  COL  ROW  COL  ROW  COL  ROW  COL  ROW  COL  '',&
&''ROW  COL  ROW  COL  ROW  COL'')'
WRITE(X00073,X02)
X02='(''----------------------------------------------------------------------------------------------------'',&
&''-------------------------'',/)'
WRITE(X00073,X02)
X02='(25(1X,I4))'
X00074=X0019+1
DO I=1,X00074
WRITE(X00073,X02)X016(I,1),(X18(I,J),X19(I,J),X20(I,J),X21(I,J),J=1,6)
END DO
X02='(''----------------------------------------------------------------------------------------------------'',&
&''----------------------------'',/)'
WRITE(X00073,X02)
ENDFILE(UNIT=X00073,IOSTAT=IOS)
X00067=8
CALL TESTIO(X00073,X01,X0002,X00067)
CLOSE(UNIT=X00073,STATUS='KEEP', IOSTAT=IOS)
X00067=5
CALL TESTIO(X00073,X01,X0002,X00067)
END SUBROUTINE OTWIN
END MODULE DEDNM1
PROGRAM DEDNM
USE STSYS1,ONLY:X36,X35,X32,X00070,X00071,X00081,IOS,X00077,X00073,&
CHKKND
USE DTCNT1,ONLY:X00051,X00052,X00054,X17,X16,X00042,X00043,X0017,&
X023,X025,X006,X00029,X011,X0018,X042,X00031,&
INITIL
USE DTRST1,ONLY:X11,X03,X40,ICA,X08,X048,X0041,X045,X068,X046,&
X049,X00061,X271
USE GENER1,ONLY:ERCHK
USE GENIO1,ONLY:X0045,X0044,&
TESTIO,RSTIO
USE GENIO2,ONLY:IOCAT,IOCHA
USE ALDAL,ONLY:ALCAT1,ALCHA1,DLCAT1,DLCHA1
USE DEDNM1
USE DEDNM2
USE DEDNM3
IMPLICIT NONE
INTEGER::X00069=X00070,X04=X00070
INTEGER(KIND=X36)::X00067=X00070,X00116=X00070
INTEGER(KIND=X35)::X0002=X00071
CHARACTER(LEN=12)::X01=' '
CHARACTER(LEN=500)::X02=' ', X053=' '
INTEGER(KIND=X36)::X0065=X00070,X00092=X00070,X002=X00070
INTEGER(KIND=X32)::X0049=X00081,X0066=X00081,X0048=X00081,X0047=X00081
INTEGER(KIND=X36),DIMENSION(1:1,1:1)::X00003
INTEGER(KIND=X35),DIMENSION(1:1,1:1)::X00002
INTEGER(KIND=X32),DIMENSION(1:1,1:1)::X00001
X053='(1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!  ERROR  !!!!!!!!!!!!!!'',/,&
&1X,''!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'',/,&
&1X,''PROGRAM DEDNM (DEDNM.F90).'')'
X01='DEDNM.RPT'
OPEN(UNIT=X00077,FILE=X01,STATUS='UNKNOWN', ACCESS='SEQUENTIAL', FORM='FORMATTED', IOSTAT=IOS)
X00067=4
CALL TESTIO(X00077,X01,X0002,X00067)
X02='(1X,''***** BEGINNING PROGRAM DEDNM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''***** BEGINNING INITIALIZATION AND INPUT OF CONTROL DATA FROM FILE DNMCNT.INP.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''*** BEGINNING SBRT CHKKND.'')'
WRITE(X00077,X02)
CALL CHKKND
X02='(1X,''*** ENDING SBRT CHKKND.'')'
WRITE(X00077,X02)
X02='(1X,''*** BEGINNING SBRT RUNOPT.'')'
WRITE(X00077,X02)
CALL RUNOPT
X02='(1X,''*** ENDING SBRT RUNOPT.'')'
WRITE(X00077,X02)
X02='(1X,''*** BEGINNING SBRT HEADER.'')'
WRITE(X00077,X02)
CALL HEADER
X02='(1X,''*** ENDING SBRT HEADER.'')'
WRITE(X00077,X02)
IF(X042(13).EQ.1)THEN
X02='(1X,''*** BEGINNING SBRT CAPLIM.'')'
WRITE(X00077,X02)
CALL CAPLIM
X02='(1X,''*** ENDING SBRT CAPLIM.'')'
WRITE(X00077,X02)
END IF
X02='(1X,''*** BEGINNING SBRT IOINIT.'')'
WRITE(X00077,X02)
CALL IOINIT
X02='(1X,''*** ENDING SBRT IOINIT.'')'
WRITE(X00077,X02)
X02='(1X,''*** BEGINNING SBRT INITIL.'')'
WRITE(X00077,X02)
CALL INITIL
X02='(1X,''*** ENDING SBRT INITIL.'')'
WRITE(X00077,X02)
X02='(1X,''*** BEGINNING SBRT INCNT.'')'
WRITE(X00077,X02)
CALL INCNT
X02='(1X,''*** ENDING SBRT INCNT.'')'
WRITE(X00077,X02)
X02='(1X)'
WRITE(X00077,X02)
X02='(2X,''TITLE OF THE CURRENT TOPAZ APPLICATION:'',/)'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(A79,/,A79,/,A79,/)'
WRITE(X00077,X02)X00051,X00052,X00054
WRITE(*,X02)X00051,X00052,X00054
IF(X042(12).EQ.1)THEN
X02='(1X,''*** BEGINNING SBRT OTCNT.'')'
WRITE(X00077,X02)
CALL OTCNT
X02='(1X,''*** ENDING SBRT OTCNT.'')'
WRITE(X00077,X02)
END IF
FULL_RUN_OPTION:IF(X042(10).EQ.0)THEN
X02='(1X,''***** BEGINNING DEM INPUT AND DEM PRE-PROCESSING.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''=== ALLOCATING IEL ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X03(X17,X16),STAT=IOS)
X00067=6
X01='IEL'
CALL TESTIO(X00069,X01,X0002,X00067)
X03=X00081
X02='(1X,''*** BEGINNING SBRT INDEM.'')'
WRITE(X00077,X02)
CALL INDEM
X02='(1X,''*** ENDING SBRT INDEM.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=3
X00092=2
X0047=X00042
X0048=X00043
X0066=X0017
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,X03)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=3
X04=X00073
X01='INELEV.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,X03,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING INDTR ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X0041(X17,X16),STAT=IOS)
X00067=6
X01='INDTR'
CALL TESTIO(X00069,X01,X0002,X00067)
X0041=X00070
X02='(1X,''*** BEGINNING SBRT INDTAR.'')'
WRITE(X00077,X02)
CALL INDTAR
X02='(1X,''*** ENDING SBRT INDTAR.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=2
X0047=1
X0048=2
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X0041,X00002,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=1
X04=X00073
X01='INDTAR.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X0041,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
IF(X042(4).EQ.1)THEN
X02='(1X,''=== ALLOCATING IT3A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X049(X17,X16),STAT=IOS)
X00067=6
X01='IT3A'
CALL TESTIO(X00069,X01,X0002,X00067)
X049=X00081
X02='(1X,''*** BEGINNING SBRT SMOOTH.'')'
WRITE(X00077,X02)
CALL SMOOTH
X02='(1X,''*** ENDING SBRT SMOOTH.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT3A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X049,STAT=IOS)
X00067=7
X01='IT3A'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=3
X00092=2
X0047=X00042
X0048=X00043
X0066=X0017
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,X03)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=3
X04=X00073
X01='SMOOTH.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,X03,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
END IF
X02='(1X,''***** BEGINNING DEPRESSION AND FLAT AREA TREATMENT.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''=== ALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X045(X17,X16),STAT=IOS)
X00067=6
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
X045=X00070
X02='(1X,''=== ALLOCATING IT1B ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X068(X17,X16),STAT=IOS)
X00067=6
X01='IT1B'
CALL TESTIO(X00069,X01,X0002,X00067)
X068=X00070
X02='(1X,''*** BEGINNING SBRT FILDEP.'')'
WRITE(X00077,X02)
CALL FILDEP
X02='(1X,''*** ENDING SBRT FILDEP.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X045,STAT=IOS)
X00067=7
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=3
X00092=2
X0047=X00042
X0048=X00043
X0066=X0017
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,X03)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=3
X04=X00073
X01='FILDEP.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,X03,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING IT2A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X046(X17,X16),STAT=IOS)
X00067=6
X01='IT2A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== ALLOCATING IT3A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X049(X17,X16),STAT=IOS)
X00067=6
X01='IT3A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''*** BEGINNING SBRT RELIEF.'')'
WRITE(X00077,X02)
CALL RELIEF
X02='(1X,''*** ENDING SBRT RELIEF.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT3A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X049,STAT=IOS)
X00067=7
X01='IT3A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== DEALLOCATING IT2A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X046,STAT=IOS)
X00067=7
X01='IT2A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== DEALLOCATING IT1B ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X068,STAT=IOS)
X00067=7
X01='IT1B'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=3
X00092=2
X0047=X00042
X0048=X00043
X0066=X0017
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,X03)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=3
X04=X00073
X01='RELIEF.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,X03,X04,X01)
IF(X042(3).EQ.1)THEN
X02='(1X,''*** BEGINNING SBRT OTCNT1.'')'
WRITE(X00077,X02)
CALL OTCNT1
X02='(1X,''*** ENDING SBRT OTCNT1.'')'
WRITE(X00077,X02)
X02='(1X,''***** ENDING DEM PRE-PROCESSING: DEPRESSION AND FLAT AREA TREATMENT.'')'
WRITE(X00077,X02)
WRITE(*,X02)
CLOSE(UNIT=X00077,STATUS='KEEP', IOSTAT=IOS)
X00067=5
X01='DEDNM.RPT'
CALL TESTIO(X00077,X01,X0002,X00067)
STOP 'NORMAL PROGRAM TERMINATION.  DEM PRE-PROCESSING ONLY.'
END IF
X02='(1X,''***** BEGINNING FLOW VECTOR, FLOW PATH AND DRAINAGE AREA COMPUTATIONS.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''=== ALLOCATING IFV ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X08(X17,X16),STAT=IOS)
X00067=6
X01='IFV'
CALL TESTIO(X00069,X01,X0002,X00067)
X08=X00070
X02='(1X,''*** BEGINNING SBRT FLOVEC.'')'
WRITE(X00077,X02)
CALL FLOVEC
X02='(1X,''*** ENDING SBRT FLOVEC.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IEL ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X03,STAT=IOS)
X00067=7
X01='IEL'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== DEALLOCATING INDTR ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X0041,STAT=IOS)
X00067=7
X01='INDTR'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=1
X0047=1
X0048=9
X0066=0
X0049=5
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X08,X00002,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=1
X04=X00073
X01='FLOVEC.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X08,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING IFLP ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X271(X17,X16),STAT=IOS)
X00067=6
X01='IFLP'
CALL TESTIO(X00069,X01,X0002,X00067)
X271=X00070
X02='(1X,''*** BEGINNING SBRT FLOPAT.'')'
WRITE(X00077,X02)
CALL FLOPAT
X02='(1X,''*** ENDING SBRT FLOPAT.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=2
X0047=1
X0048=4
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X271,X00002,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=1
X04=X00073
X01='FLOPAT.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X271,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING ICA ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(ICA(X17,X16),STAT=IOS)
X00067=6
X01='ICA'
CALL TESTIO(X00069,X01,X0002,X00067)
ICA=X00081
X02='(1X,''*** BEGINNING SBRT UPAREA.'')'
WRITE(X00077,X02)
CALL UPAREA
X02='(1X,''*** ENDING SBRT UPAREA.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IFLP ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X271,STAT=IOS)
X00067=7
X01='IFLP'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=3
X00092=2
X0047=0
X0048=X00029
X0066=-1
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,ICA)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=3
X04=X00073
X01='UPAREA.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,ICA,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
ELSE IF((X042(10).EQ.1).OR.(X042(10).EQ.2).OR.(X042(10).EQ.3))THEN
X02='(1X,''***** BEGINNING INPUT OF DATA AND ARRAYS FOR CALIBRATION RUN.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''*** BEGINNING SBRT INUPDT.'')'
WRITE(X00077,X02)
CALL INUPDT
X02='(1X,''*** ENDING SBRT INUPDT.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING IFV ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X08(X17,X16),STAT=IOS)
X00067=6
X01='IFV'
CALL TESTIO(X00069,X01,X0002,X00067)
X08=X00070
X0045=2
X0044=1
X04=X00073
X01='FLOVEC.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X08,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING ICA ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(ICA(X17,X16),STAT=IOS)
X00067=6
X01='ICA'
CALL TESTIO(X00069,X01,X0002,X00067)
ICA=X00081
X0045=2
X0044=3
X04=X00073
X01='UPAREA.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,ICA,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''INCOMPATIBLE VALUE FOR IOPT(10) WAS ENCOUNTERED.  LOGIC ERROR.'',/,&
&1X,''VALUE FOR IOPT(10) WAS:'',1X,I5,/,&
&1X,''IOPT(10) MUST BE EITHER 0, 1, 2, OR 3.'',/,&
&1X,''CORRECT INPUT FILE DNMCNT.INP'',/,&
&1X,''ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'')'
WRITE(X00077,X02)X042(10)
WRITE(*,X02)X042(10)
STOP 'ABNORMAL PROGRAM TERMINATION.  CHECK REPORT FILE.'
END IF FULL_RUN_OPTION
X02='(1X,''***** BEGINNING CHANNEL NETWORK DEFINITION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
IF((X042(10).EQ.0).OR.(X042(10).EQ.1).OR.(X042(10).EQ.3))THEN
X02='(1X,''=== ALLOCATING ICMCOD ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X00061(X17,X16),STAT=IOS)
X00067=6
X01='ICMCOD'
CALL TESTIO(X00069,X01,X0002,X00067)
X00061=X00070
IF((X042(10).EQ.0).OR.(X042(10).EQ.3))THEN
X02='(1X,''*** BEGINNING SBRT INPCOD.'')'
WRITE(X00077,X02)
CALL INPCOD
X02='(1X,''*** ENDING SBRT INPCOD.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=2
X0047=1
X0048=5
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00061,X00002,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=1
X04=X00073
X01='NTGCOD.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00061,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
ELSE IF(X042(10).EQ.1)THEN
X0045=2
X0044=1
X04=X00073
X01='NTGCOD.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00061,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
END IF
X02='(1X,''=== ALLOCATING NTW ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X40(X17,X16),STAT=IOS)
X00067=6
X01='NTW'
CALL TESTIO(X00069,X01,X0002,X00067)
X40=X00071
X02='(1X,''*** BEGINNING SBRT NETFUL.'')'
WRITE(X00077,X02)
CALL NETFUL
X02='(1X,''*** ENDING SBRT NETFUL.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=2
X00092=2
X0047=1
X0048=103
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X40,X00001)
END IF
X02='(1X,''*** BEGINNING SBRT PRUNE.'')'
WRITE(X00077,X02)
CALL PRUNE
X02='(1X,''*** ENDING SBRT PRUNE.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING ICMCOD ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X00061,STAT=IOS)
X00067=7
X01='ICMCOD'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=2
X00092=2
X0047=1
X0048=103
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X40,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=2
X04=X00073
X01='NTWINT.FIL'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X40,X00001,X04,X01)
X02='(1X,''=== ALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X045(X17,X16),STAT=IOS)
X00067=6
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
X045=X00070
X02='(1X,''*** BEGINNING SBRT PRUNE1.'')'
WRITE(X00077,X02)
CALL PRUNE1
X02='(1X,''*** ENDING SBRT PRUNE1.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=2
X0047=0
X0048=1
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X045,X00002,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=1
X04=X00073
X01='NETFUL.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X045,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X045,STAT=IOS)
X00067=7
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
ELSE IF(X042(10).EQ.2)THEN
X02='(1X,''=== ALLOCATING NTW ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X40(X17,X16),STAT=IOS)
X00067=6
X01='NTW'
CALL TESTIO(X00069,X01,X0002,X00067)
X40=X00071
X0045=2
X0044=2
X04=X00073
X01='NTWINT.FIL'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X40,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
ELSE
WRITE(X00077,X053)
WRITE(*,X053)
X02='(1X,''INCOMPATIBLE VALUE FOR IOPT(10) WAS ENCOUNTERED.  LOGIC ERROR.'',/,&
&1X,''VALUE FOR IOPT(10) WAS:'',1X,I5,/,&
&1X,''IOPT(10) MUST BE EITHER 0, 1, 2, OR 3.'',/,&
&1X,''ABNORMAL PROGRAM TERMINATION.  LOGIC ERROR.  SEE REPORT FILE.'')'
WRITE(X00077,X02)X042(10)
WRITE(*,X02)X042(10)
END IF
IF(X042(3).EQ.2)THEN
X02='(1X,''*** BEGINNING SBRT OTCNT1.'')'
WRITE(X00077,X02)
CALL OTCNT1
X02='(1X,''*** ENDING SBRT OTCNT1.'')'
WRITE(X00077,X02)
CLOSE(UNIT=X00077,STATUS='KEEP', IOSTAT=IOS)
X00067=5
X01='DEDNM.RPT'
CALL TESTIO(X00077,X01,X0002,X00067)
STOP 'NORMAL PROGRAM TERMINATION.  DEM PROCESSING UP TO FULL NETWORK.'
END IF
X02='(1X,''***** BEGINNING WATERSHED OUTLET AND BOUNDARY DEFINITION.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''=== ALLOCATING IT3A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X049(X17,X16),STAT=IOS)
X00067=6
X01='IT3A'
CALL TESTIO(X00069,X01,X0002,X00067)
X049=X00081
X02='(1X,''*** BEGINNING SBRT OUTLET.'')'
WRITE(X00077,X02)
X00116=0
CALL OUTLET(X00116)
X02='(1X,''*** ENDING SBRT OUTLET.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT3A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X049,STAT=IOS)
X00067=7
X01='IT3A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== ALLOCATING BND ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X11(X17,X16),STAT=IOS)
X00067=6
X01='BND'
CALL TESTIO(X00069,X01,X0002,X00067)
X11=X00070
X02='(1X,''=== ALLOCATING INDTR ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X0041(X17,X16),STAT=IOS)
X00067=6
X01='INDTR'
CALL TESTIO(X00069,X01,X0002,X00067)
X0041=X00070
IF((X042(10).EQ.0).OR.(X042(10).EQ.2).OR.(X00116.EQ.1))THEN
X0045=2
X0044=1
X04=X00073
X01='FLOPAT.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X11,X00002,X00001,X04,X01)
X02='(1X,''*** END SBRT RSTIO.'')'
WRITE(X00077,X02)
X0045=2
X0044=1
X04=X00073
X01='INDTAR.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X0041,X00002,X00001,X04,X01)
X02='(1X,''*** END SBRT RSTIO.'')'
WRITE(X00077,X02)
X00116=1
X02='(1X,''*** BEGINNING SBRT BOUND.'')'
WRITE(X00077,X02)
CALL BOUND
X02='(1X,''*** ENDING SBRT BOUND.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=2
X0047=0
X0048=1
X0066=-1
X0049=-1
WRITE(X00077,'(1X,''*** BEGINNING SBRT ERCHK.'')')
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X11,X00002,X00001)
X02='(1X,''*** END SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=1
X04=X00073
X01='BOUND.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X11,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
ELSE IF(((X042(10).EQ.1).OR.(X042(10).EQ.3)).AND.(X00116.EQ.0))THEN
X0045=2
X0044=1
X04=X00073
X01='BOUND.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X11,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
END IF
X02='(1X,''=== DEALLOCATING INDTR ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X0041,STAT=IOS)
X00067=7
X01='INDTR'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''*** BEGINNING SBRT MAPBOD.'')'
WRITE(X00077,X02)
CALL MAPBOD
X02='(1X,''*** ENDING SBRT MAPBOD.'')'
WRITE(X00077,X02)
IF(X042(11).EQ.1)THEN
X0065=1
X00092=1
X0047=0
X0048=9
X0066=-1
X0049=5
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X08,X00002,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
X0065=2
X00092=2
X0047=0
X0048=100
X0066=-1
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X40,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X02='(1X,''=== DEALLOCATING BND ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X11,STAT=IOS)
X00067=7
X01='BND'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''***** BEGINNING CHANNEL LINK AND NETWORK NODE COMPUTATIONS.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''=== ALLOCATING IEL ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X03(X17,X16),STAT=IOS)
X00067=6
X01='IEL'
CALL TESTIO(X00069,X01,X0002,X00067)
X03=X00081
X0045=2
X0044=3
X04=X00073
X01='RELIEF.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,X03,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== ALLOCATING ALL ARRAYS IN MODULE DTCHA1.'')'
WRITE(X00077,X02)
CALL ALCHA1
X02='(1X,''*** BEGINNING SBRT NETAN.'')'
WRITE(X00077,X02)
CALL NETAN
X02='(1X,''*** ENDING SBRT NETAN.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IEL ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X03,STAT=IOS)
X00067=7
X01='IEL'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== DEALLOCATING ICA ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(ICA,STAT=IOS)
X00067=7
X01='ICA'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=2
X00092=2
X0047=0
X0048=X0018
X0066=-1
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X40,X00001)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X02='(1X,''=== ALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X045(X17,X16),STAT=IOS)
X00067=6
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
X045=X00070
X045=INT(X40,KIND=X36)
X0045=1
X0044=1
X04=X00073
X01='NETW.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X045,X00002,X00001,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X045,STAT=IOS)
X00067=7
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''*** BEGINNING SBRT NETNUM.'')'
WRITE(X00077,X02)
CALL NETNUM
X02='(1X,''*** ENDING SBRT NETNUM.'')'
WRITE(X00077,X02)
X02='(1X,''*** BEGINNING SBRT OTCHA.'')'
WRITE(X00077,X02)
IF(X042(16).EQ.1)CALL OTCHA
X02='(1X,''*** ENDING SBRT OTCHA.'')'
WRITE(X00077,X02)
X02='(1X,''***** BEGINNING CATCHMENT COMPUTATIONS.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''=== ALLOCATING NSBC ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X048(X17,X16),STAT=IOS)
X00067=6
X01='NSBC'
CALL TESTIO(X00069,X01,X0002,X00067)
X048=X00081
X02='(1X,''*** BEGINNING SBRT SUBWT1.'')'
WRITE(X00077,X02)
CALL SUBWT1
X02='(1X,''*** ENDING SBRT SUBWT1.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING NTW ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X40,STAT=IOS)
X00067=7
X01='NTW'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== ALLOCATING ALL ARRAYS IN MODULE DTCAT1.'')'
WRITE(X00077,X02)
CALL ALCAT1
X02='(1X,''=== ALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
ALLOCATE(X045(X17,X16),STAT=IOS)
X00067=6
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
X045=X00070
X02='(1X,''*** BEGINNING SBRT SUBWTA.'')'
WRITE(X00077,X02)
CALL SUBWTA
X02='(1X,''*** ENDING SBRT SUBWTA.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING IT1A ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X045,STAT=IOS)
X00067=7
X01='IT1A'
CALL TESTIO(X00069,X01,X0002,X00067)
X02='(1X,''=== DEALLOCATING IFV ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X08,STAT=IOS)
X00067=7
X01='IFV'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(11).EQ.1)THEN
X0065=3
X00092=2
X0047=20
X0048=(X00031*10+4)
X0066=0
X0049=-1
X02='(1X,''*** BEGINNING SBRT ERCHK.'')'
WRITE(X00077,X02)
CALL ERCHK(X0065,X00092,X0047,X0048,X0066,X0049,X00003,X00002,X048)
X02='(1X,''*** ENDING SBRT ERCHK.'')'
WRITE(X00077,X02)
END IF
X0045=1
X0044=3
X04=X00073
X01='SUBWTA.OUT'
X02='(1X,''*** BEGINNING SBRT RSTIO.'')'
WRITE(X00077,X02)
CALL RSTIO(X0045,X0044,X00003,X00002,X048,X04,X01)
X02='(1X,''*** ENDING SBRT RSTIO.'')'
WRITE(X00077,X02)
X02='(1X,''=== DEALLOCATING NSBC ARRAY.'')'
WRITE(X00077,X02)
DEALLOCATE(X048,STAT=IOS)
X00067=7
X01='NSBC'
CALL TESTIO(X00069,X01,X0002,X00067)
IF(X042(15).EQ.1)CALL OTSBC
X02='(1X,''*** BEGINNING SBRT OTWIN.'')'
WRITE(X00077,X02)
IF(X042(17).EQ.1)CALL OTWIN
X02='(1X,''*** ENDING SBRT OTWIN.'')'
WRITE(X00077,X02)
X02='(1X,''***** BEGINNING TO WRITE UNFORMATTED FILES.'')'
WRITE(X00077,X02)
WRITE(*,X02)
X02='(1X,''*** BEGINNING SBRT IOCHA.'')'
WRITE(X00077,X02)
X002=1
CALL IOCHA(X002)
X02='(1X,''*** ENDING SBRT IOCHA.'')'
WRITE(X00077,X02)
X02='(1X,''*** BEGINNING SBRT IOCAT.'')'
WRITE(X00077,X02)
X002=1
CALL IOCAT(X002)
X02='(1X,''*** ENDING SBRT IOCAT.'')'
WRITE(X00077,X02)
X02='(1X,''=== DE-ALLOCATING ALL ARRAYS IN MODULE DTCHA1.'')'
WRITE(X00077,X02)
CALL DLCHA1
X02='(1X,''=== DE-ALLOCATING ALL ARRAYS IN MODULE DTCAT1.'')'
WRITE(X00077,X02)
CALL DLCAT1
X02='(1X,''*** BEGINNING SBRT OTCNT1.'')'
WRITE(X00077,X02)
CALL OTCNT1
X02='(1X,''*** ENDING SBRT OTCNT1.'')'
WRITE(X00077,X02)
X02='(1X,''***** ENDING PROGRAM DEDNM.'')'
WRITE(X00077,X02)
WRITE(*,X02)
ENDFILE(UNIT=X00077,IOSTAT=IOS)
X00067=8
X01='DEDNM.RPT'
CALL TESTIO(X00077,X01,X0002,X00067)
CLOSE(UNIT=X00077,STATUS='KEEP', IOSTAT=IOS)
X00067=5
X01='DEDNM.RPT'
CALL TESTIO(X00077,X01,X0002,X00067)
STOP 'NORMAL PROGRAM TERMINATION.'
END PROGRAM DEDNM
